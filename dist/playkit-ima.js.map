{"version":3,"sources":["./ima/webpack/bootstrap","./ima/external [\"KalturaPlayer\"]","./ima/../node_modules/javascript-state-machine/lib/state-machine.js","./ima/../node_modules/javascript-state-machine/lib/history.js","webpack://KalturaPlayer.plugins.ima/./assets/style.css?703f","./ima/../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","./ima/./assets/style.css","./ima/../node_modules/css-loader/dist/runtime/api.js","./ima/./state.js","./ima/./ima-middleware.js","./ima/./ima-ads-controller.js","./ima/./ima-state-machine.js","./ima/./ima-engine-decorator.js","./ima/./ima.js","./ima/./ima-custom.js","./ima/./index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","KalturaPlayer","factory","configurable","target","sources","source","arguments","length","mixin","build","config","max","plugin","plugins","methods","properties","defineProperties","hook","fsm","additional","method","args","context","concat","apply","camelize","label","result","words","split","toLowerCase","charAt","toUpperCase","substring","prepended","prepend","Config","options","StateMachine","this","defaults","states","transitions","map","lifecycle","configureLifecycle","init","configureInitTransition","data","configureData","configureMethods","wildcard","configureTransitions","configurePlugins","addState","push","addStateLifecycleNames","onEnter","onLeave","on","addTransition","indexOf","addTransitionLifecycleNames","onBefore","onAfter","mapTransition","transition","from","to","state","active","builtin","configure","Array","isArray","transitionFor","transitionsFor","keys","allStates","allTransitions","Exception","UNOBSERVED","JSM","observers","fire","is","isPending","pending","can","seek","cannot","entry","transit","changed","observeUnchangedState","onPendingTransition","beginTransit","unshift","observeEvents","observersForEvent","onInvalidTransition","endTransit","failTransit","doTransit","observe","observer","event","events","previousEvent","previousResult","undefined","pluggable","nextEvents","slice","shift","then","catch","PublicMethods","_fsm","PublicProperties","set","Error","instance","forEach","version","cstor","message","current","past","future","clear","back","forward","canBack","canForward","pop","api","content","default","locals","memo","isOldIE","Boolean","window","document","all","atob","getTarget","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","modulesToDom","list","idCountMap","identifiers","item","id","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","setAttribute","insert","appendChild","textStore","replaceText","replacement","filter","join","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","btoa","unescape","encodeURIComponent","JSON","stringify","firstChild","singleton","singletonCounter","update","styleIndex","parentNode","removeStyleElement","newObj","lastIdentifiers","newList","toString","newLastIdentifiers","_i","_index","splice","useSourceMap","cssMapping","sourceMapping","sourceURLs","sourceRoot","cssWithMappingToString","mediaQuery","alreadyImportedModules","State","ImaMiddleware","_context","player","addEventListener","Event","CHANGE_SOURCE_STARTED","_isFirstPlay","_nextLoad","next","getStateMachine","adTagUrl","adsResponse","AD_ERROR","_callNextLoad","AD_MANIFEST_LOADED","payload","adBreaksPosition","includes","disableMediaPreload","playOnMainVideoTag","AD_BREAK_END","getVideoElement","src","load","loadPromise","initialUserAction","callNext","resumeAd","reset","logger","error","pauseAd","core","BaseMiddleware","ImaAdsController","skipAd","adPod","playAdNow","onPlaybackEnded","AdBreakType","Utils","ImaStateMachine","AD_STARTED","adEvent","getAd","isLinear","AD_RESUMED","AD_PAUSED","AD_SKIPPED","AD_COMPLETED","ADS_COMPLETED","AD_LOADED","AD_FIRST_QUARTILE","AD_BREAK_START","AD_MIDPOINT","AD_THIRD_QUARTILE","USER_CLOSED_AD","AD_VOLUME_CHANGED","AD_MUTED","AD_CLICKED","AD_CAN_SKIP","AD_PROGRESS","AD_BUFFERING","onAdloaded","onAdLoaded","onAdstarted","onAdStarted","onAdpaused","onAdEvent","onAdresumed","onAdResumed","onAdclicked","onAdClicked","onAdskipped","onAdSkipped","onAdcompleted","onAdCompleted","onAdscompleted","onAdsCompleted","onAdcanskip","onAdCanSkip","onAdbreakstart","onAdBreakStart","onAdbreakend","onAdBreakEnd","onAdfirstquartile","onAdmidpoint","onAdthirdquartile","onAdlog","onAdLog","onAderror","onAdError","onUserclosedad","onAdvolumechanged","onAdmuted","onAdprogress","onAdProgress","onAdbuffering","onEnterState","StateMachineHistory","debug","type","adBreakType","getAdBreakType","adOptions","getAdOptions","ad","Ad","getAdId","Dom","_adsContainerDiv","warn","dispatchEvent","adType","extraAdData","getAdData","_currentAd","_adVideoTagAlreadyPlayed","_resizeAd","_maybeDisplayCompanionAds","_showAdsContainer","_nextPromise","_resolveNextPromise","play","_maybeIgnoreClickOnAd","_stateMachine","_adsManager","pause","_setToggleAdsCover","paused","_contentComplete","playback","playAdsWithMSE","_contentSrc","adBreakOptions","getAdBreakOptions","adBreak","AdBreak","_maybeSavePlayerSnapshot","_maybeForceExitFullScreen","_maybeSaveVideoCurrentTime","forceReloadMediaAfterAds","eventManager","listenOnce","LOADED_DATA","_maybeSetVideoCurrentTime","_hideAdsContainer","_maybeRestorePlayerSnapshot","adError","getError","getMessage","getAdError","_playAdByConfig","env","os","setTimeout","reject","getAdSkippableState","remainingTime","getRemainingTime","duration","currentTime","Number","isNumber","adProgress","fatal","code","severity","Severity","CRITICAL","RECOVERABLE","category","Category","ADS","getVastErrorCode","parseInt","Code","AD_UNDEFINED_ERROR","currentAd","getCurrentAd","innerError","adData","podInfo","getAdPodInfo","system","getAdSystem","url","getMediaUrl","clickThroughUrl","contentType","getContentType","getDuration","position","_adPosition","getAdPosition","title","getTitle","linear","skipOffset","getSkipTimeOffset","width","getVastMediaWidth","getWidth","height","getVastMediaHeight","getHeight","bitrate","getVastMediaBitrate","bumper","getIsBumper","_isBumper","numAds","_podLength","getTotalAds","ended","OVERLAY","podIndex","getPodIndex","PRE","POST","MID","getAdBreakTypeFromSdk","_getAdBreakTypeFromPlayer","FakeEvent","ImaEngineDecorator","engine","_plugin","defaultPrevented","isAdPlaying","getContentTime","getContentDuration","getContentEnded","EngineType","getCapabilities","Env","EventManager","AudioTrack","TextTrack","FULL_SCREEN_EVENTS","Ima","_initMembers","_init","_playAdBreak","_firstOfAdPod","_waterfalled","_playAd","_hasUserAction","playNext","_adBreaksEventManager","removeAll","onError","response","AD_WATERFALLING","adFailed","waterfall","AD_WATERFALLING_FAILED","adlog","listen","_adsLoader","_sdk","AdsManagerLoadedEvent","Type","ADS_MANAGER_LOADED","AdEvent","COMPLETE","SKIPPED","LOG","AdErrorEvent","ads","isAdBreak","adbreakend","CONTENT_RESUME_REQUESTED","adscompleted","ALL_ADS_COMPLETED","FIRST_PLAY","_requestAds","skip","skipSupport","stop","defer","resume","isCustomPlaybackUsed","_videoLastCurrentTime","_contentDuration","_addBindings","_isImaSDKLibLoaded","destroy","contentComplete","_adDisplayContainer","initialize","_isAdsManagerLoaded","_startAdsManager","ready","Promise","resolve","dimensions","ViewMode","NORMAL","start","fullScreenEvent","MUTE_CHANGE","_syncPlayerVolume","VOLUME_CHANGE","SOURCE_SELECTED","selectedSource","DURATION_CHANGE","ERROR","MEDIA_LOADED","updateAdsRenderingSettings","restoreCustomPlaybackStateOnAdBreakComplete","ENDED","_onMediaEnded","LOADED_METADATA","_onLoadedMetadata","TIME_UPDATE","_onMediaTimeUpdate","SEEKING","_onMediaSeeking","SEEKED","_onMediaSeeked","USER_GESTURE","_contentPlayheadTracker","previousTime","seeking","_togglePlayPauseOnAdsContainerCallback","_selectedAudioTrack","_selectedTextTrack","_selectedPlaybackRate","_textTracksHidden","_maybeDelayInitUntilSourceSelected","_loadImaSDKLib","google","ima","VERSION","_initImaSettings","_initAdsContainer","_initAdsLoader","delayInitUntilSourceSelected","imaSdkUrl","Http","protocol","IMA_SDK_DEBUG_LIB_URL","IMA_SDK_LIB_URL","loadScriptAsync","settings","setPlayerType","playerName","setPlayerVersion","playerVersion","setVpaidAllowed","setVpaidMode","_getVpaidMode","setLocale","locale","setDisableCustomPlaybackForIOS10Plus","playsinline","numRedirects","setNumRedirects","vpaidmode","ImaSdkSettings","VpaidMode","vpaidMode","ENABLED","playerView","getView","className","_adsCoverDiv","onclick","_onAdsCoverClicked","AdDisplayContainer","AdsLoader","adsManagerLoadedEvent","_onAdsManagerLoaded","aderror","vastUrl","vastResponse","adsRequest","AdsRequest","vastLoadTimeout","linearAdSlotWidth","linearAdSlotHeight","nonLinearAdSlotWidth","nonLinearAdSlotHeight","muted","volume","setAdWillPlayMuted","adWillAutoPlay","playerWillAutoPlay","autoplay","allowMutedAutoPlay","setAdWillAutoPlay","requestAds","HTML5","capabilities","mutedAutoPlay","loaded","viewMode","isFullscreen","FULLSCREEN","resize","adTotalWidth","adTotalHeight","_alignAdsContainerSizeForOverlayAd","bottom","left","getCuePoints","visibility","adsRenderingSettings","_getAdsRenderingSetting","getAdsManager","cuePoints","_attachAdsManagerListeners","AdsRenderingSettings","setting","playAdsAfterTime","startTime","CONTENT_PAUSE_REQUESTED","adbreakstart","LOADED","adloaded","STARTED","adstarted","PAUSED","adpaused","RESUMED","adresumed","FIRST_QUARTILE","adfirstquartile","MIDPOINT","admidpoint","THIRD_QUARTILE","adthirdquartile","CLICK","adclicked","adskipped","adcompleted","USER_CLOSE","userclosedad","VOLUME_CHANGED","advolumechanged","VOLUME_MUTED","admuted","adprogress","adbuffering","SKIPPABLE_STATE_CHANGED","adcanskip","setVolume","isNaN","enable","nextSibling","_isAdsCoverActive","companions","googletag","selectionCriteria","CompanionAdSelectionSettings","resourceType","ResourceType","ALL","creativeType","CreativeType","sizeCriteria","SizeCriteria","SELECT_EXACT_MATCH","companionsIds","companionAds","getCompanionAds","getContent","el","getElementById","innerHTML","browser","stopPropagation","tracks","textTracks","track","activeCues","cue","text","isIOS","getActiveTracks","audio","playbackRate","_hideActiveTextTracksOnAVPlayer","hideTextTrack","CAN_PLAY","selectTrack","_setActiveTextTracksOnAVPlayer","inBrowserFullscreen","exitFullscreen","BasePlugin","enablePreloading","useStyledLinearAds","useStyledNonLinearAds","autoAlign","loadVideoTimeout","CustomIma","_adBreakPlayableByConfig","adBreakPlayable","aps","enabled","fetchBidsPromise","fetchBids","BaseImaPlugin","__VERSION__","NAME","__NAME__","registerPlugin"],"mappings":"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","file":"playkit-ima.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","module.exports = KalturaPlayer;","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"StateMachine\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"StateMachine\"] = factory();\n\telse\n\t\troot[\"StateMachine\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function(target, sources) {\n  var n, source, key;\n  for(n = 1 ; n < arguments.length ; n++) {\n    source = arguments[n];\n    for(key in source) {\n      if (source.hasOwnProperty(key))\n        target[key] = source[key];\n    }\n  }\n  return target;\n}\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nvar mixin = __webpack_require__(0);\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = {\n\n  build: function(target, config) {\n    var n, max, plugin, plugins = config.plugins;\n    for(n = 0, max = plugins.length ; n < max ; n++) {\n      plugin = plugins[n];\n      if (plugin.methods)\n        mixin(target, plugin.methods);\n      if (plugin.properties)\n        Object.defineProperties(target, plugin.properties);\n    }\n  },\n\n  hook: function(fsm, name, additional) {\n    var n, max, method, plugin,\n        plugins = fsm.config.plugins,\n        args    = [fsm.context];\n\n    if (additional)\n      args = args.concat(additional)\n\n    for(n = 0, max = plugins.length ; n < max ; n++) {\n      plugin = plugins[n]\n      method = plugins[n][name]\n      if (method)\n        method.apply(plugin, args);\n    }\n  }\n\n}\n\n//-------------------------------------------------------------------------------------------------\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nfunction camelize(label) {\n\n  if (label.length === 0)\n    return label;\n\n  var n, result, word, words = label.split(/[_-]/);\n\n  // single word with first character already lowercase, return untouched\n  if ((words.length === 1) && (words[0][0].toLowerCase() === words[0][0]))\n    return label;\n\n  result = words[0].toLowerCase();\n  for(n = 1 ; n < words.length ; n++) {\n    result = result + words[n].charAt(0).toUpperCase() + words[n].substring(1).toLowerCase();\n  }\n\n  return result;\n}\n\n//-------------------------------------------------------------------------------------------------\n\ncamelize.prepended = function(prepend, label) {\n  label = camelize(label);\n  return prepend + label[0].toUpperCase() + label.substring(1);\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = camelize;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nvar mixin    = __webpack_require__(0),\n    camelize = __webpack_require__(2);\n\n//-------------------------------------------------------------------------------------------------\n\nfunction Config(options, StateMachine) {\n\n  options = options || {};\n\n  this.options     = options; // preserving original options can be useful (e.g visualize plugin)\n  this.defaults    = StateMachine.defaults;\n  this.states      = [];\n  this.transitions = [];\n  this.map         = {};\n  this.lifecycle   = this.configureLifecycle();\n  this.init        = this.configureInitTransition(options.init);\n  this.data        = this.configureData(options.data);\n  this.methods     = this.configureMethods(options.methods);\n\n  this.map[this.defaults.wildcard] = {};\n\n  this.configureTransitions(options.transitions || []);\n\n  this.plugins = this.configurePlugins(options.plugins, StateMachine.plugin);\n\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmixin(Config.prototype, {\n\n  addState: function(name) {\n    if (!this.map[name]) {\n      this.states.push(name);\n      this.addStateLifecycleNames(name);\n      this.map[name] = {};\n    }\n  },\n\n  addStateLifecycleNames: function(name) {\n    this.lifecycle.onEnter[name] = camelize.prepended('onEnter', name);\n    this.lifecycle.onLeave[name] = camelize.prepended('onLeave', name);\n    this.lifecycle.on[name]      = camelize.prepended('on',      name);\n  },\n\n  addTransition: function(name) {\n    if (this.transitions.indexOf(name) < 0) {\n      this.transitions.push(name);\n      this.addTransitionLifecycleNames(name);\n    }\n  },\n\n  addTransitionLifecycleNames: function(name) {\n    this.lifecycle.onBefore[name] = camelize.prepended('onBefore', name);\n    this.lifecycle.onAfter[name]  = camelize.prepended('onAfter',  name);\n    this.lifecycle.on[name]       = camelize.prepended('on',       name);\n  },\n\n  mapTransition: function(transition) {\n    var name = transition.name,\n        from = transition.from,\n        to   = transition.to;\n    this.addState(from);\n    if (typeof to !== 'function')\n      this.addState(to);\n    this.addTransition(name);\n    this.map[from][name] = transition;\n    return transition;\n  },\n\n  configureLifecycle: function() {\n    return {\n      onBefore: { transition: 'onBeforeTransition' },\n      onAfter:  { transition: 'onAfterTransition'  },\n      onEnter:  { state:      'onEnterState'       },\n      onLeave:  { state:      'onLeaveState'       },\n      on:       { transition: 'onTransition'       }\n    };\n  },\n\n  configureInitTransition: function(init) {\n    if (typeof init === 'string') {\n      return this.mapTransition(mixin({}, this.defaults.init, { to: init, active: true }));\n    }\n    else if (typeof init === 'object') {\n      return this.mapTransition(mixin({}, this.defaults.init, init, { active: true }));\n    }\n    else {\n      this.addState(this.defaults.init.from);\n      return this.defaults.init;\n    }\n  },\n\n  configureData: function(data) {\n    if (typeof data === 'function')\n      return data;\n    else if (typeof data === 'object')\n      return function() { return data; }\n    else\n      return function() { return {};  }\n  },\n\n  configureMethods: function(methods) {\n    return methods || {};\n  },\n\n  configurePlugins: function(plugins, builtin) {\n    plugins = plugins || [];\n    var n, max, plugin;\n    for(n = 0, max = plugins.length ; n < max ; n++) {\n      plugin = plugins[n];\n      if (typeof plugin === 'function')\n        plugins[n] = plugin = plugin()\n      if (plugin.configure)\n        plugin.configure(this);\n    }\n    return plugins\n  },\n\n  configureTransitions: function(transitions) {\n    var i, n, transition, from, to, wildcard = this.defaults.wildcard;\n    for(n = 0 ; n < transitions.length ; n++) {\n      transition = transitions[n];\n      from  = Array.isArray(transition.from) ? transition.from : [transition.from || wildcard]\n      to    = transition.to || wildcard;\n      for(i = 0 ; i < from.length ; i++) {\n        this.mapTransition({ name: transition.name, from: from[i], to: to });\n      }\n    }\n  },\n\n  transitionFor: function(state, transition) {\n    var wildcard = this.defaults.wildcard;\n    return this.map[state][transition] ||\n           this.map[wildcard][transition];\n  },\n\n  transitionsFor: function(state) {\n    var wildcard = this.defaults.wildcard;\n    return Object.keys(this.map[state]).concat(Object.keys(this.map[wildcard]));\n  },\n\n  allStates: function() {\n    return this.states;\n  },\n\n  allTransitions: function() {\n    return this.transitions;\n  }\n\n});\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = Config;\n\n//-------------------------------------------------------------------------------------------------\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\nvar mixin      = __webpack_require__(0),\n    Exception  = __webpack_require__(6),\n    plugin     = __webpack_require__(1),\n    UNOBSERVED = [ null, [] ];\n\n//-------------------------------------------------------------------------------------------------\n\nfunction JSM(context, config) {\n  this.context   = context;\n  this.config    = config;\n  this.state     = config.init.from;\n  this.observers = [context];\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmixin(JSM.prototype, {\n\n  init: function(args) {\n    mixin(this.context, this.config.data.apply(this.context, args));\n    plugin.hook(this, 'init');\n    if (this.config.init.active)\n      return this.fire(this.config.init.name, []);\n  },\n\n  is: function(state) {\n    return Array.isArray(state) ? (state.indexOf(this.state) >= 0) : (this.state === state);\n  },\n\n  isPending: function() {\n    return this.pending;\n  },\n\n  can: function(transition) {\n    return !this.isPending() && !!this.seek(transition);\n  },\n\n  cannot: function(transition) {\n    return !this.can(transition);\n  },\n\n  allStates: function() {\n    return this.config.allStates();\n  },\n\n  allTransitions: function() {\n    return this.config.allTransitions();\n  },\n\n  transitions: function() {\n    return this.config.transitionsFor(this.state);\n  },\n\n  seek: function(transition, args) {\n    var wildcard = this.config.defaults.wildcard,\n        entry    = this.config.transitionFor(this.state, transition),\n        to       = entry && entry.to;\n    if (typeof to === 'function')\n      return to.apply(this.context, args);\n    else if (to === wildcard)\n      return this.state\n    else\n      return to\n  },\n\n  fire: function(transition, args) {\n    return this.transit(transition, this.state, this.seek(transition, args), args);\n  },\n\n  transit: function(transition, from, to, args) {\n\n    var lifecycle = this.config.lifecycle,\n        changed   = this.config.options.observeUnchangedState || (from !== to);\n\n    if (!to)\n      return this.context.onInvalidTransition(transition, from, to);\n\n    if (this.isPending())\n      return this.context.onPendingTransition(transition, from, to);\n\n    this.config.addState(to);  // might need to add this state if it's unknown (e.g. conditional transition or goto)\n\n    this.beginTransit();\n\n    args.unshift({             // this context will be passed to each lifecycle event observer\n      transition: transition,\n      from:       from,\n      to:         to,\n      fsm:        this.context\n    });\n\n    return this.observeEvents([\n                this.observersForEvent(lifecycle.onBefore.transition),\n                this.observersForEvent(lifecycle.onBefore[transition]),\n      changed ? this.observersForEvent(lifecycle.onLeave.state) : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.onLeave[from]) : UNOBSERVED,\n                this.observersForEvent(lifecycle.on.transition),\n      changed ? [ 'doTransit', [ this ] ]                       : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.onEnter.state) : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.onEnter[to])   : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.on[to])        : UNOBSERVED,\n                this.observersForEvent(lifecycle.onAfter.transition),\n                this.observersForEvent(lifecycle.onAfter[transition]),\n                this.observersForEvent(lifecycle.on[transition])\n    ], args);\n  },\n\n  beginTransit: function()          { this.pending = true;                 },\n  endTransit:   function(result)    { this.pending = false; return result; },\n  failTransit:  function(result)    { this.pending = false; throw result;  },\n  doTransit:    function(lifecycle) { this.state = lifecycle.to;           },\n\n  observe: function(args) {\n    if (args.length === 2) {\n      var observer = {};\n      observer[args[0]] = args[1];\n      this.observers.push(observer);\n    }\n    else {\n      this.observers.push(args[0]);\n    }\n  },\n\n  observersForEvent: function(event) { // TODO: this could be cached\n    var n = 0, max = this.observers.length, observer, result = [];\n    for( ; n < max ; n++) {\n      observer = this.observers[n];\n      if (observer[event])\n        result.push(observer);\n    }\n    return [ event, result, true ]\n  },\n\n  observeEvents: function(events, args, previousEvent, previousResult) {\n    if (events.length === 0) {\n      return this.endTransit(previousResult === undefined ? true : previousResult);\n    }\n\n    var event     = events[0][0],\n        observers = events[0][1],\n        pluggable = events[0][2];\n\n    args[0].event = event;\n    if (event && pluggable && event !== previousEvent)\n      plugin.hook(this, 'lifecycle', args);\n\n    if (observers.length === 0) {\n      var nextEvents = events.slice(1);\n      return this.observeEvents(nextEvents, args, event, previousResult);\n    }\n    else {\n      var observer = observers.shift(),\n          result = observer[event].apply(observer, args);\n      if (result && typeof result.then === 'function') {\n        return result.then(this.observeEvents.bind(this, events, args, event))\n                     .catch(this.failTransit.bind(this))\n      }\n      else if (result === false) {\n        return this.endTransit(false);\n      }\n      else {\n        return this.observeEvents(events, args, event, result);\n      }\n    }\n  },\n\n  onInvalidTransition: function(transition, from, to) {\n    throw new Exception(\"transition is invalid in current state\", transition, from, to, this.state);\n  },\n\n  onPendingTransition: function(transition, from, to) {\n    throw new Exception(\"transition is invalid while previous transition is still in progress\", transition, from, to, this.state);\n  }\n\n});\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = JSM;\n\n//-------------------------------------------------------------------------------------------------\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-----------------------------------------------------------------------------------------------\n\nvar mixin    = __webpack_require__(0),\n    camelize = __webpack_require__(2),\n    plugin   = __webpack_require__(1),\n    Config   = __webpack_require__(3),\n    JSM      = __webpack_require__(4);\n\n//-----------------------------------------------------------------------------------------------\n\nvar PublicMethods = {\n  is:                  function(state)       { return this._fsm.is(state)                                     },\n  can:                 function(transition)  { return this._fsm.can(transition)                               },\n  cannot:              function(transition)  { return this._fsm.cannot(transition)                            },\n  observe:             function()            { return this._fsm.observe(arguments)                            },\n  transitions:         function()            { return this._fsm.transitions()                                 },\n  allTransitions:      function()            { return this._fsm.allTransitions()                              },\n  allStates:           function()            { return this._fsm.allStates()                                   },\n  onInvalidTransition: function(t, from, to) { return this._fsm.onInvalidTransition(t, from, to)              },\n  onPendingTransition: function(t, from, to) { return this._fsm.onPendingTransition(t, from, to)              },\n}\n\nvar PublicProperties = {\n  state: {\n    configurable: false,\n    enumerable:   true,\n    get: function() {\n      return this._fsm.state;\n    },\n    set: function(state) {\n      throw Error('use transitions to change state')\n    }\n  }\n}\n\n//-----------------------------------------------------------------------------------------------\n\nfunction StateMachine(options) {\n  return apply(this || {}, options);\n}\n\nfunction factory() {\n  var cstor, options;\n  if (typeof arguments[0] === 'function') {\n    cstor   = arguments[0];\n    options = arguments[1] || {};\n  }\n  else {\n    cstor   = function() { this._fsm.apply(this, arguments) };\n    options = arguments[0] || {};\n  }\n  var config = new Config(options, StateMachine);\n  build(cstor.prototype, config);\n  cstor.prototype._fsm.config = config; // convenience access to shared config without needing an instance\n  return cstor;\n}\n\n//-------------------------------------------------------------------------------------------------\n\nfunction apply(instance, options) {\n  var config = new Config(options, StateMachine);\n  build(instance, config);\n  instance._fsm();\n  return instance;\n}\n\nfunction build(target, config) {\n  if ((typeof target !== 'object') || Array.isArray(target))\n    throw Error('StateMachine can only be applied to objects');\n  plugin.build(target, config);\n  Object.defineProperties(target, PublicProperties);\n  mixin(target, PublicMethods);\n  mixin(target, config.methods);\n  config.allTransitions().forEach(function(transition) {\n    target[camelize(transition)] = function() {\n      return this._fsm.fire(transition, [].slice.call(arguments))\n    }\n  });\n  target._fsm = function() {\n    this._fsm = new JSM(this, config);\n    this._fsm.init(arguments);\n  }\n}\n\n//-----------------------------------------------------------------------------------------------\n\nStateMachine.version  = '3.0.1';\nStateMachine.factory  = factory;\nStateMachine.apply    = apply;\nStateMachine.defaults = {\n  wildcard: '*',\n  init: {\n    name: 'init',\n    from: 'none'\n  }\n}\n\n//===============================================================================================\n\nmodule.exports = StateMachine;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function(message, transition, from, to, current) {\n  this.message    = message;\n  this.transition = transition;\n  this.from       = from;\n  this.to         = to;\n  this.current    = current;\n}\n\n\n/***/ })\n/******/ ]);\n});","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"StateMachineHistory\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"StateMachineHistory\"] = factory();\n\telse\n\t\troot[\"StateMachineHistory\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nfunction camelize(label) {\n\n  if (label.length === 0)\n    return label;\n\n  var n, result, word, words = label.split(/[_-]/);\n\n  // single word with first character already lowercase, return untouched\n  if ((words.length === 1) && (words[0][0].toLowerCase() === words[0][0]))\n    return label;\n\n  result = words[0].toLowerCase();\n  for(n = 1 ; n < words.length ; n++) {\n    result = result + words[n].charAt(0).toUpperCase() + words[n].substring(1).toLowerCase();\n  }\n\n  return result;\n}\n\n//-------------------------------------------------------------------------------------------------\n\ncamelize.prepended = function(prepend, label) {\n  label = camelize(label);\n  return prepend + label[0].toUpperCase() + label.substring(1);\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = camelize;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nvar camelize = __webpack_require__(0);\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = function(options) { options = options || {};\n\n  var past       = camelize(options.name || options.past   || 'history'),\n      future     = camelize(                options.future || 'future'),\n      clear      = camelize.prepended('clear', past),\n      back       = camelize.prepended(past,   'back'),\n      forward    = camelize.prepended(past,   'forward'),\n      canBack    = camelize.prepended('can',   back),\n      canForward = camelize.prepended('can',   forward),\n      max        = options.max;\n\n  var plugin = {\n\n    configure: function(config) {\n      config.addTransitionLifecycleNames(back);\n      config.addTransitionLifecycleNames(forward);\n    },\n\n    init: function(instance) {\n      instance[past]   = [];\n      instance[future] = [];\n    },\n\n    lifecycle: function(instance, lifecycle) {\n      if (lifecycle.event === 'onEnterState') {\n        instance[past].push(lifecycle.to);\n        if (max && instance[past].length > max)\n          instance[past].shift();\n        if (lifecycle.transition !== back && lifecycle.transition !== forward)\n          instance[future].length = 0;\n      }\n    },\n\n    methods:    {},\n    properties: {}\n\n  }\n\n  plugin.methods[clear] = function() {\n    this[past].length = 0\n    this[future].length = 0\n  }\n\n  plugin.properties[canBack] = {\n    get: function() {\n      return this[past].length > 1\n    }\n  }\n\n  plugin.properties[canForward] = {\n    get: function() {\n      return this[future].length > 0\n    }\n  }\n\n  plugin.methods[back] = function() {\n    if (!this[canBack])\n      throw Error('no history');\n    var from = this[past].pop(),\n        to   = this[past].pop();\n    this[future].push(from);\n    this._fsm.transit(back, from, to, []);\n  }\n\n  plugin.methods[forward] = function() {\n    if (!this[canForward])\n      throw Error('no history');\n    var from = this.state,\n        to = this[future].pop();\n    this._fsm.transit(forward, from, to, []);\n  }\n\n  return plugin;\n\n}\n\n\n/***/ })\n/******/ ]);\n});","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./style.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && btoa) {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".playkit-ads-cover {\\n  position: relative;\\n  cursor: pointer;\\n  width: 100%;\\n  height: 100%;\\n  background-color: rgba(0, 0, 0, 0);\\n}\\n\\n.playkit-ads-container {\\n  visibility: hidden;\\n  position: absolute;\\n}\\n\", \"\"]);\n\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return '@media ' + item[2] + '{' + content + '}';\n      } else {\n        return content;\n      }\n    }).join('');\n  }; // import a list of modules into the list\n\n\n  list.i = function (modules, mediaQuery) {\n    if (typeof modules === 'string') {\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    for (var i = 0; i < this.length; i++) {\n      var id = this[i][0];\n\n      if (id != null) {\n        alreadyImportedModules[id] = true;\n      }\n    }\n\n    for (i = 0; i < modules.length; i++) {\n      var item = modules[i]; // skip already imported module\n      // this implementation is not 100% perfect for weird media query combinations\n      // when a module is imported multiple times with different media queries.\n      // I hope this will never occur (Hey this way we have smaller bundles)\n\n      if (item[0] == null || !alreadyImportedModules[item[0]]) {\n        if (mediaQuery && !item[2]) {\n          item[2] = mediaQuery;\n        } else if (mediaQuery) {\n          item[2] = '(' + item[2] + ') and (' + mediaQuery + ')';\n        }\n\n        list.push(item);\n      }\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || '';\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */';\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n  return '/*# ' + data + ' */';\n}","// @flow\n\n/**\n * The ima plugin possible states.\n * @type {Object}\n */\nconst State: {[state: string]: string} = {\n  LOADING: 'loading',\n  LOADED: 'loaded',\n  PENDING: 'pending',\n  PLAYING: 'playing',\n  PAUSED: 'paused',\n  IDLE: 'idle',\n  DONE: 'done'\n};\n\nexport {State};\n","// @flow\nimport {core} from 'kaltura-player-js';\nimport {Ima} from './ima';\nimport {State} from './state';\n\nconst {BaseMiddleware} = core;\n/**\n * Middleware implementation for ima plugin.\n * @class ImaMiddleware\n * @param {Ima} context - The ima plugin context.\n * @private\n */\nclass ImaMiddleware extends BaseMiddleware {\n  /**\n   * The id of the ima middleware.\n   * @type {string}\n   * @public\n   * @memberof ImaMiddleware\n   */\n  id: string = 'ImaMiddleware';\n  /**\n   * Whether the play request is the first.\n   * @member\n   * @private\n   * @memberof ImaMiddleware\n   */\n  _isFirstPlay: boolean;\n  /**\n   * The plugin context.\n   * @member\n   * @private\n   * @memberof ImaMiddleware\n   */\n  _context: Ima;\n  /**\n   * The next load function.\n   * @member\n   * @private\n   * @memberof ImaMiddleware\n   */\n  _nextLoad: ?Function;\n\n  constructor(context: Ima) {\n    super();\n    this._context = context;\n    context.player.addEventListener(context.player.Event.CHANGE_SOURCE_STARTED, () => {\n      this._isFirstPlay = true;\n      this._nextLoad = null;\n    });\n  }\n\n  /**\n   * Load middleware handler.\n   * @param {Function} next - The load play handler in the middleware chain.\n   * @returns {void}\n   * @memberof ImaMiddleware\n   */\n  load(next: Function): void {\n    this._nextLoad = next;\n    const sm = this._context.getStateMachine();\n    if (sm.state !== State.IDLE && (this._context.config.adTagUrl || this._context.config.adsResponse)) {\n      this._context.player.addEventListener(this._context.player.Event.AD_ERROR, () => {\n        this._callNextLoad();\n      });\n      this._context.player.addEventListener(this._context.player.Event.AD_MANIFEST_LOADED, event => {\n        if (!event.payload.adBreaksPosition.includes(0)) {\n          this._callNextLoad();\n        }\n      });\n    } else {\n      this._callNextLoad();\n    }\n  }\n\n  /**\n   * Play middleware handler.\n   * @param {Function} next - The next play handler in the middleware chain.\n   * @returns {void}\n   * @memberof ImaMiddleware\n   */\n  play(next: Function): void {\n    if (this._isFirstPlay) {\n      this._isFirstPlay = false;\n      if (this._context.config.disableMediaPreload || this._context.playOnMainVideoTag()) {\n        this._context.player.addEventListener(this._context.player.Event.AD_BREAK_END, () => this._callNextLoad());\n        if (!(this._context.playOnMainVideoTag() || this._context.player.getVideoElement().src)) {\n          this._context.player.getVideoElement().load();\n        }\n      } else {\n        this._callNextLoad();\n      }\n    }\n    this._context.loadPromise\n      .then(() => {\n        let sm = this._context.getStateMachine();\n        switch (sm.state) {\n          case State.PLAYING:\n            break;\n          case State.LOADED: {\n            const initialUserAction = this._context.initialUserAction();\n            if (initialUserAction) {\n              return initialUserAction.then(() => {\n                this.callNext(next);\n              });\n            } else {\n              this.callNext(next);\n            }\n            break;\n          }\n          case State.PAUSED: {\n            const resumeAd = this._context.resumeAd();\n            if (resumeAd) {\n              return resumeAd.then(() => {\n                this.callNext(next);\n              });\n            } else {\n              this.callNext(next);\n            }\n            break;\n          }\n          default: {\n            this.callNext(next);\n            break;\n          }\n        }\n      })\n      .catch(e => {\n        this._context.reset();\n        this._context.logger.error(e);\n        this.callNext(next);\n      });\n  }\n\n  /**\n   * Pause middleware handler.\n   * @param {Function} next - The next pause handler in the middleware chain.\n   * @returns {void}\n   * @memberof ImaMiddleware\n   */\n  pause(next: Function): void {\n    let sm = this._context.getStateMachine();\n    switch (sm.state) {\n      case State.PAUSED:\n        break;\n      case State.PLAYING: {\n        this._context.pauseAd();\n        break;\n      }\n      default: {\n        this.callNext(next);\n        break;\n      }\n    }\n  }\n\n  _callNextLoad(): void {\n    if (this._nextLoad) {\n      this.callNext(this._nextLoad);\n    }\n    this._nextLoad = null;\n  }\n}\n\nexport {ImaMiddleware};\n","// @flow\nimport {Ima} from './ima';\nimport {State} from './state';\n\n/**\n * Controller for ima plugin.\n * @class ImaAdsController\n * @param {Ima} context - The ima plugin context.\n */\nclass ImaAdsController implements IAdsPluginController {\n  /**\n   * The plugin context.\n   * @member\n   * @private\n   * @memberof ImaAdsController\n   */\n  _context: Ima;\n\n  constructor(context: Ima) {\n    this._context = context;\n  }\n\n  /**\n   * Skip on an ad.\n   * @public\n   * @returns {void}\n   * @memberof ImaAdsController\n   */\n  skipAd(): void {\n    this._context.skipAd();\n  }\n\n  /**\n   * Play an ad on demand.\n   * @param {KPAdPod} adPod - The ad pod to play.\n   * @public\n   * @returns {void}\n   * @memberof ImaAdsController\n   */\n  playAdNow(adPod: KPAdPod): void {\n    this._context.playAdNow(adPod);\n  }\n\n  /**\n   * On playback ended handler.\n   * @public\n   * @returns {Promise<void>} - complete promise\n   * @memberof ImaAdsController\n   */\n  onPlaybackEnded(): Promise<void> {\n    return this._context.onPlaybackEnded();\n  }\n\n  /**\n   * Whether this ads controller is active\n   * @public\n   * @returns {boolean} - is active\n   * @memberof ImaAdsController\n   */\n  get active(): boolean {\n    return this._context.getStateMachine().state === State.PLAYING || this._context.getStateMachine().state === State.PAUSED;\n  }\n\n  /**\n   * Whether this ads controller is done\n   * @public\n   * @returns {boolean} - is done\n   * @memberof ImaAdsController\n   */\n  get done(): boolean {\n    return this._context.getStateMachine().state === State.DONE;\n  }\n\n  /**\n   * The controller name\n   * @public\n   * @returns {string} - The name\n   * @memberof ImaAdsController\n   */\n  get name(): string {\n    return this._context.name;\n  }\n}\n\nexport {ImaAdsController};\n","// @flow\nimport StateMachine from 'javascript-state-machine';\nimport StateMachineHistory from 'javascript-state-machine/lib/history';\nimport {State} from './state';\nimport {core, Ad, AdBreak} from 'kaltura-player-js';\n\nconst {AdBreakType, Error, Utils} = core;\n\n/**\n * Finite state machine for ima plugin.\n * @class ImaStateMachine\n * @private\n * @param {any} context - The plugin context.\n * @classdesc\n */\nclass ImaStateMachine {\n  constructor(context: any) {\n    return new StateMachine({\n      init: State.LOADING,\n      transitions: [\n        {\n          name: 'loaded',\n          from: [State.LOADING, State.LOADED, State.IDLE, State.PAUSED, State.PLAYING, State.DONE],\n          to: State.LOADED\n        },\n        {\n          name: context.player.Event.AD_STARTED,\n          from: [State.LOADED, State.IDLE, State.PAUSED, State.PLAYING, State.PENDING],\n          to: (adEvent: any): string => {\n            let ad = adEvent.getAd();\n            if (!ad.isLinear()) {\n              return State.IDLE;\n            }\n            return State.PLAYING;\n          }\n        },\n        {\n          name: context.player.Event.AD_RESUMED,\n          from: [State.PAUSED, State.PLAYING],\n          to: State.PLAYING\n        },\n        {\n          name: context.player.Event.AD_PAUSED,\n          from: State.PLAYING,\n          to: State.PAUSED\n        },\n        {\n          name: context.player.Event.AD_SKIPPED,\n          from: [State.PLAYING, State.PAUSED],\n          to: State.IDLE\n        },\n        {\n          name: context.player.Event.AD_COMPLETED,\n          from: [State.PLAYING, State.PAUSED]\n        },\n        {\n          name: context.player.Event.ADS_COMPLETED,\n          from: [State.IDLE, State.PAUSED],\n          to: State.DONE\n        },\n        {\n          name: context.player.Event.AD_BREAK_END,\n          from: [State.IDLE, State.PLAYING, State.LOADED, State.PAUSED],\n          to: State.IDLE\n        },\n        {\n          name: 'adlog',\n          from: [State.IDLE, State.LOADED, State.PLAYING, State.PAUSED, State.LOADING, State.PENDING],\n          to: State.IDLE\n        },\n        {\n          name: context.player.Event.AD_ERROR,\n          from: [State.IDLE, State.LOADED, State.PLAYING, State.PAUSED, State.LOADING, State.PENDING],\n          to: State.IDLE\n        },\n        {\n          name: context.player.Event.AD_LOADED,\n          from: [State.IDLE, State.LOADED, State.PLAYING]\n        },\n        {\n          name: context.player.Event.AD_FIRST_QUARTILE,\n          from: State.PLAYING\n        },\n        {\n          name: context.player.Event.AD_BREAK_START,\n          from: [State.IDLE, State.LOADED],\n          to: State.PENDING\n        },\n        {\n          name: context.player.Event.AD_MIDPOINT,\n          from: State.PLAYING\n        },\n        {\n          name: context.player.Event.AD_THIRD_QUARTILE,\n          from: State.PLAYING\n        },\n        {\n          name: context.player.Event.USER_CLOSED_AD,\n          from: [State.IDLE, State.PLAYING, State.PAUSED]\n        },\n        {\n          name: context.player.Event.AD_VOLUME_CHANGED,\n          from: [State.PENDING, State.PLAYING, State.PAUSED, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_MUTED,\n          from: [State.PLAYING, State.PAUSED, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_CLICKED,\n          from: [State.PLAYING, State.PAUSED, State.IDLE]\n        },\n        {\n          name: context.player.Event.AD_CAN_SKIP,\n          from: [State.PLAYING, State.PAUSED, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_PROGRESS,\n          from: [State.PLAYING, State.PAUSED]\n        },\n        {\n          name: context.player.Event.AD_BUFFERING,\n          from: '*'\n        },\n        {\n          name: 'goto',\n          from: '*',\n          to: s => s\n        }\n      ],\n      methods: {\n        onAdloaded: onAdLoaded.bind(context),\n        onAdstarted: onAdStarted.bind(context),\n        onAdpaused: onAdEvent.bind(context),\n        onAdresumed: onAdResumed.bind(context),\n        onAdclicked: onAdClicked.bind(context),\n        onAdskipped: onAdSkipped.bind(context),\n        onAdcompleted: onAdCompleted.bind(context),\n        onAdscompleted: onAdsCompleted.bind(context),\n        onAdcanskip: onAdCanSkip.bind(context),\n        onAdbreakstart: onAdBreakStart.bind(context),\n        onAdbreakend: onAdBreakEnd.bind(context),\n        onAdfirstquartile: onAdEvent.bind(context),\n        onAdmidpoint: onAdEvent.bind(context),\n        onAdthirdquartile: onAdEvent.bind(context),\n        onAdlog: onAdLog.bind(context),\n        onAderror: onAdError.bind(context),\n        onUserclosedad: onAdEvent.bind(context),\n        onAdvolumechanged: onAdEvent.bind(context),\n        onAdmuted: onAdEvent.bind(context),\n        onAdprogress: onAdProgress.bind(context),\n        onAdbuffering: onAdEvent.bind(context),\n        onEnterState: onEnterState.bind(context),\n        onPendingTransition: onPendingTransition.bind(context)\n      },\n      plugins: [new StateMachineHistory()]\n    });\n  }\n}\n\n/**\n * LOADED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdLoaded(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  const adBreakType = getAdBreakType.call(this, adEvent);\n  const adOptions = getAdOptions.call(this, adEvent);\n  const ad = new Ad(adEvent.getAd().getAdId(), adOptions);\n  Utils.Dom.setAttribute(this._adsContainerDiv, 'data-adtype', adBreakType);\n  this.logger.warn(`adType and extraAdData fields will be deprecated soon from AD_LOADED event payload. See docs for more information`);\n  this.dispatchEvent(options.transition, {\n    ad: ad,\n    adType: adBreakType, // for backward compatibility\n    extraAdData: adEvent.getAdData() // for backward compatibility\n  });\n}\n\n/**\n * STARTED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdStarted(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this._currentAd = adEvent.getAd();\n  this._adVideoTagAlreadyPlayed = true;\n  this._resizeAd();\n  this._maybeDisplayCompanionAds();\n  if (!this._currentAd.isLinear()) {\n    if (this._nextPromise) {\n      this._resolveNextPromise();\n    } else {\n      this.player.play();\n    }\n  } else {\n    this._showAdsContainer();\n  }\n  const adOptions = getAdOptions.call(this, adEvent);\n  const ad = new Ad(adEvent.getAd().getAdId(), adOptions);\n  this.dispatchEvent(options.transition, {ad});\n}\n\n/**\n * CLICKED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdClicked(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  if (this._currentAd.isLinear()) {\n    this._maybeIgnoreClickOnAd();\n    if (this._stateMachine.is(State.PLAYING)) {\n      this._adsManager.pause();\n    }\n    this._setToggleAdsCover(true);\n  } else {\n    if (!this.player.paused) {\n      this.player.pause();\n    }\n  }\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * RESUMED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdResumed(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this._setToggleAdsCover(false);\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * COMPLETE event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdCompleted(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * ADS_COMPLETED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdsCompleted(options: Object, adEvent: any): void {\n  this.logger.debug(options.transition.toUpperCase());\n  if (this.playOnMainVideoTag() && this._contentComplete && !this.player.config.playback.playAdsWithMSE) {\n    this.player.getVideoElement().src = this._contentSrc;\n  }\n  onAdBreakEnd.call(this, options, adEvent);\n}\n\n/**\n * CONTENT_PAUSED_REQUESTED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdBreakStart(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.player.pause();\n  const adBreakOptions = getAdBreakOptions.call(this, adEvent);\n  const adBreak = new AdBreak(adBreakOptions);\n  this._maybeSavePlayerSnapshot();\n  this._maybeForceExitFullScreen();\n  this._maybeSaveVideoCurrentTime();\n  this.dispatchEvent(options.transition, {adBreak: adBreak});\n}\n\n/**\n * CONTENT_RESUMED_REQUESTED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdBreakEnd(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this._currentAd = null;\n  if (!this._contentComplete) {\n    if (this.config.forceReloadMediaAfterAds) {\n      this.eventManager.listenOnce(this.player, this.player.Event.LOADED_DATA, () => {\n        this._maybeSetVideoCurrentTime();\n        this.player.play();\n      });\n      this.player.getVideoElement().load();\n    }\n    this._hideAdsContainer();\n    this._maybeSetVideoCurrentTime();\n    if (this._nextPromise) {\n      this._resolveNextPromise();\n    } else if (!this.config.forceReloadMediaAfterAds) {\n      this.player.play();\n    }\n  }\n  this._maybeRestorePlayerSnapshot();\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * LOG event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdLog(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  let adError;\n  if (typeof adEvent.getAdData === 'function') {\n    adError = adEvent.getAdData().adError;\n  } else if (typeof adEvent.getError === 'function') {\n    adError = adEvent.getError();\n  }\n  if (adError) {\n    this.logger.error('Non-fatal error occurred: ' + adError.getMessage());\n    this.dispatchEvent(this.player.Event.AD_ERROR, getAdError.call(this, adError, false));\n  }\n}\n\n/**\n * ERROR event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdError(options: Object, adEvent: any): void {\n  if (this._playAdByConfig()) {\n    this.logger.debug(adEvent.type.toUpperCase());\n    let adError = adEvent.getError();\n    // if this is autoplay or user already requested play then next promise will handle reset\n    if (this._nextPromise) {\n      //ads playing on same video tag wait to ima to end the source replacement\n      if (this.playOnMainVideoTag() && this.player.env.os.name !== 'iOS') {\n        setTimeout(\n          () => {\n            this._nextPromise.reject(adError);\n          },\n          0,\n          adError\n        );\n      } else {\n        this._nextPromise.reject(adError);\n      }\n    } else {\n      this.reset();\n    }\n    this.dispatchEvent(options.transition, getAdError.call(this, adError, true));\n  }\n}\n\n/**\n * SKIPPED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdSkipped(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * SKIPPABLE_STATE_CHANGED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdCanSkip(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  if (this._adsManager.getAdSkippableState()) {\n    this.dispatchEvent(options.transition);\n  }\n}\n\n/**\n * AD_PROGRESS event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdProgress(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  const remainingTime = this._adsManager.getRemainingTime();\n  const duration = adEvent.getAdData() && adEvent.getAdData().duration;\n  const currentTime = duration - remainingTime;\n  if (Utils.Number.isNumber(duration) && Utils.Number.isNumber(currentTime)) {\n    this.dispatchEvent(options.transition, {\n      adProgress: {\n        currentTime: currentTime,\n        duration: duration\n      }\n    });\n  }\n}\n\n/**\n * General event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdEvent(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * Enter state handler.\n * @param {Object} options - fsm event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onEnterState(options: Object): void {\n  if (options.from !== options.to) {\n    this.logger.debug('Change state: ' + options.from + ' => ' + options.to);\n  }\n}\n\n/**\n * onPendingTransition handler\n * @param {string} transition - transition\n * @param {string} from - from\n * @param {string} to - to\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onPendingTransition(transition: string, from: string, to: string): void {\n  this.logger.warn('The previous transition is still in progress', {transition, from, to});\n}\n\n/**\n * Gets the ad error object.\n * @param {any} adError - The ima ad error object.\n * @param {boolean} fatal - Whether the error is fatal.\n * @returns {Error} - The ad error object.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdError(adError: any, fatal: boolean): Error {\n  const severity = fatal ? Error.Severity.CRITICAL : Error.Severity.RECOVERABLE;\n  const category = Error.Category.ADS;\n  let code;\n  try {\n    if (adError.getVastErrorCode() !== 900) {\n      code = parseInt(Error.Category.ADS + adError.getVastErrorCode());\n    } else {\n      code = Error.Code.AD_UNDEFINED_ERROR;\n    }\n  } catch (e) {\n    code = Error.Code.AD_UNDEFINED_ERROR;\n  }\n  let ad;\n  if (this._adsManager) {\n    try {\n      const currentAd = this._adsManager.getCurrentAd();\n      const adEvent = {getAd: () => currentAd, getAdData: () => undefined};\n      const adOptions = getAdOptions.call(this, adEvent);\n      ad = new Ad(currentAd.getAdId(), adOptions);\n    } catch (e) {\n      //do nothing\n    }\n  }\n  return new Error(severity, category, code, {\n    ad,\n    innerError: adError\n  });\n}\n\n/**\n * Gets the ad options.\n * @param {any} adEvent - The ima ad event object.\n * @returns {Object} - The ad options.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdOptions(adEvent: any): Object {\n  const adOptions = {};\n  const ad = adEvent.getAd();\n  const adData = adEvent.getAdData();\n  const podInfo = ad.getAdPodInfo();\n  adOptions.system = ad.getAdSystem();\n  adOptions.url = ad.getMediaUrl();\n  adOptions.clickThroughUrl = adData && adData.clickThroughUrl;\n  adOptions.contentType = ad.getContentType();\n  adOptions.duration = ad.getDuration();\n  adOptions.position = this._adPosition || podInfo.getAdPosition();\n  adOptions.title = ad.getTitle();\n  adOptions.linear = ad.isLinear();\n  adOptions.skipOffset = ad.getSkipTimeOffset();\n  adOptions.width = ad.isLinear() ? ad.getVastMediaWidth() : ad.getWidth();\n  adOptions.height = ad.isLinear() ? ad.getVastMediaHeight() : ad.getHeight();\n  adOptions.bitrate = ad.getVastMediaBitrate();\n  adOptions.bumper = podInfo.getIsBumper() || this._isBumper;\n  return adOptions;\n}\n\n/**\n * Gets the ad break options.\n * @param {any} adEvent - The ima ad event object.\n * @returns {Object} - The ad break options.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdBreakOptions(adEvent: any): Object {\n  const adBreakOptions = {};\n  adBreakOptions.numAds = this._podLength || adEvent.getAd().getAdPodInfo().getTotalAds();\n  adBreakOptions.position = this.player.ended ? -1 : this.player.currentTime;\n  adBreakOptions.type = getAdBreakType.call(this, adEvent);\n  return adBreakOptions;\n}\n\n/**\n * Gets the ad break type.\n * @param {any} adEvent - The ima ad event object.\n * @returns {string} - The ad break type.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdBreakType(adEvent: any): string {\n  try {\n    const ad = adEvent.getAd();\n    if (!ad.isLinear()) {\n      return AdBreakType.OVERLAY;\n    }\n  } catch (e) {\n    // do nothing\n  }\n  if (this._playAdByConfig()) {\n    return getAdBreakTypeFromSdk(adEvent);\n  } else {\n    return this._getAdBreakTypeFromPlayer();\n  }\n}\n\n/**\n * Gets the ad break type from ima sdk.\n * @param {any} adEvent - The ima ad event object.\n * @returns {string} - The ad break type.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdBreakTypeFromSdk(adEvent: any): string {\n  const ad = adEvent.getAd();\n  const podInfo = ad.getAdPodInfo();\n  const podIndex = podInfo.getPodIndex();\n  if (!ad.isLinear()) {\n    return AdBreakType.OVERLAY;\n  }\n  switch (podIndex) {\n    case 0:\n      return AdBreakType.PRE;\n    case -1:\n      return AdBreakType.POST;\n    default:\n      return AdBreakType.MID;\n  }\n}\n\nexport {ImaStateMachine};\n","// @flow\nimport {core} from 'kaltura-player-js';\nimport {Ima} from './ima';\n\nconst {FakeEvent} = core;\n\n/**\n * Engine decorator for ima plugin.\n * @class ImaEngineDecorator\n * @param {IEngine} engine - The HTML5 engine.\n * @param {Ima} plugin - The ima plugin.\n * @implements {IEngineDecorator}\n */\nclass ImaEngineDecorator implements IEngineDecorator {\n  _plugin: Ima;\n\n  constructor(engine: IEngine, plugin: Ima) {\n    this._plugin = plugin;\n  }\n\n  get active(): boolean {\n    return this._plugin.playOnMainVideoTag() && this._plugin.isAdPlaying();\n  }\n\n  dispatchEvent(event: FakeEvent): boolean {\n    return event.defaultPrevented;\n  }\n  /**\n   * Get paused state.\n   * @returns {boolean} - The paused value of the engine.\n   * @public\n   * @override\n   * @instance\n   * @memberof ImaEngineDecorator\n   */\n  get paused(): boolean {\n    return true;\n  }\n  /**\n   * Get the current time in seconds.\n   * @returns {number} - The current playback time.\n   * @public\n   * @override\n   * @instance\n   * @memberof ImaEngineDecorator\n   */\n  get currentTime(): number {\n    return this._plugin.getContentTime();\n  }\n  /**\n   * Set the current time in seconds.\n   * @param {number} to - The number to set in seconds.\n   * @public\n   * @returns {void}\n   */\n  set currentTime(to: number): void {\n    // Do nothing\n  }\n  /**\n   * Get the duration in seconds.\n   * @returns {number} - The playback duration.\n   * @public\n   * @override\n   * @instance\n   * @memberof ImaEngineDecorator\n   */\n  get duration(): number {\n    return this._plugin.getContentDuration();\n  }\n  /**\n   * Get ended state\n   * @returns {boolean} - media ended\n   * @public\n   * @override\n   * @instance\n   * @memberof ImaEngineDecorator\n   */\n  get ended(): boolean {\n    return this._plugin.getContentEnded();\n  }\n}\n\nexport {ImaEngineDecorator};\n","// @flow\nimport {core, BasePlugin} from 'kaltura-player-js';\nimport {ImaMiddleware} from './ima-middleware';\nimport {ImaAdsController} from './ima-ads-controller';\nimport {ImaStateMachine} from './ima-state-machine';\nimport {State} from './state';\nimport './assets/style.css';\nimport {ImaEngineDecorator} from './ima-engine-decorator';\n\nconst {BaseMiddleware, EngineType, Error, getCapabilities, Utils, Env, AudioTrack, TextTrack, EventManager, AdBreakType} = core;\n\n/**\n * The full screen events..\n * @type {Array<string>}\n * @const\n * @private\n */\nconst FULL_SCREEN_EVENTS: Array<string> = ['fullscreenchange', 'mozfullscreenchange', 'webkitfullscreenchange'];\n\n/**\n * The overlay ad margin.\n * @type {number}\n * @const\n * @private\n */\nconst OVERLAY_AD_MARGIN: number = 8;\n/**\n * The ads container class.\n * @type {string}\n * @const\n * @private\n */\nconst ADS_CONTAINER_CLASS: string = 'playkit-ads-container';\n/**\n * The ads cover class.\n * @type {string}\n * @const\n * @private\n */\nconst ADS_COVER_CLASS: string = 'playkit-ads-cover';\n\n/**\n * The ima plugin.\n * @class Ima\n * @param {string} name - The plugin name.\n * @param {Player} player - The player instance.\n * @param {ImaConfigObject} config - The plugin config.\n * @implements {IMiddlewareProvider}\n * @implements {IAdsControllerProvider}\n * @implements {IEngineDecoratorProvider}\n * @extends BasePlugin\n */\nclass Ima extends BasePlugin implements IMiddlewareProvider, IAdsControllerProvider, IEngineDecoratorProvider {\n  /**\n   * The default configuration of the plugin.\n   * @type {Object}\n   * @static\n   * @memberof Ima\n   */\n  static defaultConfig: Object = {\n    debug: false,\n    delayInitUntilSourceSelected: Env.os.name === 'iOS',\n    disableMediaPreload: false,\n    forceReloadMediaAfterAds: false,\n    adsRenderingSettings: {\n      restoreCustomPlaybackStateOnAdBreakComplete: false,\n      enablePreloading: false,\n      useStyledLinearAds: false,\n      useStyledNonLinearAds: true,\n      bitrate: -1,\n      autoAlign: true,\n      loadVideoTimeout: -1\n    },\n    companions: {\n      ads: null,\n      sizeCriteria: 'SELECT_EXACT_MATCH'\n    }\n  };\n\n  /**\n   * The sdk lib url.\n   * @type {string}\n   * @static\n   * @private\n   * @memberof Ima\n   */\n  static IMA_SDK_LIB_URL: string = '//imasdk.googleapis.com/js/sdkloader/ima3.js';\n  /**\n   * The debug sdk lib url.\n   * @type {string}\n   * @static\n   * @private\n   * @memberof Ima\n   */\n  static IMA_SDK_DEBUG_LIB_URL: string = '//imasdk.googleapis.com/js/sdkloader/ima3_debug.js';\n  /**\n   * Promise for loading the plugin.\n   * Will be resolved after:\n   * 1) Ima script has been loaded in the page.\n   * 2) The ads manager has been loaded and ready to start.\n   * @type {Promise<*>}\n   * @member\n   * @public\n   * @memberof Ima\n   */\n  loadPromise: DeferredPromise;\n  /**\n   * The finite state machine of the plugin.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _stateMachine: any;\n  /**\n   * The sdk api.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _sdk: any;\n  /**\n   * The ads container dom element.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _adsContainerDiv: HTMLElement;\n  /**\n   * The ads cover dom element.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _adsCoverDiv: HTMLElement;\n  /**\n   * The ima ads container object.\n   * @private\n   * @memberof Ima\n   */\n  _adDisplayContainer: any;\n  /**\n   * The ima ads manager.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _adsManager: any;\n  /**\n   * The ima ads loader.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _adsLoader: any;\n  /**\n   * The content tracker.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _contentPlayheadTracker: Object;\n  /**\n   * Flag to know when content complete.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _contentComplete: boolean;\n  /**\n   * Video current time before ads.\n   * On custom playback when only one video tag playing, save the video current time.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _videoLastCurrentTime: ?number;\n  /**\n   * The promise which when resolved starts the next handler in the middleware chain.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _nextPromise: ?DeferredPromise;\n  /**\n   * The current playing ad.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _currentAd: any;\n  /**\n   * The content media duration.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _contentDuration: ?number;\n  /**\n   * The content media src.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _contentSrc: string;\n\n  /**\n   * Whether an initial user action happened.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _hasUserAction: boolean;\n  /**\n   * Whether the ads manager loaded.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _isAdsManagerLoaded: boolean;\n  /**\n   * The bounded handler of the ads container click.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _togglePlayPauseOnAdsContainerCallback: ?Function;\n  /**\n   * Whether the ads cover overlay is active.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _isAdsCoverActive: boolean;\n  _selectedAudioTrack: ?AudioTrack;\n  _selectedTextTrack: ?TextTrack;\n  _selectedPlaybackRate: number;\n  _textTracksHidden: Array<string>;\n  _adBreaksEventManager: EventManager;\n  _podLength: number;\n  _adPosition: number;\n  _firstOfAdPod: boolean;\n  _waterfalled: boolean;\n  _isBumper: boolean;\n  _adVideoTagAlreadyPlayed: boolean = false;\n\n  /**\n   * Whether the ima plugin is valid.\n   * @static\n   * @override\n   * @public\n   * @memberof Ima\n   */\n  static isValid() {\n    return true;\n  }\n\n  constructor(name: string, player: KalturaPlayer, config: Object) {\n    super(name, player, config);\n    this._stateMachine = new ImaStateMachine(this);\n    this._initMembers();\n    this._init();\n  }\n\n  /**\n   * Gets the engine decorator.\n   * @param {IEngine} engine - The engine to decorate.\n   * @public\n   * @returns {IEngineDecorator} - The ads api.\n   * @instance\n   * @memberof Ima\n   */\n  getEngineDecorator(engine: IEngine): IEngineDecorator {\n    return new ImaEngineDecorator(engine, this);\n  }\n\n  /**\n   * Gets the middleware.\n   * @public\n   * @returns {ImaMiddleware} - The middleware api.\n   * @instance\n   * @memberof Ima\n   */\n  getMiddlewareImpl(): BaseMiddleware {\n    return new ImaMiddleware(this);\n  }\n\n  /**\n   * Gets the ads controller.\n   * @public\n   * @returns {IAdsPluginController} - The ads api.\n   * @instance\n   * @memberof Ima\n   */\n  getAdsController(): IAdsPluginController {\n    return new ImaAdsController(this);\n  }\n\n  /**\n   * Plays ad on demand\n   * @param {KPAdPod} adPod - The ad pod to play.\n   * @returns {void}\n   * @public\n   * @instance\n   * @memberof Ima\n   */\n  playAdNow(adPod: KPAdPod): void {\n    if (Array.isArray(adPod) && !(this.isAdPlaying() || this._playAdByConfig())) {\n      this._playAdBreak(adPod);\n    }\n  }\n\n  _playAdBreak(adPod: KPAdPod): void {\n    this._podLength = adPod.length;\n    this._adPosition = 1;\n    this._firstOfAdPod = true;\n    this._waterfalled = false;\n    this.loadPromise\n      .then(() => {\n        this._playAd(adPod);\n        if (!this._hasUserAction && this.player.currentTime > 0) {\n          this.initialUserAction();\n        }\n      })\n      .catch(() => {});\n  }\n\n  _playAd(adPod: KPAdPod): void {\n    const ad = adPod[0];\n    const playNext = () => {\n      adPod.shift();\n      this._adBreaksEventManager.removeAll();\n      this._waterfalled = false;\n      this._podLength = adPod.length;\n      this._adPosition++;\n      this._playAd(adPod);\n    };\n    const waterfall = error => {\n      this.dispatchEvent(this.player.Event.AD_WATERFALLING, {\n        adFailed: {\n          url: ad.url ? ad.url[0] : '',\n          response: !ad.url && ad.response ? ad.response[0] : '',\n          data: error,\n          adBreak: this._getAdBreakTypeFromPlayer(),\n          position: this._adPosition\n        }\n      });\n      this._adBreaksEventManager.removeAll();\n      this._waterfalled = true;\n      ad.url ? ad.url.shift() : ad.response && ad.response.shift();\n      this._playAd(adPod);\n    };\n    const onError = error => {\n      if ((ad.url && ad.url.length > 1) || (!ad.url && ad.response && ad.response.length > 1)) {\n        waterfall(error);\n      } else {\n        if (this._waterfalled) {\n          this.dispatchEvent(this.player.Event.AD_WATERFALLING_FAILED);\n        }\n        this._stateMachine.adlog(error);\n        playNext();\n      }\n    };\n    if (ad) {\n      this._adBreaksEventManager.listen(this._adsLoader, this._sdk.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, () => {\n        this._adBreaksEventManager.listen(this._adsManager, this._sdk.AdEvent.Type.COMPLETE, playNext);\n        this._adBreaksEventManager.listen(this._adsManager, this._sdk.AdEvent.Type.SKIPPED, playNext);\n        this._adBreaksEventManager.listen(this._adsManager, this._sdk.AdEvent.Type.LOG, onError);\n        this._adBreaksEventManager.listen(this._adsManager, this._sdk.AdErrorEvent.Type.AD_ERROR, onError);\n      });\n      this._adBreaksEventManager.listen(this._adsLoader, this._sdk.AdErrorEvent.Type.AD_ERROR, error => {\n        onError(error);\n        if (this._podLength === 0) {\n          if (this.player.ads.isAdBreak()) {\n            this._stateMachine.adbreakend({type: this._sdk.AdEvent.Type.CONTENT_RESUME_REQUESTED});\n          }\n          if (this._hasUserAction) {\n            this._stateMachine.adscompleted({type: this._sdk.AdEvent.Type.ALL_ADS_COMPLETED});\n          } else {\n            this.eventManager.listen(this.player, this.player.Event.FIRST_PLAY, () => {\n              this._stateMachine.adscompleted({type: this._sdk.AdEvent.Type.ALL_ADS_COMPLETED});\n            });\n          }\n        }\n      });\n      this._isBumper = !!ad.bumper;\n      this._requestAds(ad.url && ad.url[0], ad.response && ad.response[0]);\n    }\n  }\n\n  _getAdBreakTypeFromPlayer(): string {\n    if (this.player.ended) {\n      return AdBreakType.POST;\n    }\n    if (this.player.currentTime > 0) {\n      return AdBreakType.MID;\n    }\n    return AdBreakType.PRE;\n  }\n\n  /**\n   * Skips on an ad.\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  skipAd(): void {\n    this.logger.debug('Skip ad');\n    if (this._adsManager) {\n      if (this._adsManager.getAdSkippableState()) {\n        this._adsManager.skip();\n      } else if (this.config.skipSupport) {\n        this._adsManager.stop();\n      }\n    }\n  }\n\n  /**\n   * Resuming the ad.\n   * @public\n   * @returns {DeferredPromise} - The promise which when resolved starts the next handler in the middleware chain.\n   * @instance\n   * @memberof Ima\n   */\n  resumeAd(): ?DeferredPromise {\n    this.logger.debug('Resume ad');\n    this._nextPromise = Utils.Object.defer();\n    this._adsManager.resume();\n    return this._nextPromise;\n  }\n\n  /**\n   * Pausing the ad.\n   * @public\n   * @returns {DeferredPromise} - The promise which when resolved starts the next handler in the middleware chain.\n   * @instance\n   * @memberof Ima\n   */\n  pauseAd(): ?DeferredPromise {\n    this.logger.debug('Pause ad');\n    this._adsManager.pause();\n  }\n\n  /**\n   * Gets the state machine.\n   * @public\n   * @returns {any} - The state machine.\n   * @instance\n   * @memberof Ima\n   */\n  getStateMachine(): any {\n    return this._stateMachine;\n  }\n\n  /**\n   * Gets the indicator if ads playing on the main video tag\n   * @public\n   * @returns {boolean} - if ads playing on the main video tag.\n   * @instance\n   * @memberof Ima\n   */\n  playOnMainVideoTag() {\n    return !!this._adsManager && !!this._adsManager.isCustomPlaybackUsed();\n  }\n\n  /**\n   * Gets the indicator if ads still playing.\n   * @public\n   * @returns {boolean} - if ads still playing.\n   * @instance\n   * @memberof Ima\n   */\n  isAdPlaying(): boolean {\n    return this._stateMachine.is(State.PLAYING) || this._stateMachine.is(State.PENDING) || this._stateMachine.is(State.PAUSED);\n  }\n\n  getContentTime(): number {\n    let currentTime = 0;\n    //current time exist for mid-roll otherwise it's pre-roll(start of video - 0) - post-roll(end of video)\n    if (this._videoLastCurrentTime) {\n      currentTime = this._videoLastCurrentTime;\n    } else if (this._contentComplete) {\n      currentTime = this.getContentDuration();\n    }\n    return currentTime;\n  }\n\n  getContentDuration(): number {\n    return this._contentDuration || this.player.config.sources.duration || 0;\n  }\n\n  getContentSrc(): string {\n    return this._contentSrc || '';\n  }\n  getContentEnded(): boolean {\n    return this._contentComplete;\n  }\n  /**\n   * Prepare the plugin before media is loaded.\n   * @override\n   * @public\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  loadMedia(): void {\n    this._addBindings();\n    if (this._playAdByConfig()) {\n      this.loadPromise.then(() => this._requestAds()).catch(() => {});\n    }\n  }\n\n  /**\n   * Resets the plugin.\n   * @override\n   * @public\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  reset(): void {\n    this.logger.debug('reset');\n    this.eventManager.removeAll();\n    this._adBreaksEventManager.removeAll();\n    this._hideAdsContainer();\n    if (!this._isImaSDKLibLoaded()) {\n      return;\n    }\n    if (this._adsManager) {\n      this._adsManager.destroy();\n    }\n    if (this._adsLoader && !this._contentComplete) {\n      this._adsLoader.contentComplete();\n    }\n    this._stateMachine.goto(State.DONE);\n    this._initMembers();\n  }\n\n  /**\n   * Destroys the plugin.\n   * @override\n   * @public\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  destroy(): void {\n    this.logger.debug('destroy');\n    this.eventManager.destroy();\n    this._hideAdsContainer();\n    if (this._adsManager) {\n      this._adsManager.destroy();\n    }\n    if (this._adsLoader && !this._contentComplete) {\n      this._adsLoader.contentComplete();\n    }\n    if (this._adDisplayContainer) {\n      this._adDisplayContainer.destroy();\n    }\n    this._adsLoader = null;\n  }\n\n  /**\n   * Initialize the ads for the first time.\n   * @public\n   * @returns {?DeferredPromise} - The promise which when resolved starts the next handler in the middleware chain.\n   * @instance\n   * @memberof Ima\n   */\n  initialUserAction(): ?DeferredPromise {\n    try {\n      this.logger.debug('Initial user action');\n      this._nextPromise = Utils.Object.defer();\n      this._adDisplayContainer.initialize();\n      this._hasUserAction = true;\n      if (this._isAdsManagerLoaded) {\n        this.logger.debug('User action occurred after ads manager loaded');\n        this._startAdsManager();\n      }\n    } catch (adError) {\n      this.logger.error(adError);\n      this.reset();\n    }\n    return this._nextPromise;\n  }\n\n  /**\n   * Starts the ads manager.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _startAdsManager(): void {\n    this.logger.debug('Start ads manager');\n    const readyPromise = this.playOnMainVideoTag() && !this.config.disableMediaPreload ? this.player.ready() : Promise.resolve();\n    readyPromise.then(() => {\n      this._adsManager.init(this.player.dimensions.width, this.player.dimensions.height, this._sdk.ViewMode.NORMAL);\n      this._adsManager.start();\n    });\n  }\n\n  /**\n   * Adding bindings.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _addBindings(): void {\n    FULL_SCREEN_EVENTS.forEach(fullScreenEvent => this.eventManager.listen(document, fullScreenEvent, () => this._resizeAd()));\n    this.eventManager.listen(this.player, 'resize', () => this._resizeAd());\n    this.eventManager.listen(this.player, this.player.Event.MUTE_CHANGE, () => this._syncPlayerVolume());\n    this.eventManager.listen(this.player, this.player.Event.VOLUME_CHANGE, () => this._syncPlayerVolume());\n    this.eventManager.listen(this.player, this.player.Event.SOURCE_SELECTED, event => {\n      let selectedSource = event.payload.selectedSource;\n      if (selectedSource && selectedSource.length > 0) {\n        this._contentSrc = selectedSource[0].url;\n      }\n    });\n    this.eventManager.listenOnce(this.player, this.player.Event.DURATION_CHANGE, () => {\n      this._contentDuration = this.player.duration;\n    });\n    this.eventManager.listen(this.player, this.player.Event.ERROR, event => {\n      if (event.payload && event.payload.severity === Error.Severity.CRITICAL) {\n        this.reset();\n      }\n    });\n    this.eventManager.listen(this.player, this.player.Event.FIRST_PLAY, () => {\n      if (this._currentAd && !this._currentAd.isLinear()) {\n        this._showAdsContainer();\n      }\n    });\n    this.eventManager.listen(this.player, this.player.Event.MEDIA_LOADED, () => {\n      this._adsManager.updateAdsRenderingSettings({\n        restoreCustomPlaybackStateOnAdBreakComplete: !this.player.config.playback.playAdsWithMSE\n      });\n    });\n    this.eventManager.listen(this.player, this.player.Event.ENDED, () => this._onMediaEnded());\n    this.eventManager.listen(this.player, this.player.Event.LOADED_METADATA, () => this._onLoadedMetadata());\n    this.eventManager.listen(this.player, this.player.Event.TIME_UPDATE, () => this._onMediaTimeUpdate());\n    this.eventManager.listen(this.player, this.player.Event.SEEKING, () => this._onMediaSeeking());\n    this.eventManager.listen(this.player, this.player.Event.SEEKED, () => this._onMediaSeeked());\n    if (!this._playAdByConfig()) {\n      this.eventManager.listenOnce(this.player, this.player.Event.USER_GESTURE, () => {\n        if (!this._adVideoTagAlreadyPlayed) {\n          this._adDisplayContainer.initialize();\n        }\n      });\n    }\n  }\n\n  /**\n   * Init the members of the plugin.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _initMembers(): void {\n    this._nextPromise = null;\n    this._currentAd = null;\n    this._adsManager = null;\n    this._contentComplete = false;\n    this._isAdsManagerLoaded = false;\n    this._videoLastCurrentTime = null;\n    this._contentPlayheadTracker = {currentTime: 0, previousTime: 0, seeking: false, duration: 0};\n    this._hasUserAction = false;\n    this._togglePlayPauseOnAdsContainerCallback = null;\n    this._contentDuration = null;\n    this._selectedAudioTrack = null;\n    this._selectedTextTrack = null;\n    this._selectedPlaybackRate = 1;\n    this._textTracksHidden = [];\n    this._adBreaksEventManager = new EventManager();\n    this._podLength = 0;\n    this._adPosition = 0;\n    this._firstOfAdPod = false;\n    this._waterfalled = false;\n    this._isBumper = false;\n  }\n\n  /**\n   * Initializing the plugin.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _init(): void {\n    this.loadPromise = Utils.Object.defer();\n    this._maybeDelayInitUntilSourceSelected()\n      .then(() => this._loadImaSDKLib())\n      .then(() => {\n        this._sdk = window.google.ima;\n        this.logger.debug('IMA SDK version: ' + this._sdk.VERSION);\n        this._initImaSettings();\n        this._initAdsContainer();\n        this._initAdsLoader();\n        this.loadPromise.resolve();\n      })\n      .catch(e => {\n        this.loadPromise.reject(e);\n      });\n  }\n\n  /**\n   * If configured, wait until source selected before will continue the initialization of the plugin.\n   * @returns {Promise<*>} -\n   * @private\n   * @instance\n   * @memberof Ima\n   */\n  _maybeDelayInitUntilSourceSelected(): Promise<*> {\n    if (this.config.delayInitUntilSourceSelected) {\n      return new Promise((resolve, reject) => {\n        if (this._contentSrc) {\n          // Source selected event already dispatched\n          resolve();\n        } else {\n          this.eventManager.listenOnce(this.player, this.player.Event.SOURCE_SELECTED, resolve);\n          this.eventManager.listenOnce(this.player, this.player.Event.ERROR, error => {\n            if (error.payload.severity === Error.Severity.CRITICAL) {\n              reject(error);\n            }\n          });\n        }\n      });\n    } else {\n      return Promise.resolve();\n    }\n  }\n\n  /**\n   * Loads the ima sdk lib.\n   * @returns {Promise<*>} - The promise result for the load operation.\n   * @private\n   * @instance\n   * @memberof Ima\n   */\n  _loadImaSDKLib(): Promise<*> {\n    const imaSdkUrl = Utils.Http.protocol + (this.config.debug ? Ima.IMA_SDK_DEBUG_LIB_URL : Ima.IMA_SDK_LIB_URL);\n    return this._isImaSDKLibLoaded() ? Promise.resolve() : Utils.Dom.loadScriptAsync(imaSdkUrl);\n  }\n\n  /**\n   * Checks for ima sdk lib availability.\n   * @returns {boolean} - Whether ima sdk lib is loaded.\n   * @private\n   * @instance\n   * @memberof Ima\n   */\n  _isImaSDKLibLoaded(): boolean {\n    return window.google && window.google.ima && window.google.ima.VERSION;\n  }\n\n  /**\n   * Init ima settings.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _initImaSettings(): void {\n    this._sdk.settings.setPlayerType(this.config.playerName);\n    this._sdk.settings.setPlayerVersion(this.config.playerVersion);\n    this._sdk.settings.setVpaidAllowed(true);\n    this._sdk.settings.setVpaidMode(this._getVpaidMode());\n    if (Object.prototype.hasOwnProperty.call(this.config, 'locale')) {\n      this._sdk.settings.setLocale(this.config.locale);\n    }\n    if (typeof this.config.setDisableCustomPlaybackForIOS10Plus === 'boolean') {\n      this._sdk.settings.setDisableCustomPlaybackForIOS10Plus(this.config.setDisableCustomPlaybackForIOS10Plus);\n    } else {\n      this._sdk.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playback.playsinline);\n    }\n    if (typeof this.config.numRedirects === 'number') {\n      this._sdk.settings.setNumRedirects(this.config.numRedirects);\n    }\n  }\n\n  /**\n   * Gets the vpaid mode.\n   * @private\n   * @returns {number} - The vpaid mode.\n   * @instance\n   * @memberof Ima\n   */\n  _getVpaidMode(): number {\n    const vpaidmode = this._sdk.ImaSdkSettings.VpaidMode[this.config.vpaidMode];\n    if (this.config.vpaidMode && typeof vpaidmode === 'number') {\n      this.logger.debug('VpaidMode: set to ' + this.config.vpaidMode);\n      return vpaidmode;\n    } else {\n      this.logger.warn('VpaidMode is not set, setting to ENABLED');\n      return this._sdk.ImaSdkSettings.VpaidMode.ENABLED;\n    }\n  }\n\n  /**\n   * Initializing the ad container.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _initAdsContainer(): void {\n    this.logger.debug('Init ads container');\n    const playerView = this.player.getView();\n    // Create ads container\n    this._adsContainerDiv = Utils.Dom.createElement('div');\n    this._adsContainerDiv.id = ADS_CONTAINER_CLASS + playerView.id;\n    this._adsContainerDiv.className = ADS_CONTAINER_CLASS;\n\n    // Create ads cover\n    this._adsCoverDiv = Utils.Dom.createElement('div');\n    this._adsCoverDiv.id = ADS_COVER_CLASS + playerView.id;\n    this._adsCoverDiv.className = ADS_COVER_CLASS;\n    this._adsCoverDiv.onclick = () => this._onAdsCoverClicked();\n    // Append the ads container to the dom\n    Utils.Dom.appendChild(playerView, this._adsContainerDiv);\n    this._adDisplayContainer = new this._sdk.AdDisplayContainer(this._adsContainerDiv, this.player.getVideoElement());\n  }\n\n  /**\n   * Initializing the ads loader.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _initAdsLoader(): void {\n    this.logger.debug('Init ads loader');\n    this._adsLoader = new this._sdk.AdsLoader(this._adDisplayContainer);\n    this._adsLoader.addEventListener(this._sdk.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, adsManagerLoadedEvent =>\n      this._onAdsManagerLoaded(adsManagerLoadedEvent)\n    );\n    this._adsLoader.addEventListener(this._sdk.AdErrorEvent.Type.AD_ERROR, adEvent => this._stateMachine.aderror(adEvent));\n  }\n\n  /**\n   * Requests the ads from the ads loader.\n   * @param {?string} vastUrl - vast url.\n   * @param {?string} vastResponse - vast XML response.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _requestAds(vastUrl: ?string, vastResponse: ?string): void {\n    if (vastUrl || vastResponse || this._playAdByConfig()) {\n      this.logger.debug('Request ads');\n      // Request video ads\n      let adsRequest = new this._sdk.AdsRequest();\n      const adTagUrl = vastUrl || this.config.adTagUrl;\n      if (adTagUrl) {\n        adsRequest.adTagUrl = adTagUrl;\n      } else {\n        adsRequest.adsResponse = vastResponse || this.config.adsResponse;\n      }\n      if (typeof this.config.vastLoadTimeout === 'number') {\n        adsRequest.vastLoadTimeout = this.config.vastLoadTimeout;\n      }\n      adsRequest.linearAdSlotWidth = this.player.dimensions.width;\n      adsRequest.linearAdSlotHeight = this.player.dimensions.height;\n      adsRequest.nonLinearAdSlotWidth = this.player.dimensions.width;\n      adsRequest.nonLinearAdSlotHeight = this.player.dimensions.height / 3;\n\n      const muted = this.player.muted || this.player.volume === 0;\n      adsRequest.setAdWillPlayMuted(muted);\n\n      const adWillAutoPlay = this.config.adWillAutoPlay;\n      const playerWillAutoPlay = this.player.config.playback.autoplay;\n      const allowMutedAutoPlay = this.player.config.playback.allowMutedAutoPlay;\n\n      // Pass signal to IMA SDK if ad will autoplay with sound\n      // First let application config this, otherwise if player is configured\n      // to autoplay then try to autodetect if unmuted autoplay is supported\n      if (typeof adWillAutoPlay === 'boolean') {\n        adsRequest.setAdWillAutoPlay(adWillAutoPlay);\n        this._adsLoader.requestAds(adsRequest);\n      } else if (playerWillAutoPlay) {\n        getCapabilities(EngineType.HTML5).then(capabilities => {\n          // If the plugin has been destroyed while calling this promise\n          // the adsLoader will no longer exists\n          if (!this._adsLoader) return;\n\n          if (capabilities.autoplay) {\n            adsRequest.setAdWillAutoPlay(true);\n          } else if (allowMutedAutoPlay && capabilities.mutedAutoPlay) {\n            adsRequest.setAdWillAutoPlay(true);\n            adsRequest.setAdWillPlayMuted(true);\n          } else {\n            adsRequest.setAdWillAutoPlay(false);\n          }\n          this._adsLoader.requestAds(adsRequest);\n        });\n      } else {\n        adsRequest.setAdWillAutoPlay(false);\n        this._adsLoader.requestAds(adsRequest);\n      }\n      this._stateMachine.loaded();\n    } else {\n      this._stateMachine.goto(State.DONE);\n      this.logger.debug('Missing ad tag url: create plugin without requesting ads');\n    }\n  }\n\n  /**\n   * Resize event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _resizeAd() {\n    if (this._sdk && this._adsManager && this._currentAd) {\n      let viewMode = this.player.isFullscreen() ? this._sdk.ViewMode.FULLSCREEN : this._sdk.ViewMode.NORMAL;\n      if (this._currentAd.isLinear()) {\n        this._adsManager.resize(this.player.dimensions.width, this.player.dimensions.height, viewMode);\n      } else {\n        const adTotalWidth = this._currentAd.getWidth() + OVERLAY_AD_MARGIN;\n        const adTotalHeight = this._currentAd.getHeight() + OVERLAY_AD_MARGIN;\n        if (adTotalWidth <= this.player.dimensions.width && adTotalHeight <= this.player.dimensions.height) {\n          this._alignAdsContainerSizeForOverlayAd();\n          this._adsManager.resize(adTotalWidth, adTotalHeight, viewMode);\n          this._showAdsContainer();\n        } else {\n          this._hideAdsContainer();\n        }\n      }\n    }\n  }\n\n  /**\n   * Align the size for the ads container when overlay ad is displaying.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _alignAdsContainerSizeForOverlayAd(): void {\n    this._adsContainerDiv.style.bottom = this._currentAd.getHeight() + OVERLAY_AD_MARGIN + 'px';\n    this._adsContainerDiv.style.left = (this.player.dimensions.width - this._currentAd.getWidth()) / 2 + 'px';\n  }\n\n  /**\n   * Loadedmetada event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   * @instance\n   * @memberof Ima\n   */\n  _onLoadedMetadata(): void {\n    this._contentPlayheadTracker.duration = this.player.duration;\n  }\n\n  /**\n   * Timeupdate event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onMediaTimeUpdate(): void {\n    if (!this._contentPlayheadTracker.seeking && this.player.currentTime > 0) {\n      this._contentPlayheadTracker.previousTime = this._contentPlayheadTracker.currentTime;\n      this._contentPlayheadTracker.currentTime = this.player.currentTime;\n    }\n  }\n\n  /**\n   * Seeking event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onMediaSeeking(): void {\n    this._contentPlayheadTracker.seeking = true;\n  }\n\n  /**\n   * Seeked event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onMediaSeeked(): void {\n    this._contentPlayheadTracker.seeking = false;\n  }\n\n  /**\n   * Maybe save the video current time before ads starts (on ios this is necessary).\n   * @private\n   * @return {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeSaveVideoCurrentTime(): void {\n    if ((this.playOnMainVideoTag() || this.config.forceReloadMediaAfterAds) && this.player.currentTime && this.player.currentTime > 0) {\n      this.logger.debug('Custom playback used: save current time before ads', this.player.currentTime);\n      this._videoLastCurrentTime = this.player.currentTime;\n    }\n  }\n\n  /**\n   * Maybe sets the video current time after ads finished (on ios this is necessary).\n   * @private\n   * @return {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeSetVideoCurrentTime(): void {\n    if (this._videoLastCurrentTime) {\n      this.logger.debug('Custom playback used: set current time after ads', this._videoLastCurrentTime);\n      this.player.currentTime = this._videoLastCurrentTime;\n      this._videoLastCurrentTime = null;\n    }\n  }\n\n  /**\n   * Ended event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onMediaEnded(): void {\n    this.logger.debug('Media ended');\n    this._contentComplete = true;\n    if (this._currentAd && !this._currentAd.isLinear()) {\n      this.reset();\n    }\n  }\n\n  /**\n   * Ended event handler.\n   * @public\n   * @returns {Promise<void>} - complete promise\n   * @instance\n   * @memberof Ima\n   */\n  onPlaybackEnded(): Promise<void> {\n    this.logger.debug('Playback ended');\n    this._adsLoader.contentComplete();\n    if (this._adsManager && this._adsManager.getCuePoints().includes(-1)) {\n      return new Promise(resolve => {\n        this.eventManager.listenOnce(this._adsManager, this._sdk.AdEvent.Type.ALL_ADS_COMPLETED, () => {\n          resolve();\n        });\n      });\n    }\n    return Promise.resolve();\n  }\n\n  /**\n   * Shows the ads container.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _showAdsContainer(): void {\n    if (this._adsContainerDiv) {\n      this._adsContainerDiv.style.visibility = 'visible';\n    }\n  }\n\n  /**\n   * Hides the ads container.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _hideAdsContainer(): void {\n    if (this._adsContainerDiv) {\n      this._adsContainerDiv.style.visibility = 'hidden';\n    }\n  }\n\n  /**\n   * The ads manager loaded handler.\n   * @param {any} adsManagerLoadedEvent - The event data.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onAdsManagerLoaded(adsManagerLoadedEvent: any): void {\n    this.logger.debug('Ads manager loaded');\n    const adsRenderingSettings = this._getAdsRenderingSetting();\n    this._adsManager = adsManagerLoadedEvent.getAdsManager(this._contentPlayheadTracker, adsRenderingSettings);\n    this.config.forceReloadMediaAfterAds = this.playOnMainVideoTag() ? false : this.config.forceReloadMediaAfterAds;\n    const cuePoints = this._adsManager.getCuePoints();\n    if (!cuePoints.length) {\n      cuePoints.push(0);\n    }\n    if (this._playAdByConfig()) {\n      this.dispatchEvent(this.player.Event.AD_MANIFEST_LOADED, {adBreaksPosition: cuePoints});\n    }\n    this._isAdsManagerLoaded = true;\n    this._attachAdsManagerListeners();\n    this._syncPlayerVolume();\n    if (this._hasUserAction) {\n      this.logger.debug('User action occurred before ads manager loaded');\n      this._startAdsManager();\n    }\n  }\n\n  /**\n   * returns the ads rendering settings configuration for IMA with plugin config applied\n   * @returns {Object} - IMA AdsRenderingSettings object\n   * @private\n   * @instance\n   * @memberof Ima\n   */\n  _getAdsRenderingSetting(): Object {\n    let adsRenderingSettings = new this._sdk.AdsRenderingSettings();\n    Object.keys(this.config.adsRenderingSettings).forEach(setting => {\n      if (adsRenderingSettings[setting] !== undefined) {\n        adsRenderingSettings[setting] = this.config.adsRenderingSettings[setting];\n      } else {\n        this.logger.warn('unsupported adsRenderingSettings was set:', setting);\n      }\n    });\n    adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete = false;\n    if (typeof this.config.adsRenderingSettings.playAdsAfterTime !== 'number') {\n      adsRenderingSettings.playAdsAfterTime = this.player.config.playback.startTime;\n    }\n    return adsRenderingSettings;\n  }\n\n  /**\n   * Attach the ads manager listeners.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _attachAdsManagerListeners(): void {\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.CONTENT_PAUSE_REQUESTED, adEvent => {\n      if (this._playAdByConfig() || this._firstOfAdPod) {\n        this._firstOfAdPod = false;\n        this._stateMachine.adbreakstart(adEvent);\n      }\n    });\n\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.CONTENT_RESUME_REQUESTED, adEvent => {\n      if (this._playAdByConfig() || this._podLength === 0) {\n        this._stateMachine.adbreakend(adEvent);\n      }\n    });\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.ALL_ADS_COMPLETED, adEvent => {\n      if (this._playAdByConfig() || this._podLength === 0) {\n        this._stateMachine.adscompleted(adEvent);\n      }\n    });\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.LOADED, adEvent => this._stateMachine.adloaded(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.STARTED, adEvent => this._stateMachine.adstarted(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.PAUSED, adEvent => this._stateMachine.adpaused(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.RESUMED, adEvent => this._stateMachine.adresumed(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.FIRST_QUARTILE, adEvent => this._stateMachine.adfirstquartile(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.MIDPOINT, adEvent => this._stateMachine.admidpoint(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.THIRD_QUARTILE, adEvent => this._stateMachine.adthirdquartile(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.CLICK, adEvent => this._stateMachine.adclicked(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.SKIPPED, adEvent => this._stateMachine.adskipped(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.COMPLETE, adEvent => this._stateMachine.adcompleted(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.USER_CLOSE, adEvent => this._stateMachine.userclosedad(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.VOLUME_CHANGED, adEvent => this._stateMachine.advolumechanged(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.VOLUME_MUTED, adEvent => this._stateMachine.admuted(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.AD_PROGRESS, adEvent => this._stateMachine.adprogress(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.AD_BUFFERING, adEvent => this._stateMachine.adbuffering(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.LOG, adEvent => this._stateMachine.adlog(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.SKIPPABLE_STATE_CHANGED, adEvent => this._stateMachine.adcanskip(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdErrorEvent.Type.AD_ERROR, adEvent => this._stateMachine.aderror(adEvent));\n  }\n\n  /**\n   * Syncs the player volume.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _syncPlayerVolume(): void {\n    if (this._adsManager) {\n      if (this.player.muted) {\n        this._adsManager.setVolume(0);\n      } else {\n        if (this._adsManager && !isNaN(this.player.volume) && typeof this.player.volume === 'number') {\n          this._adsManager.setVolume(this.player.volume);\n        }\n      }\n    }\n  }\n\n  /**\n   * Resolves the next promise to let the next handler in the middleware chain start.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _resolveNextPromise(): void {\n    if (this._nextPromise) {\n      this._nextPromise.resolve();\n      this._nextPromise = null;\n    }\n  }\n\n  /**\n   * Toggle the ads cover div.\n   * @param {boolean} enable - Whether to add or remove the ads cover.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _setToggleAdsCover(enable: boolean): void {\n    if (enable) {\n      if (!this.playOnMainVideoTag()) {\n        if (this._adsContainerDiv.parentNode) {\n          this._adsContainerDiv.parentNode.insertBefore(this._adsCoverDiv, this._adsContainerDiv.nextSibling);\n          this._isAdsCoverActive = true;\n        }\n      }\n    } else {\n      if (this._isAdsCoverActive) {\n        if (this._adsContainerDiv.parentNode) {\n          this._adsContainerDiv.parentNode.removeChild(this._adsCoverDiv);\n          this._isAdsCoverActive = false;\n        }\n      }\n    }\n  }\n\n  /**\n   * On ads cover click handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onAdsCoverClicked(): void {\n    if (this._adsManager) {\n      switch (this._stateMachine.state) {\n        case State.PAUSED:\n          this._adsManager.resume();\n          break;\n        case State.PLAYING:\n          this._adsManager.pause();\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  /**\n   * Displays companion ads using the Ad API.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeDisplayCompanionAds(): void {\n    if (this.config.companions && this.config.companions.ads && !window.googletag) {\n      const selectionCriteria = new this._sdk.CompanionAdSelectionSettings();\n      selectionCriteria.resourceType = this._sdk.CompanionAdSelectionSettings.ResourceType.ALL;\n      selectionCriteria.creativeType = this._sdk.CompanionAdSelectionSettings.CreativeType.ALL;\n      const sizeCriteria = this.config.companions.sizeCriteria;\n      selectionCriteria.sizeCriteria =\n        this._sdk.CompanionAdSelectionSettings.SizeCriteria[sizeCriteria] || this._sdk.CompanionAdSelectionSettings.SizeCriteria.SELECT_EXACT_MATCH;\n      const companionsIds = Object.keys(this.config.companions.ads);\n      for (let i = 0; i < companionsIds.length; i++) {\n        const id = companionsIds[i];\n        const ad = this.config.companions.ads[id];\n        const width = ad.width;\n        const height = ad.height;\n        try {\n          const companionAds = this._currentAd.getCompanionAds(width, height, selectionCriteria);\n          if (companionAds.length > 0) {\n            const companionAd = companionAds[0];\n            const content = companionAd.getContent();\n            const el = Utils.Dom.getElementById(id);\n            if (el) {\n              el.innerHTML = content;\n            }\n          }\n        } catch (e) {\n          this.logger.error('Error occurred while extracting companion ad', e);\n        }\n      }\n    }\n  }\n\n  /**\n   * On Chrome-Android we're ignoring LearnMore click to enable\n   * video element manipulation only on user gesture.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeIgnoreClickOnAd(): void {\n    const isAndroid = () => this.player.env.os.name === 'Android';\n    const isChrome = () => this.player.env.browser.name === 'Chrome';\n    if (isAndroid() && isChrome()) {\n      this.eventManager.listenOnce(this.player.getView(), 'click', e => e.stopPropagation());\n    }\n  }\n\n  /**\n   * On iOS AVPlayer caption stack on video tag, should re-position to hide\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _hideActiveTextTracksOnAVPlayer(): void {\n    const isIOS = this.player.env.os.name === 'iOS';\n    if (isIOS && this.playOnMainVideoTag()) {\n      let tracks = this.player.getVideoElement().textTracks;\n      Array.from(tracks).forEach(track => {\n        if (track.mode === 'showing') {\n          Array.from(track.activeCues).forEach(cue => {\n            this._textTracksHidden.push(cue.text);\n            cue.text = '';\n          });\n        }\n      });\n    }\n  }\n\n  _setActiveTextTracksOnAVPlayer(): void {\n    const isIOS = this.player.env.os.name === 'iOS';\n    if (this._textTracksHidden && isIOS && this.playOnMainVideoTag()) {\n      let tracks = this.player.getVideoElement().textTracks;\n      Array.from(tracks).forEach(track => {\n        if (track.mode === 'showing') {\n          Array.from(track.activeCues).forEach(cue => {\n            if (this._textTracksHidden.length > 0) {\n              cue.text = this._textTracksHidden.shift();\n            }\n          });\n        }\n      });\n    }\n    this._textTracksHidden = [];\n  }\n\n  /**\n   * When playing on same video tag need to save state snapshot\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeSavePlayerSnapshot(): void {\n    if (this.playOnMainVideoTag()) {\n      this._selectedAudioTrack = this.player.getActiveTracks().audio;\n      this._selectedTextTrack = this.player.getActiveTracks().text;\n      this._selectedPlaybackRate = this.player.playbackRate;\n      // When we are using the same video element on iOS, native captions still\n      // appearing on the video element, so need to hide them before ad start.\n      this._hideActiveTextTracksOnAVPlayer();\n      this.player.hideTextTrack();\n    }\n  }\n\n  /**\n   * When playing on same video tag need to restore to previous state\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeRestorePlayerSnapshot(): void {\n    if (this.playOnMainVideoTag()) {\n      this.eventManager.listenOnce(this.player, this.player.Event.CAN_PLAY, () => {\n        this.player.selectTrack(this._selectedAudioTrack);\n        this.player.selectTrack(this._selectedTextTrack);\n        this.player.playbackRate = this._selectedPlaybackRate;\n        this._setActiveTextTracksOnAVPlayer();\n      });\n    }\n  }\n\n  /**\n   * When playing with different video tags on iOS ads are not\n   * supported in native full screen, so need to exist full screen before ads started.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeForceExitFullScreen(): void {\n    const isIOS = this.player.env.os.name === 'iOS';\n    //check if inBrowserFullscreen not set, just in case of inline true and not inBrowserFullscreen we will exit otherwise\n    if (\n      isIOS &&\n      !this.playOnMainVideoTag() &&\n      this.player.isFullscreen() &&\n      !this.player.config.playback.inBrowserFullscreen &&\n      this.player.config.playback.playsinline\n    ) {\n      this.player.exitFullscreen();\n    }\n  }\n\n  _playAdByConfig(): boolean {\n    return !!(this.config.adTagUrl || this.config.adsResponse);\n  }\n}\n\nexport {Ima};\n","// @flow\nimport {core} from 'kaltura-player-js';\nimport {Ima as BaseImaPlugin} from './ima';\n\nconst {Env} = core;\n\nclass CustomIma extends BaseImaPlugin {\n  /**\n   * The default configuration of the plugin.\n   * @type {Object}\n   * @static\n   * @memberof Ima\n   */\n  static defaultConfig: Object = {\n    debug: false,\n    delayInitUntilSourceSelected: Env.os.name === 'iOS',\n    disableMediaPreload: false,\n    forceReloadMediaAfterAds: false,\n    adsRenderingSettings: {\n      restoreCustomPlaybackStateOnAdBreakComplete: false,\n      enablePreloading: false,\n      useStyledLinearAds: false,\n      useStyledNonLinearAds: true,\n      bitrate: -1,\n      autoAlign: true,\n      loadVideoTimeout: -1\n    },\n    companions: {\n      ads: null,\n      sizeCriteria: 'SELECT_EXACT_MATCH'\n    },\n    aps: {\n      enabled: false,\n      fetchBids: adTagUrl => new Promise(resolve => resolve(adTagUrl))\n    },\n    adBreakPlayable: () => true\n  };\n\n  /**\n   * Plays ad on demand\n   * @param {KPAdPod} adPod - The ad pod to play.\n   * @returns {void}\n   * @public\n   * @instance\n   * @memberof Ima\n   */\n  playAdNow(adPod: KPAdPod): void {\n    if (!this._adBreakPlayableByConfig(adPod)) {\n      this.logger.debug('Not playing ad now because config callback denied');\n      return;\n    }\n\n    super.playAdNow(adPod);\n  }\n\n  _adBreakPlayableByConfig(adPod: ?PKAdPod): boolean {\n    return this.config.adBreakPlayable(adPod);\n  }\n\n  /**\n   * Requests the ads from the ads loader.\n   * @param {?string} vastUrl - vast url.\n   * @param {?string} vastResponse - vast XML response.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _requestAds(vastUrl: ?string, vastResponse: ?string): void {\n    this.logger.debug('Request ads', vastUrl);\n\n    let adTagUrl = vastUrl || this.config.adTagUrl;\n\n    this.logger.debug('APS integration', this.config.aps.enabled);\n\n    let fetchBidsPromise = new Promise(resolve => resolve(adTagUrl));\n\n    if (this.config.aps.enabled && adTagUrl && 'apstag' in window) {\n      fetchBidsPromise = this.config.aps.fetchBids(adTagUrl);\n    }\n\n    fetchBidsPromise.then(adTagUrl => {\n      this.logger.debug('APS fetch bids resolved', adTagUrl);\n      super._requestAds(adTagUrl, vastResponse);\n    });\n  }\n}\n\nexport {CustomIma as Ima};\n","// @flow\nimport {registerPlugin} from 'kaltura-player-js';\nimport {Ima} from './ima-custom';\n\ndeclare var __VERSION__: string;\ndeclare var __NAME__: string;\n\nconst VERSION = __VERSION__;\nconst NAME = __NAME__;\n\nexport {Ima as Plugin};\nexport {VERSION, NAME};\n\nconst pluginName: string = 'ima';\n\nregisterPlugin(pluginName, Ima);\n"],"sourceRoot":""}