{"version":3,"sources":["./ima/webpack/bootstrap","./ima/external [\"KalturaPlayer\"]","./ima/../node_modules/javascript-state-machine/lib/state-machine.js","./ima/../node_modules/javascript-state-machine/lib/history.js","webpack://KalturaPlayer.plugins.ima/./assets/style.css?703f","./ima/../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","./ima/./assets/style.css","./ima/../node_modules/css-loader/dist/runtime/api.js","./ima/./state.js","./ima/./ima-middleware.js","./ima/./ima-ads-controller.js","./ima/./ima-state-machine.js","./ima/./ima-engine-decorator.js","./ima/./ima.js","./ima/./ima-custom.js","./ima/./index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","KalturaPlayer","factory","configurable","target","sources","source","arguments","length","mixin","build","config","max","plugin","plugins","methods","properties","defineProperties","hook","fsm","additional","method","args","context","concat","apply","camelize","label","result","words","split","toLowerCase","charAt","toUpperCase","substring","prepended","prepend","Config","options","StateMachine","this","defaults","states","transitions","map","lifecycle","configureLifecycle","init","configureInitTransition","data","configureData","configureMethods","wildcard","configureTransitions","configurePlugins","addState","push","addStateLifecycleNames","onEnter","onLeave","on","addTransition","indexOf","addTransitionLifecycleNames","onBefore","onAfter","mapTransition","transition","from","to","state","active","builtin","configure","Array","isArray","transitionFor","transitionsFor","keys","allStates","allTransitions","Exception","UNOBSERVED","JSM","observers","fire","is","isPending","pending","can","seek","cannot","entry","transit","changed","observeUnchangedState","onPendingTransition","beginTransit","unshift","observeEvents","observersForEvent","onInvalidTransition","endTransit","failTransit","doTransit","observe","observer","event","events","previousEvent","previousResult","undefined","pluggable","nextEvents","slice","shift","then","catch","PublicMethods","_fsm","PublicProperties","set","Error","instance","forEach","version","cstor","message","current","past","future","clear","back","forward","canBack","canForward","pop","api","content","default","locals","memo","isOldIE","Boolean","window","document","all","atob","getTarget","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","modulesToDom","list","idCountMap","identifiers","item","id","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","setAttribute","insert","appendChild","textStore","replaceText","replacement","filter","join","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","btoa","unescape","encodeURIComponent","JSON","stringify","firstChild","singleton","singletonCounter","update","styleIndex","parentNode","removeStyleElement","newObj","lastIdentifiers","newList","toString","newLastIdentifiers","_i","_index","splice","useSourceMap","cssMapping","sourceMapping","sourceURLs","sourceRoot","cssWithMappingToString","mediaQuery","alreadyImportedModules","State","BaseMiddleware","core","ImaMiddleware","AdBreak","Ad","_BaseMiddleware","_this","_defineProperty","_assertThisInitialized","_context","player","addEventListener","Event","CHANGE_SOURCE_STARTED","_isFirstPlay","_nextLoad","_proto","load","next","_this2","loadPromise","_callNextLoad","getStateMachine","adTagUrl","adsResponse","AD_BREAK_START","_adBreak","payload","adBreak","AD_BREAK_END","_ad","AD_LOADED","ad","linear","AD_ERROR","logger","debug","position","numAds","AD_MANIFEST_LOADED","adBreaksPosition","includes","play","_this3","disableMediaPreload","playOnMainVideoTag","getVideoElement","src","initialUserAction","callNext","resumeAd","reset","error","pause","pauseAd","ImaAdsController","adPod","playAdNow","skipAd","onPlaybackEnded","AdBreakType","Utils","ImaStateMachine","AD_STARTED","adEvent","getAd","isLinear","AD_RESUMED","AD_PAUSED","AD_SKIPPED","AD_COMPLETED","ADS_COMPLETED","onAdError","AD_FIRST_QUARTILE","AD_MIDPOINT","AD_THIRD_QUARTILE","USER_CLOSED_AD","AD_VOLUME_CHANGED","AD_MUTED","AD_CLICKED","AD_CAN_SKIP","AD_PROGRESS","AD_BUFFERING","onAdloaded","onAdLoaded","onAdstarted","onAdStarted","onAdpaused","onAdEvent","onAdresumed","onAdResumed","onAdclicked","onAdClicked","onAdskipped","onAdSkipped","onAdcompleted","onAdCompleted","onAdscompleted","onAdsCompleted","onAdcanskip","onAdCanSkip","onAdbreakstart","onAdBreakStart","onAdbreakend","onAdBreakEnd","onAdfirstquartile","onAdmidpoint","onAdthirdquartile","onAdlog","onAdLog","onUserclosedad","onAdvolumechanged","onAdmuted","onAdprogress","onAdProgress","onAdbuffering","onEnterState","StateMachineHistory","type","adBreakType","getAdBreakType","adOptions","getAdOptions","getAdId","Dom","_adsContainerDiv","warn","dispatchEvent","adType","extraAdData","getAdData","_currentAd","_adVideoTagAlreadyPlayed","_resizeAd","_maybeDisplayCompanionAds","_showAdsContainer","_nextPromise","_resolveNextPromise","_isVideoAd","_maybeIgnoreClickOnAd","_stateMachine","isLive","_adsManager","_setToggleAdsCover","paused","_contentComplete","playback","playAdsWithMSE","_contentSrc","adBreakOptions","getAdBreakOptions","_maybeSavePlayerSnapshot","_maybeForceExitFullScreen","_maybeSaveVideoCurrentTime","forceReloadMediaAfterAds","eventManager","listenOnce","LOADED_DATA","_maybeSetVideoCurrentTime","_hideAdsContainer","_maybeRestorePlayerSnapshot","adError","getError","getMessage","getAdError","_playAdByConfig","env","os","setTimeout","reject","getAdSkippableState","remainingTime","getRemainingTime","duration","currentTime","Number","isNumber","adProgress","fatal","code","severity","Severity","CRITICAL","RECOVERABLE","category","Category","ADS","getVastErrorCode","parseInt","Code","AD_UNDEFINED_ERROR","currentAd","getCurrentAd","innerError","adData","podInfo","getAdPodInfo","_isVpaid","vpaid","system","getAdSystem","url","getMediaUrl","clickThroughUrl","contentType","getContentType","getDuration","_adPosition","getAdPosition","title","getTitle","skipOffset","getSkipTimeOffset","width","getVastMediaWidth","getWidth","height","getVastMediaHeight","getHeight","bitrate","getVastMediaBitrate","bumper","getIsBumper","_isBumper","wrapperAdIds","getWrapperAdIds","wrapperCreativeIds","getWrapperCreativeIds","wrapperAdSystems","getWrapperAdSystems","_podLength","getTotalAds","ended","OVERLAY","podIndex","getPodIndex","PRE","POST","MID","getAdBreakTypeFromSdk","_getAdBreakTypeFromPlayer","FakeEvent","ImaEngineDecorator","engine","_plugin","defaultPrevented","isAdPlaying","getContentTime","getContentDuration","getContentEnded","EngineType","getCapabilities","Env","EventManager","AudioTrack","TextTrack","FULL_SCREEN_EVENTS","Ima","_BasePlugin","_initMembers","_init","isValid","getEngineDecorator","_engine","getMiddlewareImpl","getAdsController","_playAdBreak","_firstOfAdPod","_waterfalled","_playAd","_hasUserAction","playNext","_adBreaksEventManager","removeAll","onError","response","AD_WATERFALLING","adFailed","waterfall","AD_WATERFALLING_FAILED","adlog","listen","_adsLoader","_sdk","AdsManagerLoadedEvent","Type","ADS_MANAGER_LOADED","AdEvent","COMPLETE","SKIPPED","LOG","AdErrorEvent","ads","isAdBreak","adbreakend","CONTENT_RESUME_REQUESTED","adscompleted","ALL_ADS_COMPLETED","FIRST_PLAY","_requestAds","skip","skipSupport","stop","defer","resume","isCustomPlaybackUsed","_videoLastCurrentTime","_contentDuration","getContentSrc","loadMedia","_this4","_addBindings","_adDisplayContainer","AdDisplayContainer","_initAdsLoader","_isImaSDKLibLoaded","_destroyIMAManagers","goto","destroy","initialize","_isAdsManagerLoaded","_startAdsManager","_this5","ready","Promise","resolve","dimensions","ViewMode","NORMAL","start","_this6","fullScreenEvent","MUTE_CHANGE","_syncPlayerVolume","VOLUME_CHANGE","SOURCE_SELECTED","selectedSource","DURATION_CHANGE","ERROR","MEDIA_LOADED","updateAdsRenderingSettings","restoreCustomPlaybackStateOnAdBreakComplete","ENDED","_onMediaEnded","LOADED_METADATA","_onLoadedMetadata","TIME_UPDATE","_onMediaTimeUpdate","SEEKING","_onMediaSeeking","SEEKED","_onMediaSeeked","USER_GESTURE","_contentPlayheadTracker","previousTime","seeking","_togglePlayPauseOnAdsContainerCallback","_selectedAudioTrack","_selectedTextTrack","_selectedPlaybackRate","_textTracksHidden","_this7","_maybeDelayInitUntilSourceSelected","_loadImaSDKLib","google","ima","VERSION","_initImaSettings","_initAdsContainer","_this8","delayInitUntilSourceSelected","imaSdkUrl","Http","protocol","IMA_SDK_DEBUG_LIB_URL","IMA_SDK_LIB_URL","loadScriptAsync","settings","setPlayerType","playerName","setPlayerVersion","playerVersion","setVpaidAllowed","setVpaidMode","_getVpaidMode","setLocale","locale","setDisableCustomPlaybackForIOS10Plus","playsinline","numRedirects","setNumRedirects","sessionId","setSessionId","vpaidmode","ImaSdkSettings","VpaidMode","vpaidMode","ENABLED","_this9","playerView","getView","className","_adsCoverDiv","onclick","_onAdsCoverClicked","_this10","AdsLoader","adsManagerLoadedEvent","_onAdsManagerLoaded","aderror","vastUrl","vastResponse","_this11","adsRequest","AdsRequest","vastLoadTimeout","omidAccessModes","_Object$entries","entries","_Object$entries$_i","vendor","accessMode","omidAccessModeRules","OmidVerificationVendor","OmidAccessMode","linearAdSlotWidth","linearAdSlotHeight","nonLinearAdSlotWidth","nonLinearAdSlotHeight","contentDuration","muted","volume","setAdWillPlayMuted","adWillAutoPlay","playerWillAutoPlay","autoplay","allowMutedAutoPlay","setAdWillAutoPlay","requestAds","HTML5","capabilities","mutedAutoPlay","loaded","viewMode","isFullscreen","FULLSCREEN","resize","adTotalWidth","adTotalHeight","_alignAdsContainerSizeForOverlayAd","bottom","left","_hasPostRoll","getCuePoints","_this12","contentComplete","opacity","pointerEvents","_this13","adsRenderingSettings","_getAdsRenderingSetting","getAdsManager","cuePoints","hasService","showAdBreakCuePoint","cuePoint","getService","addCuePoint","_extends","time","Infinity","adBreakCuePointStyle","_attachAdsManagerListeners","_this14","AdsRenderingSettings","setting","playAdsAfterTime","startTime","_this15","CONTENT_PAUSE_REQUESTED","adbreakstart","_adStartedEvent","adstarted","LOADED","adloaded","STARTED","PAUSED","adpaused","RESUMED","adresumed","FIRST_QUARTILE","adfirstquartile","MIDPOINT","admidpoint","THIRD_QUARTILE","adthirdquartile","CLICK","adclicked","adskipped","adcompleted","USER_CLOSE","userclosedad","VOLUME_CHANGED","advolumechanged","VOLUME_MUTED","admuted","adprogress","adbuffering","SKIPPABLE_STATE_CHANGED","adcanskip","setVolume","isNaN","enable","nextSibling","_isAdsCoverActive","_this$config$companio","companions","_window","isObject","googletag","cmd","selectionCriteria","CompanionAdSelectionSettings","resourceType","ResourceType","ALL","creativeType","CreativeType","sizeCriteria","SizeCriteria","SELECT_EXACT_MATCH","companionsIds","companionAds","getCompanionAds","getContent","el","getElementById","innerHTML","_this16","browser","stopPropagation","_hideActiveTextTracksOnAVPlayer","_this17","tracks","textTracks","track","activeCues","cue","text","_setActiveTextTracksOnAVPlayer","_this18","isIOS","getActiveTracks","audio","playbackRate","hideTextTrack","_this19","CAN_PLAY","selectTrack","inBrowserFullscreen","exitFullscreen","startsWith","BasePlugin","enablePreloading","useStyledLinearAds","useStyledNonLinearAds","autoAlign","loadVideoTimeout","CustomIma","_BaseImaPlugin","_adBreakPlayableByConfig","adBreakPlayable","aps","enabled","fetchBidsPromise","fetchBids","BaseImaPlugin","__VERSION__","NAME","__NAME__","registerPlugin"],"mappings":"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","file":"playkit-ima.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","module.exports = KalturaPlayer;","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"StateMachine\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"StateMachine\"] = factory();\n\telse\n\t\troot[\"StateMachine\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function(target, sources) {\n  var n, source, key;\n  for(n = 1 ; n < arguments.length ; n++) {\n    source = arguments[n];\n    for(key in source) {\n      if (source.hasOwnProperty(key))\n        target[key] = source[key];\n    }\n  }\n  return target;\n}\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nvar mixin = __webpack_require__(0);\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = {\n\n  build: function(target, config) {\n    var n, max, plugin, plugins = config.plugins;\n    for(n = 0, max = plugins.length ; n < max ; n++) {\n      plugin = plugins[n];\n      if (plugin.methods)\n        mixin(target, plugin.methods);\n      if (plugin.properties)\n        Object.defineProperties(target, plugin.properties);\n    }\n  },\n\n  hook: function(fsm, name, additional) {\n    var n, max, method, plugin,\n        plugins = fsm.config.plugins,\n        args    = [fsm.context];\n\n    if (additional)\n      args = args.concat(additional)\n\n    for(n = 0, max = plugins.length ; n < max ; n++) {\n      plugin = plugins[n]\n      method = plugins[n][name]\n      if (method)\n        method.apply(plugin, args);\n    }\n  }\n\n}\n\n//-------------------------------------------------------------------------------------------------\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nfunction camelize(label) {\n\n  if (label.length === 0)\n    return label;\n\n  var n, result, word, words = label.split(/[_-]/);\n\n  // single word with first character already lowercase, return untouched\n  if ((words.length === 1) && (words[0][0].toLowerCase() === words[0][0]))\n    return label;\n\n  result = words[0].toLowerCase();\n  for(n = 1 ; n < words.length ; n++) {\n    result = result + words[n].charAt(0).toUpperCase() + words[n].substring(1).toLowerCase();\n  }\n\n  return result;\n}\n\n//-------------------------------------------------------------------------------------------------\n\ncamelize.prepended = function(prepend, label) {\n  label = camelize(label);\n  return prepend + label[0].toUpperCase() + label.substring(1);\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = camelize;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nvar mixin    = __webpack_require__(0),\n    camelize = __webpack_require__(2);\n\n//-------------------------------------------------------------------------------------------------\n\nfunction Config(options, StateMachine) {\n\n  options = options || {};\n\n  this.options     = options; // preserving original options can be useful (e.g visualize plugin)\n  this.defaults    = StateMachine.defaults;\n  this.states      = [];\n  this.transitions = [];\n  this.map         = {};\n  this.lifecycle   = this.configureLifecycle();\n  this.init        = this.configureInitTransition(options.init);\n  this.data        = this.configureData(options.data);\n  this.methods     = this.configureMethods(options.methods);\n\n  this.map[this.defaults.wildcard] = {};\n\n  this.configureTransitions(options.transitions || []);\n\n  this.plugins = this.configurePlugins(options.plugins, StateMachine.plugin);\n\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmixin(Config.prototype, {\n\n  addState: function(name) {\n    if (!this.map[name]) {\n      this.states.push(name);\n      this.addStateLifecycleNames(name);\n      this.map[name] = {};\n    }\n  },\n\n  addStateLifecycleNames: function(name) {\n    this.lifecycle.onEnter[name] = camelize.prepended('onEnter', name);\n    this.lifecycle.onLeave[name] = camelize.prepended('onLeave', name);\n    this.lifecycle.on[name]      = camelize.prepended('on',      name);\n  },\n\n  addTransition: function(name) {\n    if (this.transitions.indexOf(name) < 0) {\n      this.transitions.push(name);\n      this.addTransitionLifecycleNames(name);\n    }\n  },\n\n  addTransitionLifecycleNames: function(name) {\n    this.lifecycle.onBefore[name] = camelize.prepended('onBefore', name);\n    this.lifecycle.onAfter[name]  = camelize.prepended('onAfter',  name);\n    this.lifecycle.on[name]       = camelize.prepended('on',       name);\n  },\n\n  mapTransition: function(transition) {\n    var name = transition.name,\n        from = transition.from,\n        to   = transition.to;\n    this.addState(from);\n    if (typeof to !== 'function')\n      this.addState(to);\n    this.addTransition(name);\n    this.map[from][name] = transition;\n    return transition;\n  },\n\n  configureLifecycle: function() {\n    return {\n      onBefore: { transition: 'onBeforeTransition' },\n      onAfter:  { transition: 'onAfterTransition'  },\n      onEnter:  { state:      'onEnterState'       },\n      onLeave:  { state:      'onLeaveState'       },\n      on:       { transition: 'onTransition'       }\n    };\n  },\n\n  configureInitTransition: function(init) {\n    if (typeof init === 'string') {\n      return this.mapTransition(mixin({}, this.defaults.init, { to: init, active: true }));\n    }\n    else if (typeof init === 'object') {\n      return this.mapTransition(mixin({}, this.defaults.init, init, { active: true }));\n    }\n    else {\n      this.addState(this.defaults.init.from);\n      return this.defaults.init;\n    }\n  },\n\n  configureData: function(data) {\n    if (typeof data === 'function')\n      return data;\n    else if (typeof data === 'object')\n      return function() { return data; }\n    else\n      return function() { return {};  }\n  },\n\n  configureMethods: function(methods) {\n    return methods || {};\n  },\n\n  configurePlugins: function(plugins, builtin) {\n    plugins = plugins || [];\n    var n, max, plugin;\n    for(n = 0, max = plugins.length ; n < max ; n++) {\n      plugin = plugins[n];\n      if (typeof plugin === 'function')\n        plugins[n] = plugin = plugin()\n      if (plugin.configure)\n        plugin.configure(this);\n    }\n    return plugins\n  },\n\n  configureTransitions: function(transitions) {\n    var i, n, transition, from, to, wildcard = this.defaults.wildcard;\n    for(n = 0 ; n < transitions.length ; n++) {\n      transition = transitions[n];\n      from  = Array.isArray(transition.from) ? transition.from : [transition.from || wildcard]\n      to    = transition.to || wildcard;\n      for(i = 0 ; i < from.length ; i++) {\n        this.mapTransition({ name: transition.name, from: from[i], to: to });\n      }\n    }\n  },\n\n  transitionFor: function(state, transition) {\n    var wildcard = this.defaults.wildcard;\n    return this.map[state][transition] ||\n           this.map[wildcard][transition];\n  },\n\n  transitionsFor: function(state) {\n    var wildcard = this.defaults.wildcard;\n    return Object.keys(this.map[state]).concat(Object.keys(this.map[wildcard]));\n  },\n\n  allStates: function() {\n    return this.states;\n  },\n\n  allTransitions: function() {\n    return this.transitions;\n  }\n\n});\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = Config;\n\n//-------------------------------------------------------------------------------------------------\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\nvar mixin      = __webpack_require__(0),\n    Exception  = __webpack_require__(6),\n    plugin     = __webpack_require__(1),\n    UNOBSERVED = [ null, [] ];\n\n//-------------------------------------------------------------------------------------------------\n\nfunction JSM(context, config) {\n  this.context   = context;\n  this.config    = config;\n  this.state     = config.init.from;\n  this.observers = [context];\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmixin(JSM.prototype, {\n\n  init: function(args) {\n    mixin(this.context, this.config.data.apply(this.context, args));\n    plugin.hook(this, 'init');\n    if (this.config.init.active)\n      return this.fire(this.config.init.name, []);\n  },\n\n  is: function(state) {\n    return Array.isArray(state) ? (state.indexOf(this.state) >= 0) : (this.state === state);\n  },\n\n  isPending: function() {\n    return this.pending;\n  },\n\n  can: function(transition) {\n    return !this.isPending() && !!this.seek(transition);\n  },\n\n  cannot: function(transition) {\n    return !this.can(transition);\n  },\n\n  allStates: function() {\n    return this.config.allStates();\n  },\n\n  allTransitions: function() {\n    return this.config.allTransitions();\n  },\n\n  transitions: function() {\n    return this.config.transitionsFor(this.state);\n  },\n\n  seek: function(transition, args) {\n    var wildcard = this.config.defaults.wildcard,\n        entry    = this.config.transitionFor(this.state, transition),\n        to       = entry && entry.to;\n    if (typeof to === 'function')\n      return to.apply(this.context, args);\n    else if (to === wildcard)\n      return this.state\n    else\n      return to\n  },\n\n  fire: function(transition, args) {\n    return this.transit(transition, this.state, this.seek(transition, args), args);\n  },\n\n  transit: function(transition, from, to, args) {\n\n    var lifecycle = this.config.lifecycle,\n        changed   = this.config.options.observeUnchangedState || (from !== to);\n\n    if (!to)\n      return this.context.onInvalidTransition(transition, from, to);\n\n    if (this.isPending())\n      return this.context.onPendingTransition(transition, from, to);\n\n    this.config.addState(to);  // might need to add this state if it's unknown (e.g. conditional transition or goto)\n\n    this.beginTransit();\n\n    args.unshift({             // this context will be passed to each lifecycle event observer\n      transition: transition,\n      from:       from,\n      to:         to,\n      fsm:        this.context\n    });\n\n    return this.observeEvents([\n                this.observersForEvent(lifecycle.onBefore.transition),\n                this.observersForEvent(lifecycle.onBefore[transition]),\n      changed ? this.observersForEvent(lifecycle.onLeave.state) : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.onLeave[from]) : UNOBSERVED,\n                this.observersForEvent(lifecycle.on.transition),\n      changed ? [ 'doTransit', [ this ] ]                       : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.onEnter.state) : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.onEnter[to])   : UNOBSERVED,\n      changed ? this.observersForEvent(lifecycle.on[to])        : UNOBSERVED,\n                this.observersForEvent(lifecycle.onAfter.transition),\n                this.observersForEvent(lifecycle.onAfter[transition]),\n                this.observersForEvent(lifecycle.on[transition])\n    ], args);\n  },\n\n  beginTransit: function()          { this.pending = true;                 },\n  endTransit:   function(result)    { this.pending = false; return result; },\n  failTransit:  function(result)    { this.pending = false; throw result;  },\n  doTransit:    function(lifecycle) { this.state = lifecycle.to;           },\n\n  observe: function(args) {\n    if (args.length === 2) {\n      var observer = {};\n      observer[args[0]] = args[1];\n      this.observers.push(observer);\n    }\n    else {\n      this.observers.push(args[0]);\n    }\n  },\n\n  observersForEvent: function(event) { // TODO: this could be cached\n    var n = 0, max = this.observers.length, observer, result = [];\n    for( ; n < max ; n++) {\n      observer = this.observers[n];\n      if (observer[event])\n        result.push(observer);\n    }\n    return [ event, result, true ]\n  },\n\n  observeEvents: function(events, args, previousEvent, previousResult) {\n    if (events.length === 0) {\n      return this.endTransit(previousResult === undefined ? true : previousResult);\n    }\n\n    var event     = events[0][0],\n        observers = events[0][1],\n        pluggable = events[0][2];\n\n    args[0].event = event;\n    if (event && pluggable && event !== previousEvent)\n      plugin.hook(this, 'lifecycle', args);\n\n    if (observers.length === 0) {\n      var nextEvents = events.slice(1);\n      return this.observeEvents(nextEvents, args, event, previousResult);\n    }\n    else {\n      var observer = observers.shift(),\n          result = observer[event].apply(observer, args);\n      if (result && typeof result.then === 'function') {\n        return result.then(this.observeEvents.bind(this, events, args, event))\n                     .catch(this.failTransit.bind(this))\n      }\n      else if (result === false) {\n        return this.endTransit(false);\n      }\n      else {\n        return this.observeEvents(events, args, event, result);\n      }\n    }\n  },\n\n  onInvalidTransition: function(transition, from, to) {\n    throw new Exception(\"transition is invalid in current state\", transition, from, to, this.state);\n  },\n\n  onPendingTransition: function(transition, from, to) {\n    throw new Exception(\"transition is invalid while previous transition is still in progress\", transition, from, to, this.state);\n  }\n\n});\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = JSM;\n\n//-------------------------------------------------------------------------------------------------\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-----------------------------------------------------------------------------------------------\n\nvar mixin    = __webpack_require__(0),\n    camelize = __webpack_require__(2),\n    plugin   = __webpack_require__(1),\n    Config   = __webpack_require__(3),\n    JSM      = __webpack_require__(4);\n\n//-----------------------------------------------------------------------------------------------\n\nvar PublicMethods = {\n  is:                  function(state)       { return this._fsm.is(state)                                     },\n  can:                 function(transition)  { return this._fsm.can(transition)                               },\n  cannot:              function(transition)  { return this._fsm.cannot(transition)                            },\n  observe:             function()            { return this._fsm.observe(arguments)                            },\n  transitions:         function()            { return this._fsm.transitions()                                 },\n  allTransitions:      function()            { return this._fsm.allTransitions()                              },\n  allStates:           function()            { return this._fsm.allStates()                                   },\n  onInvalidTransition: function(t, from, to) { return this._fsm.onInvalidTransition(t, from, to)              },\n  onPendingTransition: function(t, from, to) { return this._fsm.onPendingTransition(t, from, to)              },\n}\n\nvar PublicProperties = {\n  state: {\n    configurable: false,\n    enumerable:   true,\n    get: function() {\n      return this._fsm.state;\n    },\n    set: function(state) {\n      throw Error('use transitions to change state')\n    }\n  }\n}\n\n//-----------------------------------------------------------------------------------------------\n\nfunction StateMachine(options) {\n  return apply(this || {}, options);\n}\n\nfunction factory() {\n  var cstor, options;\n  if (typeof arguments[0] === 'function') {\n    cstor   = arguments[0];\n    options = arguments[1] || {};\n  }\n  else {\n    cstor   = function() { this._fsm.apply(this, arguments) };\n    options = arguments[0] || {};\n  }\n  var config = new Config(options, StateMachine);\n  build(cstor.prototype, config);\n  cstor.prototype._fsm.config = config; // convenience access to shared config without needing an instance\n  return cstor;\n}\n\n//-------------------------------------------------------------------------------------------------\n\nfunction apply(instance, options) {\n  var config = new Config(options, StateMachine);\n  build(instance, config);\n  instance._fsm();\n  return instance;\n}\n\nfunction build(target, config) {\n  if ((typeof target !== 'object') || Array.isArray(target))\n    throw Error('StateMachine can only be applied to objects');\n  plugin.build(target, config);\n  Object.defineProperties(target, PublicProperties);\n  mixin(target, PublicMethods);\n  mixin(target, config.methods);\n  config.allTransitions().forEach(function(transition) {\n    target[camelize(transition)] = function() {\n      return this._fsm.fire(transition, [].slice.call(arguments))\n    }\n  });\n  target._fsm = function() {\n    this._fsm = new JSM(this, config);\n    this._fsm.init(arguments);\n  }\n}\n\n//-----------------------------------------------------------------------------------------------\n\nStateMachine.version  = '3.0.1';\nStateMachine.factory  = factory;\nStateMachine.apply    = apply;\nStateMachine.defaults = {\n  wildcard: '*',\n  init: {\n    name: 'init',\n    from: 'none'\n  }\n}\n\n//===============================================================================================\n\nmodule.exports = StateMachine;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function(message, transition, from, to, current) {\n  this.message    = message;\n  this.transition = transition;\n  this.from       = from;\n  this.to         = to;\n  this.current    = current;\n}\n\n\n/***/ })\n/******/ ]);\n});","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"StateMachineHistory\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"StateMachineHistory\"] = factory();\n\telse\n\t\troot[\"StateMachineHistory\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 1);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nfunction camelize(label) {\n\n  if (label.length === 0)\n    return label;\n\n  var n, result, word, words = label.split(/[_-]/);\n\n  // single word with first character already lowercase, return untouched\n  if ((words.length === 1) && (words[0][0].toLowerCase() === words[0][0]))\n    return label;\n\n  result = words[0].toLowerCase();\n  for(n = 1 ; n < words.length ; n++) {\n    result = result + words[n].charAt(0).toUpperCase() + words[n].substring(1).toLowerCase();\n  }\n\n  return result;\n}\n\n//-------------------------------------------------------------------------------------------------\n\ncamelize.prepended = function(prepend, label) {\n  label = camelize(label);\n  return prepend + label[0].toUpperCase() + label.substring(1);\n}\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = camelize;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n//-------------------------------------------------------------------------------------------------\n\nvar camelize = __webpack_require__(0);\n\n//-------------------------------------------------------------------------------------------------\n\nmodule.exports = function(options) { options = options || {};\n\n  var past       = camelize(options.name || options.past   || 'history'),\n      future     = camelize(                options.future || 'future'),\n      clear      = camelize.prepended('clear', past),\n      back       = camelize.prepended(past,   'back'),\n      forward    = camelize.prepended(past,   'forward'),\n      canBack    = camelize.prepended('can',   back),\n      canForward = camelize.prepended('can',   forward),\n      max        = options.max;\n\n  var plugin = {\n\n    configure: function(config) {\n      config.addTransitionLifecycleNames(back);\n      config.addTransitionLifecycleNames(forward);\n    },\n\n    init: function(instance) {\n      instance[past]   = [];\n      instance[future] = [];\n    },\n\n    lifecycle: function(instance, lifecycle) {\n      if (lifecycle.event === 'onEnterState') {\n        instance[past].push(lifecycle.to);\n        if (max && instance[past].length > max)\n          instance[past].shift();\n        if (lifecycle.transition !== back && lifecycle.transition !== forward)\n          instance[future].length = 0;\n      }\n    },\n\n    methods:    {},\n    properties: {}\n\n  }\n\n  plugin.methods[clear] = function() {\n    this[past].length = 0\n    this[future].length = 0\n  }\n\n  plugin.properties[canBack] = {\n    get: function() {\n      return this[past].length > 1\n    }\n  }\n\n  plugin.properties[canForward] = {\n    get: function() {\n      return this[future].length > 0\n    }\n  }\n\n  plugin.methods[back] = function() {\n    if (!this[canBack])\n      throw Error('no history');\n    var from = this[past].pop(),\n        to   = this[past].pop();\n    this[future].push(from);\n    this._fsm.transit(back, from, to, []);\n  }\n\n  plugin.methods[forward] = function() {\n    if (!this[canForward])\n      throw Error('no history');\n    var from = this.state,\n        to = this[future].pop();\n    this._fsm.transit(forward, from, to, []);\n  }\n\n  return plugin;\n\n}\n\n\n/***/ })\n/******/ ]);\n});","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./style.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".playkit-ads-cover {\\n  position: relative;\\n  cursor: pointer;\\n  width: 100%;\\n  height: 100%;\\n  background-color: rgba(0, 0, 0, 0);\\n}\\n\\n.playkit-ads-container {\\n  opacity: 0;\\n  pointer-events: none;\\n  position: absolute;\\n}\\n\", \"\"]);\n\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return '@media ' + item[2] + '{' + content + '}';\n      } else {\n        return content;\n      }\n    }).join('');\n  }; // import a list of modules into the list\n\n\n  list.i = function (modules, mediaQuery) {\n    if (typeof modules === 'string') {\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    for (var i = 0; i < this.length; i++) {\n      var id = this[i][0];\n\n      if (id != null) {\n        alreadyImportedModules[id] = true;\n      }\n    }\n\n    for (i = 0; i < modules.length; i++) {\n      var item = modules[i]; // skip already imported module\n      // this implementation is not 100% perfect for weird media query combinations\n      // when a module is imported multiple times with different media queries.\n      // I hope this will never occur (Hey this way we have smaller bundles)\n\n      if (item[0] == null || !alreadyImportedModules[item[0]]) {\n        if (mediaQuery && !item[2]) {\n          item[2] = mediaQuery;\n        } else if (mediaQuery) {\n          item[2] = '(' + item[2] + ') and (' + mediaQuery + ')';\n        }\n\n        list.push(item);\n      }\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || '';\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */';\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n  return '/*# ' + data + ' */';\n}","// @flow\n\n/**\n * The ima plugin possible states.\n * @type {Object}\n */\nconst State: {[state: string]: string} = {\n  LOADING: 'loading',\n  LOADED: 'loaded',\n  PENDING: 'pending',\n  PLAYING: 'playing',\n  PAUSED: 'paused',\n  IDLE: 'idle',\n  DONE: 'done'\n};\n\nexport {State};\n","// @flow\nimport {core} from '@playkit-js/kaltura-player-js';\nimport {Ima} from './ima';\nimport {State} from './state';\n\nconst {BaseMiddleware, AdBreak, Ad} = core;\n\n/**\n * Middleware implementation for ima plugin.\n * @class ImaMiddleware\n * @param {Ima} context - The ima plugin context.\n * @private\n */\nclass ImaMiddleware extends BaseMiddleware {\n  /**\n   * The id of the ima middleware.\n   * @type {string}\n   * @public\n   * @memberof ImaMiddleware\n   */\n  id: string = 'ImaMiddleware';\n  /**\n   * Whether the play request is the first.\n   * @member\n   * @private\n   * @memberof ImaMiddleware\n   */\n  _isFirstPlay: boolean;\n  /**\n   * The plugin context.\n   * @member\n   * @private\n   * @memberof ImaMiddleware\n   */\n  _context: Ima;\n  /**\n   * The next load function.\n   * @member\n   * @private\n   * @memberof ImaMiddleware\n   */\n  _nextLoad: ?Function;\n  /**\n   * Current ad break.\n   * @member\n   * @private\n   * @memberof ImaMiddleware\n   */\n  _adBreak: AdBreak;\n  /**\n   * Current ad.\n   * @member\n   * @private\n   * @memberof ImaMiddleware\n   */\n  _ad: Ad;\n\n  constructor(context: Ima) {\n    super();\n    this._context = context;\n    context.player.addEventListener(context.player.Event.CHANGE_SOURCE_STARTED, () => {\n      this._isFirstPlay = true;\n      this._nextLoad = null;\n    });\n  }\n\n  /**\n   * Load middleware handler.\n   * @param {Function} next - The load play handler in the middleware chain.\n   * @returns {void}\n   * @memberof ImaMiddleware\n   */\n  load(next: Function): void {\n    this._nextLoad = next;\n    this._context.loadPromise.catch(() => this._callNextLoad());\n    const sm = this._context.getStateMachine();\n    if (sm.state !== State.IDLE && (this._context.config.adTagUrl || this._context.config.adsResponse)) {\n      this._context.player.addEventListener(this._context.player.Event.AD_BREAK_START, (event: FakeEvent) => (this._adBreak = event.payload.adBreak));\n      this._context.player.addEventListener(this._context.player.Event.AD_BREAK_END, () => {\n        this._adBreak = null;\n        this._ad = null;\n      });\n      this._context.player.addEventListener(this._context.player.Event.AD_LOADED, (event: FakeEvent) => {\n        this._ad = event.payload.ad;\n        if (!this._ad.linear) {\n          this._callNextLoad();\n        }\n      });\n      this._context.player.addEventListener(this._context.player.Event.AD_ERROR, () => {\n        this._context.logger.debug('Ad error listener on middleware', this._adBreak, this._ad);\n        // checking if the error raised for the last ad before playback:\n        // ad error raised before ad break start\n        // or there's only one ad in the pod\n        // or it's the last ad in the pod\n        if (!(this._ad && this._adBreak) || this._ad.position === this._adBreak.numAds) {\n          this._context.logger.debug('Call next load after ad error on middleware');\n          this._callNextLoad();\n        }\n      });\n      this._context.player.addEventListener(this._context.player.Event.AD_MANIFEST_LOADED, event => {\n        if (!event.payload.adBreaksPosition.includes(0)) {\n          this._callNextLoad();\n        }\n      });\n    } else {\n      this._callNextLoad();\n    }\n  }\n\n  /**\n   * Play middleware handler.\n   * @param {Function} next - The next play handler in the middleware chain.\n   * @returns {void}\n   * @memberof ImaMiddleware\n   */\n  play(next: Function): void {\n    if (this._isFirstPlay) {\n      this._isFirstPlay = false;\n      if (this._context.config.disableMediaPreload || this._context.playOnMainVideoTag()) {\n        this._context.player.addEventListener(this._context.player.Event.AD_BREAK_END, () => this._callNextLoad());\n        if (!(this._context.playOnMainVideoTag() || this._context.player.getVideoElement().src)) {\n          this._context.player.getVideoElement().load();\n        }\n      } else {\n        this._callNextLoad();\n      }\n    }\n    this._context.loadPromise\n      .then(() => {\n        let sm = this._context.getStateMachine();\n        switch (sm.state) {\n          case State.PLAYING:\n            break;\n          case State.LOADED: {\n            const initialUserAction = this._context.initialUserAction();\n            if (initialUserAction) {\n              return initialUserAction.then(() => {\n                this.callNext(next);\n              });\n            } else {\n              this.callNext(next);\n            }\n            break;\n          }\n          case State.PAUSED: {\n            const resumeAd = this._context.resumeAd();\n            if (resumeAd) {\n              return resumeAd.then(() => {\n                this.callNext(next);\n              });\n            } else {\n              this.callNext(next);\n            }\n            break;\n          }\n          default: {\n            this.callNext(next);\n            break;\n          }\n        }\n      })\n      .catch(e => {\n        this._context.reset();\n        this._context.logger.error(e);\n        this.callNext(next);\n      });\n  }\n\n  /**\n   * Pause middleware handler.\n   * @param {Function} next - The next pause handler in the middleware chain.\n   * @returns {void}\n   * @memberof ImaMiddleware\n   */\n  pause(next: Function): void {\n    let sm = this._context.getStateMachine();\n    switch (sm.state) {\n      case State.PAUSED:\n        break;\n      case State.PLAYING: {\n        this._context.pauseAd();\n        break;\n      }\n      default: {\n        this.callNext(next);\n        break;\n      }\n    }\n  }\n\n  _callNextLoad(): void {\n    if (this._nextLoad) {\n      this.callNext(this._nextLoad);\n    }\n    this._nextLoad = null;\n  }\n}\n\nexport {ImaMiddleware};\n","// @flow\nimport {Ima} from './ima';\nimport {State} from './state';\n\n/**\n * Controller for ima plugin.\n * @class ImaAdsController\n * @param {Ima} context - The ima plugin context.\n */\nclass ImaAdsController implements IAdsPluginController {\n  /**\n   * The plugin context.\n   * @member\n   * @private\n   * @memberof ImaAdsController\n   */\n  _context: Ima;\n\n  constructor(context: Ima) {\n    this._context = context;\n  }\n\n  /**\n   * Skip on an ad.\n   * @public\n   * @returns {void}\n   * @memberof ImaAdsController\n   */\n  skipAd(): void {\n    this._context.skipAd();\n  }\n\n  /**\n   * Play an ad on demand.\n   * @param {KPAdPod} adPod - The ad pod to play.\n   * @public\n   * @returns {void}\n   * @memberof ImaAdsController\n   */\n  playAdNow = (adPod: KPAdPod) => {\n    this._context.playAdNow(adPod);\n  };\n\n  /**\n   * On playback ended handler.\n   * @public\n   * @returns {Promise<void>} - complete promise\n   * @memberof ImaAdsController\n   */\n  onPlaybackEnded(): Promise<void> {\n    return this._context.onPlaybackEnded();\n  }\n\n  /**\n   * Whether this ads controller is active\n   * @public\n   * @returns {boolean} - is active\n   * @memberof ImaAdsController\n   */\n  get active(): boolean {\n    return this._context.getStateMachine().state === State.PLAYING || this._context.getStateMachine().state === State.PAUSED;\n  }\n\n  /**\n   * Whether this ads controller is done\n   * @public\n   * @returns {boolean} - is done\n   * @memberof ImaAdsController\n   */\n  get done(): boolean {\n    return this._context.getStateMachine().state === State.DONE;\n  }\n\n  /**\n   * The controller name\n   * @public\n   * @returns {string} - The name\n   * @memberof ImaAdsController\n   */\n  get name(): string {\n    return this._context.name;\n  }\n}\n\nexport {ImaAdsController};\n","// @flow\nimport StateMachine from 'javascript-state-machine';\nimport StateMachineHistory from 'javascript-state-machine/lib/history';\nimport {State} from './state';\nimport {core, Ad, AdBreak} from '@playkit-js/kaltura-player-js';\n\nconst {AdBreakType, Error, Utils} = core;\n\n/**\n * Finite state machine for ima plugin.\n * @class ImaStateMachine\n * @private\n * @param {any} context - The plugin context.\n * @classdesc\n */\nclass ImaStateMachine {\n  constructor(context: any) {\n    return new StateMachine({\n      init: State.LOADING,\n      transitions: [\n        {\n          name: 'loaded',\n          from: [State.LOADING, State.LOADED, State.IDLE, State.PAUSED, State.PLAYING, State.DONE],\n          to: State.LOADED\n        },\n        {\n          name: context.player.Event.AD_STARTED,\n          from: [State.LOADED, State.IDLE, State.PAUSED, State.PLAYING, State.PENDING],\n          to: (adEvent: any): string => {\n            let ad = adEvent.getAd();\n            if (!ad.isLinear()) {\n              return State.IDLE;\n            }\n            return State.PLAYING;\n          }\n        },\n        {\n          name: context.player.Event.AD_RESUMED,\n          from: [State.PAUSED, State.PLAYING],\n          to: State.PLAYING\n        },\n        {\n          name: context.player.Event.AD_PAUSED,\n          from: State.PLAYING,\n          to: State.PAUSED\n        },\n        {\n          name: context.player.Event.AD_SKIPPED,\n          from: [State.PLAYING, State.PAUSED],\n          to: State.IDLE\n        },\n        {\n          name: context.player.Event.AD_COMPLETED,\n          from: [State.PLAYING, State.PAUSED]\n        },\n        {\n          name: context.player.Event.ADS_COMPLETED,\n          from: [State.IDLE, State.PAUSED],\n          to: State.DONE\n        },\n        {\n          name: context.player.Event.AD_BREAK_END,\n          from: [State.IDLE, State.PLAYING, State.LOADED, State.PAUSED, State.PENDING],\n          to: State.IDLE\n        },\n        {\n          name: 'adlog',\n          from: [State.IDLE, State.LOADED, State.PLAYING, State.PAUSED, State.LOADING, State.PENDING],\n          to: State.IDLE\n        },\n        {\n          name: context.player.Event.AD_ERROR,\n          from: [State.IDLE, State.LOADED, State.PLAYING, State.PAUSED, State.LOADING, State.PENDING],\n          to: onAdError.bind(context)\n        },\n        {\n          name: context.player.Event.AD_LOADED,\n          from: [State.IDLE, State.LOADED, State.PLAYING]\n        },\n        {\n          name: context.player.Event.AD_FIRST_QUARTILE,\n          from: State.PLAYING\n        },\n        {\n          name: context.player.Event.AD_BREAK_START,\n          from: [State.IDLE, State.LOADED],\n          to: State.PENDING\n        },\n        {\n          name: context.player.Event.AD_MIDPOINT,\n          from: State.PLAYING\n        },\n        {\n          name: context.player.Event.AD_THIRD_QUARTILE,\n          from: State.PLAYING\n        },\n        {\n          name: context.player.Event.USER_CLOSED_AD,\n          from: [State.IDLE, State.PLAYING, State.PAUSED]\n        },\n        {\n          name: context.player.Event.AD_VOLUME_CHANGED,\n          from: [State.PENDING, State.PLAYING, State.PAUSED, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_MUTED,\n          from: [State.PLAYING, State.PAUSED, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_CLICKED,\n          from: [State.PLAYING, State.PAUSED, State.IDLE]\n        },\n        {\n          name: context.player.Event.AD_CAN_SKIP,\n          from: [State.PLAYING, State.PAUSED, State.LOADED]\n        },\n        {\n          name: context.player.Event.AD_PROGRESS,\n          from: [State.PLAYING, State.PAUSED, State.PENDING, State.IDLE]\n        },\n        {\n          name: context.player.Event.AD_BUFFERING,\n          from: '*'\n        },\n        {\n          name: 'goto',\n          from: '*',\n          to: s => s\n        }\n      ],\n      methods: {\n        onAdloaded: onAdLoaded.bind(context),\n        onAdstarted: onAdStarted.bind(context),\n        onAdpaused: onAdEvent.bind(context),\n        onAdresumed: onAdResumed.bind(context),\n        onAdclicked: onAdClicked.bind(context),\n        onAdskipped: onAdSkipped.bind(context),\n        onAdcompleted: onAdCompleted.bind(context),\n        onAdscompleted: onAdsCompleted.bind(context),\n        onAdcanskip: onAdCanSkip.bind(context),\n        onAdbreakstart: onAdBreakStart.bind(context),\n        onAdbreakend: onAdBreakEnd.bind(context),\n        onAdfirstquartile: onAdEvent.bind(context),\n        onAdmidpoint: onAdEvent.bind(context),\n        onAdthirdquartile: onAdEvent.bind(context),\n        onAdlog: onAdLog.bind(context),\n        onUserclosedad: onAdEvent.bind(context),\n        onAdvolumechanged: onAdEvent.bind(context),\n        onAdmuted: onAdEvent.bind(context),\n        onAdprogress: onAdProgress.bind(context),\n        onAdbuffering: onAdEvent.bind(context),\n        onEnterState: onEnterState.bind(context),\n        onPendingTransition: onPendingTransition.bind(context)\n      },\n      plugins: [new StateMachineHistory()]\n    });\n  }\n}\n\n/**\n * LOADED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdLoaded(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  const adBreakType = getAdBreakType.call(this, adEvent);\n  const adOptions = getAdOptions.call(this, adEvent);\n  const ad = new Ad(adEvent.getAd().getAdId(), adOptions);\n  Utils.Dom.setAttribute(this._adsContainerDiv, 'data-adtype', adBreakType);\n  this.logger.warn(`adType and extraAdData fields will be deprecated soon from AD_LOADED event payload. See docs for more information`);\n  this.dispatchEvent(options.transition, {\n    ad: ad,\n    adType: adBreakType, // for backward compatibility\n    extraAdData: adEvent.getAdData() // for backward compatibility\n  });\n}\n\n/**\n * STARTED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdStarted(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this._currentAd = adEvent.getAd();\n  this._adVideoTagAlreadyPlayed = true;\n  this._resizeAd();\n  this._maybeDisplayCompanionAds();\n  if (!this._currentAd.isLinear()) {\n    if (this._nextPromise) {\n      this._resolveNextPromise();\n    } else {\n      this.player.play();\n    }\n  } else {\n    this._showAdsContainer();\n  }\n  const adOptions = getAdOptions.call(this, adEvent);\n  const ad = new Ad(adEvent.getAd().getAdId(), adOptions);\n  this.dispatchEvent(options.transition, {ad});\n}\n\n/**\n * CLICKED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdClicked(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  if (this._currentAd.isLinear()) {\n    if (this._isVideoAd()) {\n      this._maybeIgnoreClickOnAd();\n      if (this._stateMachine.is(State.PLAYING) && !this.player.isLive()) {\n        this._adsManager.pause();\n      } else if (this.player.isLive()) {\n        this.resumeAd();\n      }\n      this._setToggleAdsCover(true);\n    }\n  } else {\n    if (!this.player.paused) {\n      this.player.pause();\n    }\n  }\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * RESUMED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdResumed(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this._setToggleAdsCover(false);\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * COMPLETE event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdCompleted(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * ADS_COMPLETED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdsCompleted(options: Object, adEvent: any): void {\n  this.logger.debug(options.transition.toUpperCase());\n  if (this.playOnMainVideoTag() && this._contentComplete && !this.player.config.playback.playAdsWithMSE) {\n    this.player.getVideoElement().src = this._contentSrc;\n  }\n  onAdBreakEnd.call(this, options, adEvent);\n}\n\n/**\n * CONTENT_PAUSED_REQUESTED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdBreakStart(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.player.pause();\n  const adBreakOptions = getAdBreakOptions.call(this, adEvent);\n  const adBreak = new AdBreak(adBreakOptions);\n  this._maybeSavePlayerSnapshot();\n  this._maybeForceExitFullScreen();\n  this._maybeSaveVideoCurrentTime();\n  this.dispatchEvent(options.transition, {adBreak: adBreak});\n}\n\n/**\n * CONTENT_RESUMED_REQUESTED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdBreakEnd(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this._currentAd = null;\n  if (!this._contentComplete) {\n    if (this.config.forceReloadMediaAfterAds) {\n      this.eventManager.listenOnce(this.player, this.player.Event.LOADED_DATA, () => {\n        this._maybeSetVideoCurrentTime();\n        this.player.play();\n      });\n      this.player.getVideoElement().load();\n    }\n    this._hideAdsContainer();\n    this._maybeSetVideoCurrentTime();\n    if (this._nextPromise) {\n      this._resolveNextPromise();\n    } else if (!this.config.forceReloadMediaAfterAds) {\n      this.player.play();\n    }\n  }\n  this._maybeRestorePlayerSnapshot();\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * LOG event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdLog(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  let adError;\n  if (typeof adEvent.getAdData === 'function') {\n    adError = adEvent.getAdData().adError;\n  } else if (typeof adEvent.getError === 'function') {\n    adError = adEvent.getError();\n  }\n  if (adError) {\n    this.logger.error('Non-fatal error occurred: ' + adError.getMessage());\n    this.dispatchEvent(this.player.Event.AD_ERROR, getAdError.call(this, adError, false));\n  }\n}\n\n/**\n * ERROR event handler.\n * @param {any} adEvent - ima event data.\n * @returns {string} - the state to move\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdError(adEvent: any): string {\n  let state = State.IDLE;\n  if (this._playAdByConfig()) {\n    this.logger.debug(adEvent.type.toUpperCase());\n    let adError = adEvent.getError();\n    // if this is autoplay or user already requested play then next promise will handle reset\n    if (this._nextPromise) {\n      //ads playing on same video tag wait to ima to end the source replacement\n      if (this.playOnMainVideoTag() && this.player.env.os.name !== 'iOS') {\n        setTimeout(\n          () => {\n            this._nextPromise.reject(adError);\n          },\n          0,\n          adError\n        );\n      } else {\n        this._nextPromise.reject(adError);\n      }\n    } else {\n      this.reset();\n      state = State.DONE;\n    }\n    this.dispatchEvent('aderror', getAdError.call(this, adError, true));\n  }\n  return state;\n}\n\n/**\n * SKIPPED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdSkipped(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * SKIPPABLE_STATE_CHANGED event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdCanSkip(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  if (this._adsManager.getAdSkippableState()) {\n    this.dispatchEvent(options.transition);\n  }\n}\n\n/**\n * AD_PROGRESS event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdProgress(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  const remainingTime = this._adsManager.getRemainingTime();\n  const duration = adEvent.getAdData() && adEvent.getAdData().duration;\n  let currentTime = duration - remainingTime;\n  currentTime = currentTime < 0 ? 0 : currentTime;\n  if (Utils.Number.isNumber(duration) && Utils.Number.isNumber(currentTime)) {\n    this.dispatchEvent(options.transition, {\n      adProgress: {\n        currentTime: currentTime,\n        duration: duration\n      }\n    });\n  }\n}\n\n/**\n * General event handler.\n * @param {Object} options - fsm event data.\n * @param {any} adEvent - ima event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onAdEvent(options: Object, adEvent: any): void {\n  this.logger.debug(adEvent.type.toUpperCase());\n  this.dispatchEvent(options.transition);\n}\n\n/**\n * Enter state handler.\n * @param {Object} options - fsm event data.\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onEnterState(options: Object): void {\n  if (options.from !== options.to) {\n    this.logger.debug('Change state: ' + options.from + ' => ' + options.to);\n  }\n}\n\n/**\n * onPendingTransition handler\n * @param {string} transition - transition\n * @param {string} from - from\n * @param {string} to - to\n * @returns {void}\n * @private\n * @memberof ImaStateMachine\n */\nfunction onPendingTransition(transition: string, from: string, to: string): void {\n  this.logger.warn('The previous transition is still in progress', {transition, from, to});\n}\n\n/**\n * Gets the ad error object.\n * @param {any} adError - The ima ad error object.\n * @param {boolean} fatal - Whether the error is fatal.\n * @returns {Error} - The ad error object.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdError(adError: any, fatal: boolean): Error {\n  const severity = fatal ? Error.Severity.CRITICAL : Error.Severity.RECOVERABLE;\n  const category = Error.Category.ADS;\n  let code;\n  try {\n    if (adError.getVastErrorCode() !== 900) {\n      code = parseInt(Error.Category.ADS + adError.getVastErrorCode());\n    } else {\n      code = Error.Code.AD_UNDEFINED_ERROR;\n    }\n  } catch (e) {\n    code = Error.Code.AD_UNDEFINED_ERROR;\n  }\n  let ad;\n  if (this._adsManager) {\n    try {\n      const currentAd = this._adsManager.getCurrentAd();\n      const adEvent = {getAd: () => currentAd, getAdData: () => undefined};\n      const adOptions = getAdOptions.call(this, adEvent);\n      ad = new Ad(currentAd.getAdId(), adOptions);\n    } catch (e) {\n      //do nothing\n    }\n  }\n  return new Error(severity, category, code, {\n    ad,\n    innerError: adError\n  });\n}\n\n/**\n * Gets the ad options.\n * @param {any} adEvent - The ima ad event object.\n * @returns {Object} - The ad options.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdOptions(adEvent: any): Object {\n  const adOptions = {};\n  const ad = adEvent.getAd();\n  const adData = adEvent.getAdData();\n  const podInfo = ad.getAdPodInfo();\n  if (adData) {\n    // vpaid field exists on AD_LOADED but not on AD_STARTED\n    this._isVpaid = adData.vpaid;\n  }\n  adOptions.system = ad.getAdSystem();\n  adOptions.url = ad.getMediaUrl();\n  adOptions.clickThroughUrl = adData && adData.clickThroughUrl;\n  adOptions.contentType = ad.getContentType();\n  adOptions.duration = ad.getDuration();\n  adOptions.position = this._adPosition || podInfo.getAdPosition();\n  adOptions.title = ad.getTitle();\n  adOptions.linear = ad.isLinear();\n  adOptions.skipOffset = ad.getSkipTimeOffset();\n  adOptions.width = ad.isLinear() ? ad.getVastMediaWidth() : ad.getWidth();\n  adOptions.height = ad.isLinear() ? ad.getVastMediaHeight() : ad.getHeight();\n  adOptions.bitrate = ad.getVastMediaBitrate();\n  adOptions.bumper = podInfo.getIsBumper() || this._isBumper;\n  adOptions.vpaid = this._isVpaid;\n  adOptions.wrapperAdIds = ad.getWrapperAdIds();\n  adOptions.wrapperCreativeIds = ad.getWrapperCreativeIds();\n  adOptions.wrapperAdSystems = ad.getWrapperAdSystems();\n  return adOptions;\n}\n\n/**\n * Gets the ad break options.\n * @param {any} adEvent - The ima ad event object.\n * @returns {Object} - The ad break options.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdBreakOptions(adEvent: any): Object {\n  const adBreakOptions = {};\n  adBreakOptions.numAds = this._podLength || adEvent.getAd().getAdPodInfo().getTotalAds();\n  adBreakOptions.position = this.player.ended ? -1 : this.player.currentTime;\n  adBreakOptions.type = getAdBreakType.call(this, adEvent);\n  return adBreakOptions;\n}\n\n/**\n * Gets the ad break type.\n * @param {any} adEvent - The ima ad event object.\n * @returns {string} - The ad break type.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdBreakType(adEvent: any): string {\n  try {\n    const ad = adEvent.getAd();\n    if (!ad.isLinear()) {\n      return AdBreakType.OVERLAY;\n    }\n  } catch (e) {\n    // do nothing\n  }\n  if (this._playAdByConfig()) {\n    return getAdBreakTypeFromSdk(adEvent);\n  } else {\n    return this._getAdBreakTypeFromPlayer();\n  }\n}\n\n/**\n * Gets the ad break type from ima sdk.\n * @param {any} adEvent - The ima ad event object.\n * @returns {string} - The ad break type.\n * @private\n * @memberof ImaStateMachine\n */\nfunction getAdBreakTypeFromSdk(adEvent: any): string {\n  const ad = adEvent.getAd();\n  const podInfo = ad.getAdPodInfo();\n  const podIndex = podInfo.getPodIndex();\n  if (!ad.isLinear()) {\n    return AdBreakType.OVERLAY;\n  }\n  switch (podIndex) {\n    case 0:\n      return AdBreakType.PRE;\n    case -1:\n      return AdBreakType.POST;\n    default:\n      return AdBreakType.MID;\n  }\n}\n\nexport {ImaStateMachine};\n","// @flow\nimport {core} from '@playkit-js/kaltura-player-js';\nimport {Ima} from './ima';\n\nconst {FakeEvent} = core;\n\n/**\n * Engine decorator for ima plugin.\n * @class ImaEngineDecorator\n * @param {IEngine} engine - The HTML5 engine.\n * @param {Ima} plugin - The ima plugin.\n * @implements {IEngineDecorator}\n */\nclass ImaEngineDecorator implements IEngineDecorator {\n  _plugin: Ima;\n\n  constructor(engine: IEngine, plugin: Ima) {\n    this._plugin = plugin;\n  }\n\n  get active(): boolean {\n    return this._plugin.playOnMainVideoTag() && this._plugin.isAdPlaying();\n  }\n\n  dispatchEvent(event: FakeEvent): boolean {\n    return event.defaultPrevented;\n  }\n  /**\n   * Get paused state.\n   * @returns {boolean} - The paused value of the engine.\n   * @public\n   * @override\n   * @instance\n   * @memberof ImaEngineDecorator\n   */\n  get paused(): boolean {\n    return true;\n  }\n  /**\n   * Get the current time in seconds.\n   * @returns {number} - The current playback time.\n   * @public\n   * @override\n   * @instance\n   * @memberof ImaEngineDecorator\n   */\n  get currentTime(): number {\n    return this._plugin.getContentTime();\n  }\n  /**\n   * Set the current time in seconds.\n   * @param {number} to - The number to set in seconds.\n   * @public\n   * @returns {void}\n   */\n  set currentTime(to: number): void {\n    // Do nothing\n  }\n  /**\n   * Get the duration in seconds.\n   * @returns {number} - The playback duration.\n   * @public\n   * @override\n   * @instance\n   * @memberof ImaEngineDecorator\n   */\n  get duration(): number {\n    return this._plugin.getContentDuration();\n  }\n  /**\n   * Get ended state\n   * @returns {boolean} - media ended\n   * @public\n   * @override\n   * @instance\n   * @memberof ImaEngineDecorator\n   */\n  get ended(): boolean {\n    return this._plugin.getContentEnded();\n  }\n}\n\nexport {ImaEngineDecorator};\n","// @flow\nimport {core, BasePlugin} from '@playkit-js/kaltura-player-js';\nimport {ImaMiddleware} from './ima-middleware';\nimport {ImaAdsController} from './ima-ads-controller';\nimport {ImaStateMachine} from './ima-state-machine';\nimport {State} from './state';\nimport './assets/style.css';\nimport {ImaEngineDecorator} from './ima-engine-decorator';\n\nconst {BaseMiddleware, EngineType, Error, getCapabilities, Utils, Env, AudioTrack, TextTrack, EventManager, AdBreakType} = core;\n\n/**\n * The full screen events..\n * @type {Array<string>}\n * @const\n * @private\n */\nconst FULL_SCREEN_EVENTS: Array<string> = ['fullscreenchange', 'mozfullscreenchange', 'webkitfullscreenchange'];\n\n/**\n * The overlay ad margin.\n * @type {number}\n * @const\n * @private\n */\nconst OVERLAY_AD_MARGIN: number = 8;\n/**\n * The ads container class.\n * @type {string}\n * @const\n * @private\n */\nconst ADS_CONTAINER_CLASS: string = 'playkit-ads-container';\n/**\n * The ads cover class.\n * @type {string}\n * @const\n * @private\n */\nconst ADS_COVER_CLASS: string = 'playkit-ads-cover';\n/**\n * Flag for ima to not preload the postroll See https://developers.google.com/interactive-media-ads/docs/sdks/html5/client-side/history (3.442.0 version)\n * @type {number}\n * @const\n * @private\n */\nconst POSTROLL_PRELOAD_NONE: number = -3;\n\n/**\n * The ima plugin.\n * @class Ima\n * @param {string} name - The plugin name.\n * @param {Player} player - The player instance.\n * @param {ImaConfigObject} config - The plugin config.\n * @implements {IMiddlewareProvider}\n * @implements {IAdsControllerProvider}\n * @implements {IEngineDecoratorProvider}\n * @extends BasePlugin\n */\nclass Ima extends BasePlugin implements IMiddlewareProvider, IAdsControllerProvider, IEngineDecoratorProvider {\n  /**\n   * The default configuration of the plugin.\n   * @type {Object}\n   * @static\n   * @memberof Ima\n   */\n  static defaultConfig: Object = {\n    debug: false,\n    delayInitUntilSourceSelected: Env.os.name === 'iOS',\n    disableMediaPreload: false,\n    forceReloadMediaAfterAds: false,\n    showAdBreakCuePoint: false,\n    adBreakCuePointStyle: null,\n    adsRenderingSettings: {\n      restoreCustomPlaybackStateOnAdBreakComplete: false,\n      enablePreloading: false,\n      useStyledLinearAds: false,\n      useStyledNonLinearAds: true,\n      bitrate: -1,\n      autoAlign: true,\n      loadVideoTimeout: -1\n    },\n    companions: {\n      ads: null,\n      sizeCriteria: 'SELECT_EXACT_MATCH'\n    }\n  };\n\n  /**\n   * The sdk lib url.\n   * @type {string}\n   * @static\n   * @private\n   * @memberof Ima\n   */\n  static IMA_SDK_LIB_URL: string = '//imasdk.googleapis.com/js/sdkloader/ima3.js';\n  /**\n   * The debug sdk lib url.\n   * @type {string}\n   * @static\n   * @private\n   * @memberof Ima\n   */\n  static IMA_SDK_DEBUG_LIB_URL: string = '//imasdk.googleapis.com/js/sdkloader/ima3_debug.js';\n  /**\n   * Promise for loading the plugin.\n   * Will be resolved after:\n   * 1) Ima script has been loaded in the page.\n   * 2) The ads manager has been loaded and ready to start.\n   * @type {Promise<*>}\n   * @member\n   * @public\n   * @memberof Ima\n   */\n  loadPromise: DeferredPromise;\n  /**\n   * The finite state machine of the plugin.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _stateMachine: any;\n  /**\n   * The sdk api.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _sdk: any;\n  /**\n   * The ads container dom element.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _adsContainerDiv: HTMLElement;\n  /**\n   * The ads cover dom element.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _adsCoverDiv: HTMLElement;\n  /**\n   * The ima ads container object.\n   * @private\n   * @memberof Ima\n   */\n  _adDisplayContainer: any;\n  /**\n   * The ima ads manager.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _adsManager: any;\n  /**\n   * The ima ads loader.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _adsLoader: any;\n  /**\n   * The content tracker.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _contentPlayheadTracker: Object;\n  /**\n   * Flag to know when content complete.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _contentComplete: boolean;\n  /**\n   * Video current time before ads.\n   * On custom playback when only one video tag playing, save the video current time.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _videoLastCurrentTime: ?number;\n  /**\n   * The promise which when resolved starts the next handler in the middleware chain.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _nextPromise: ?DeferredPromise;\n  /**\n   * The current playing ad.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _currentAd: any;\n  /**\n   * The content media duration.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _contentDuration: ?number;\n  /**\n   * The content media src.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _contentSrc: string;\n\n  /**\n   * Whether an initial user action happened.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _hasUserAction: boolean;\n  /**\n   * Whether the ads manager loaded.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _isAdsManagerLoaded: boolean;\n  /**\n   * The bounded handler of the ads container click.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _togglePlayPauseOnAdsContainerCallback: ?Function;\n  /**\n   * Whether the ads cover overlay is active.\n   * @member\n   * @private\n   * @memberof Ima\n   */\n  _isAdsCoverActive: boolean;\n  _selectedAudioTrack: ?AudioTrack;\n  _selectedTextTrack: ?TextTrack;\n  _selectedPlaybackRate: number;\n  _textTracksHidden: Array<string>;\n  _adBreaksEventManager: EventManager;\n  _podLength: number;\n  _adPosition: number;\n  _firstOfAdPod: boolean;\n  _waterfalled: boolean;\n  _isBumper: boolean;\n  _isVpaid: boolean;\n  _adVideoTagAlreadyPlayed: boolean = false;\n  _adStartedEvent: any = null;\n  _engine: any = null;\n\n  /**\n   * Whether the ima plugin is valid.\n   * @static\n   * @override\n   * @public\n   * @memberof Ima\n   */\n  static isValid() {\n    return true;\n  }\n\n  constructor(name: string, player: KalturaPlayer, config: ImaConfigObject) {\n    super(name, player, config);\n    this._stateMachine = new ImaStateMachine(this);\n    this._initMembers();\n    this._init();\n  }\n\n  /**\n   * Gets the engine decorator.\n   * @param {IEngine} engine - The engine to decorate.\n   * @public\n   * @returns {IEngineDecorator} - The ads api.\n   * @instance\n   * @memberof Ima\n   */\n  getEngineDecorator(engine: IEngine): IEngineDecorator {\n    this._engine = engine;\n    return new ImaEngineDecorator(engine, this);\n  }\n\n  /**\n   * Gets the middleware.\n   * @public\n   * @returns {ImaMiddleware} - The middleware api.\n   * @instance\n   * @memberof Ima\n   */\n  getMiddlewareImpl(): BaseMiddleware {\n    return new ImaMiddleware(this);\n  }\n\n  /**\n   * Gets the ads controller.\n   * @public\n   * @returns {IAdsPluginController} - The ads api.\n   * @instance\n   * @memberof Ima\n   */\n  getAdsController(): IAdsPluginController {\n    return new ImaAdsController(this);\n  }\n\n  /**\n   * Plays ad on demand\n   * @param {KPAdPod} adPod - The ad pod to play.\n   * @returns {void}\n   * @public\n   * @instance\n   * @memberof Ima\n   */\n  playAdNow(adPod: KPAdPod): void {\n    if (Array.isArray(adPod) && !(this.isAdPlaying() || this._playAdByConfig())) {\n      this._playAdBreak(adPod);\n    }\n  }\n\n  _playAdBreak(adPod: KPAdPod): void {\n    this._podLength = adPod.length;\n    this._adPosition = 1;\n    this._firstOfAdPod = true;\n    this._waterfalled = false;\n    this.loadPromise\n      .then(() => {\n        this._playAd(adPod);\n        if (!this._hasUserAction && this.player.currentTime > 0) {\n          this.initialUserAction();\n        }\n      })\n      .catch(() => {});\n  }\n\n  _playAd(adPod: KPAdPod): void {\n    const ad = adPod[0];\n    const playNext = () => {\n      adPod.shift();\n      this._adBreaksEventManager.removeAll();\n      this._waterfalled = false;\n      this._podLength = adPod.length;\n      this._adPosition++;\n      this._playAd(adPod);\n    };\n    const waterfall = error => {\n      this.dispatchEvent(this.player.Event.AD_WATERFALLING, {\n        adFailed: {\n          url: ad.url ? ad.url[0] : '',\n          response: !ad.url && ad.response ? ad.response[0] : '',\n          data: error,\n          adBreak: this._getAdBreakTypeFromPlayer(),\n          position: this._adPosition\n        }\n      });\n      this._adBreaksEventManager.removeAll();\n      this._waterfalled = true;\n      ad.url ? ad.url.shift() : ad.response && ad.response.shift();\n      this._playAd(adPod);\n    };\n    const onError = error => {\n      if ((ad.url && ad.url.length > 1) || (!ad.url && ad.response && ad.response.length > 1)) {\n        waterfall(error);\n      } else {\n        if (this._waterfalled) {\n          this.dispatchEvent(this.player.Event.AD_WATERFALLING_FAILED);\n        }\n        this._stateMachine.adlog(error);\n        playNext();\n      }\n    };\n    if (ad) {\n      this._adBreaksEventManager.listen(this._adsLoader, this._sdk.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, () => {\n        this._adBreaksEventManager.listen(this._adsManager, this._sdk.AdEvent.Type.COMPLETE, playNext);\n        this._adBreaksEventManager.listen(this._adsManager, this._sdk.AdEvent.Type.SKIPPED, playNext);\n        this._adBreaksEventManager.listen(this._adsManager, this._sdk.AdEvent.Type.LOG, onError);\n        this._adBreaksEventManager.listen(this._adsManager, this._sdk.AdErrorEvent.Type.AD_ERROR, onError);\n      });\n      this._adBreaksEventManager.listen(this._adsLoader, this._sdk.AdErrorEvent.Type.AD_ERROR, error => {\n        onError(error);\n        if (this._podLength === 0) {\n          if (this.player.ads.isAdBreak()) {\n            this._stateMachine.adbreakend({type: this._sdk.AdEvent.Type.CONTENT_RESUME_REQUESTED});\n          }\n          if (this._hasUserAction) {\n            this._stateMachine.adscompleted({type: this._sdk.AdEvent.Type.ALL_ADS_COMPLETED});\n          } else {\n            this.eventManager.listen(this.player, this.player.Event.FIRST_PLAY, () => {\n              this._stateMachine.adscompleted({type: this._sdk.AdEvent.Type.ALL_ADS_COMPLETED});\n            });\n          }\n        }\n      });\n      this._isBumper = !!ad.bumper;\n      this._requestAds(ad.url && ad.url[0], ad.response && ad.response[0]);\n    }\n  }\n\n  _getAdBreakTypeFromPlayer(): string {\n    if (this.player.ended) {\n      return AdBreakType.POST;\n    }\n    if (this.player.currentTime > 0) {\n      return AdBreakType.MID;\n    }\n    return AdBreakType.PRE;\n  }\n\n  /**\n   * Skips on an ad.\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  skipAd(): void {\n    this.logger.debug('Skip ad');\n    if (this._adsManager) {\n      if (this._adsManager.getAdSkippableState()) {\n        this._adsManager.skip();\n      } else if (this.config.skipSupport) {\n        this._adsManager.stop();\n      }\n    }\n  }\n\n  /**\n   * Resuming the ad.\n   * @public\n   * @returns {DeferredPromise} - The promise which when resolved starts the next handler in the middleware chain.\n   * @instance\n   * @memberof Ima\n   */\n  resumeAd(): ?DeferredPromise {\n    this.logger.debug('Resume ad');\n    this._nextPromise = Utils.Object.defer();\n    this._adsManager.resume();\n    return this._nextPromise;\n  }\n\n  /**\n   * Pausing the ad.\n   * @public\n   * @returns {DeferredPromise} - The promise which when resolved starts the next handler in the middleware chain.\n   * @instance\n   * @memberof Ima\n   */\n  pauseAd(): ?DeferredPromise {\n    this.logger.debug('Pause ad');\n    this._adsManager.pause();\n  }\n\n  /**\n   * Gets the state machine.\n   * @public\n   * @returns {any} - The state machine.\n   * @instance\n   * @memberof Ima\n   */\n  getStateMachine(): any {\n    return this._stateMachine;\n  }\n\n  /**\n   * Gets the indicator if ads playing on the main video tag\n   * @public\n   * @returns {boolean} - if ads playing on the main video tag.\n   * @instance\n   * @memberof Ima\n   */\n  playOnMainVideoTag() {\n    return !!this._adsManager && !!this._adsManager.isCustomPlaybackUsed();\n  }\n\n  /**\n   * Gets the indicator if ads still playing.\n   * @public\n   * @returns {boolean} - if ads still playing.\n   * @instance\n   * @memberof Ima\n   */\n  isAdPlaying(): boolean {\n    return this._stateMachine.is(State.PLAYING) || this._stateMachine.is(State.PENDING) || this._stateMachine.is(State.PAUSED);\n  }\n\n  getContentTime(): number {\n    let currentTime = 0;\n    //current time exist for mid-roll otherwise it's pre-roll(start of video - 0) - post-roll(end of video)\n    if (this._videoLastCurrentTime) {\n      currentTime = this._videoLastCurrentTime;\n    } else if (this._contentComplete) {\n      currentTime = this.getContentDuration();\n    }\n    return currentTime;\n  }\n\n  getContentDuration(): number {\n    return this._contentDuration || this.player.config.sources.duration || 0;\n  }\n\n  getContentSrc(): string {\n    return this._contentSrc || '';\n  }\n  getContentEnded(): boolean {\n    return this._contentComplete;\n  }\n  /**\n   * Prepare the plugin before media is loaded.\n   * @override\n   * @public\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  loadMedia(): void {\n    this._addBindings();\n    this.loadPromise.then(() => {\n      if (!this._adDisplayContainer) {\n        this._adDisplayContainer = new this._sdk.AdDisplayContainer(this._adsContainerDiv, this.player.getVideoElement());\n      }\n      if (!this._adsLoader) {\n        this._initAdsLoader();\n      }\n    });\n    if (this._playAdByConfig()) {\n      this.loadPromise.then(() => this._requestAds()).catch(() => {});\n    }\n  }\n\n  /**\n   * Resets the plugin.\n   * @override\n   * @public\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  reset(): void {\n    this.logger.debug('reset');\n    this.eventManager.removeAll();\n    this._adBreaksEventManager.removeAll();\n    this._hideAdsContainer();\n    if (!this._isImaSDKLibLoaded()) {\n      return;\n    }\n    this._destroyIMAManagers();\n    this._stateMachine.goto(State.DONE);\n    this._initMembers();\n  }\n\n  /**\n   * Destroys the plugin.\n   * @override\n   * @public\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  destroy(): void {\n    this.logger.debug('destroy');\n    this.eventManager.destroy();\n    this._hideAdsContainer();\n    this._destroyIMAManagers();\n  }\n\n  _destroyIMAManagers(): void {\n    if (this._adsManager) {\n      this._adsManager.destroy();\n    }\n    if (this._adsLoader) {\n      this._adsLoader.destroy();\n      this._adsLoader = null;\n    }\n    if (this._adDisplayContainer) {\n      this._adDisplayContainer.destroy();\n      this._adDisplayContainer = null;\n    }\n  }\n\n  /**\n   * Initialize the ads for the first time.\n   * @public\n   * @returns {?DeferredPromise} - The promise which when resolved starts the next handler in the middleware chain.\n   * @instance\n   * @memberof Ima\n   */\n  initialUserAction(): ?DeferredPromise {\n    try {\n      this.logger.debug('Initial user action');\n      this._nextPromise = Utils.Object.defer();\n      this._adDisplayContainer.initialize();\n      this._hasUserAction = true;\n      if (this._isAdsManagerLoaded) {\n        this.logger.debug('User action occurred after ads manager loaded');\n        this._startAdsManager();\n      }\n    } catch (adError) {\n      this.logger.error(adError);\n      this.reset();\n    }\n    return this._nextPromise;\n  }\n\n  /**\n   * Starts the ads manager.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _startAdsManager(): void {\n    this.logger.debug('Start ads manager');\n    const readyPromise = this.playOnMainVideoTag() && !this.config.disableMediaPreload ? this.player.ready() : Promise.resolve();\n    readyPromise.then(() => {\n      this._adsManager.init(this.player.dimensions.width, this.player.dimensions.height, this._sdk.ViewMode.NORMAL);\n      this._adsManager.start();\n    });\n  }\n\n  /**\n   * Adding bindings.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _addBindings(): void {\n    FULL_SCREEN_EVENTS.forEach(fullScreenEvent => this.eventManager.listen(document, fullScreenEvent, () => this._resizeAd()));\n    this.eventManager.listen(this.player, 'resize', () => this._resizeAd());\n    this.eventManager.listen(this.player, this.player.Event.MUTE_CHANGE, () => this._syncPlayerVolume());\n    this.eventManager.listen(this.player, this.player.Event.VOLUME_CHANGE, () => this._syncPlayerVolume());\n    this.eventManager.listen(this.player, this.player.Event.SOURCE_SELECTED, event => {\n      let selectedSource = event.payload.selectedSource;\n      if (selectedSource && selectedSource.length > 0) {\n        this._contentSrc = selectedSource[0].url;\n      }\n    });\n    this.eventManager.listenOnce(this.player, this.player.Event.DURATION_CHANGE, () => {\n      this._contentDuration = this.player.duration;\n    });\n    this.eventManager.listen(this.player, this.player.Event.ERROR, event => {\n      if (event.payload && event.payload.severity === Error.Severity.CRITICAL) {\n        this.reset();\n      }\n    });\n    this.eventManager.listen(this.player, this.player.Event.FIRST_PLAY, () => {\n      if (this._currentAd && !this._currentAd.isLinear()) {\n        this._showAdsContainer();\n      }\n    });\n    this.eventManager.listen(this.player, this.player.Event.MEDIA_LOADED, () => {\n      this._adsManager.updateAdsRenderingSettings({\n        restoreCustomPlaybackStateOnAdBreakComplete: !this.player.config.playback.playAdsWithMSE\n      });\n    });\n    this.eventManager.listen(this.player, this.player.Event.ENDED, () => this._onMediaEnded());\n    this.eventManager.listen(this.player, this.player.Event.LOADED_METADATA, () => this._onLoadedMetadata());\n    this.eventManager.listen(this.player, this.player.Event.TIME_UPDATE, () => this._onMediaTimeUpdate());\n    this.eventManager.listen(this.player, this.player.Event.SEEKING, () => this._onMediaSeeking());\n    this.eventManager.listen(this.player, this.player.Event.SEEKED, () => this._onMediaSeeked());\n    if (!this._playAdByConfig()) {\n      this.eventManager.listenOnce(this.player, this.player.Event.USER_GESTURE, () => {\n        if (!this._adVideoTagAlreadyPlayed) {\n          this._adDisplayContainer.initialize();\n        }\n      });\n    }\n  }\n\n  /**\n   * Init the members of the plugin.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _initMembers(): void {\n    this._nextPromise = null;\n    this._currentAd = null;\n    this._adsManager = null;\n    this._contentComplete = false;\n    this._isAdsManagerLoaded = false;\n    this._videoLastCurrentTime = null;\n    this._contentPlayheadTracker = {currentTime: 0, previousTime: 0, seeking: false, duration: 0};\n    this._hasUserAction = false;\n    this._togglePlayPauseOnAdsContainerCallback = null;\n    this._contentDuration = null;\n    this._selectedAudioTrack = null;\n    this._selectedTextTrack = null;\n    this._selectedPlaybackRate = 1;\n    this._textTracksHidden = [];\n    this._adBreaksEventManager = new EventManager();\n    this._podLength = 0;\n    this._adPosition = 0;\n    this._firstOfAdPod = false;\n    this._waterfalled = false;\n    this._isBumper = false;\n    this._isVpaid = false;\n  }\n\n  /**\n   * Initializing the plugin.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _init(): void {\n    this.loadPromise = Utils.Object.defer();\n    this._maybeDelayInitUntilSourceSelected()\n      .then(() => this._loadImaSDKLib())\n      .then(() => {\n        this._sdk = window.google.ima;\n        this.logger.debug('IMA SDK version: ' + this._sdk.VERSION);\n        this._initImaSettings();\n        this._initAdsContainer();\n        this._initAdsLoader();\n        this.loadPromise.resolve();\n      })\n      .catch(e => {\n        this.loadPromise.reject(e);\n      });\n  }\n\n  /**\n   * If configured, wait until source selected before will continue the initialization of the plugin.\n   * @returns {Promise<*>} -\n   * @private\n   * @instance\n   * @memberof Ima\n   */\n  _maybeDelayInitUntilSourceSelected(): Promise<*> {\n    if (this.config.delayInitUntilSourceSelected) {\n      return new Promise((resolve, reject) => {\n        if (this._contentSrc) {\n          // Source selected event already dispatched\n          resolve();\n        } else {\n          this.eventManager.listenOnce(this.player, this.player.Event.SOURCE_SELECTED, resolve);\n          this.eventManager.listenOnce(this.player, this.player.Event.ERROR, error => {\n            if (error.payload.severity === Error.Severity.CRITICAL) {\n              reject(error);\n            }\n          });\n        }\n      });\n    } else {\n      return Promise.resolve();\n    }\n  }\n\n  /**\n   * Loads the ima sdk lib.\n   * @returns {Promise<*>} - The promise result for the load operation.\n   * @private\n   * @instance\n   * @memberof Ima\n   */\n  _loadImaSDKLib(): Promise<*> {\n    const imaSdkUrl = Utils.Http.protocol + (this.config.debug ? Ima.IMA_SDK_DEBUG_LIB_URL : Ima.IMA_SDK_LIB_URL);\n    return this._isImaSDKLibLoaded() ? Promise.resolve() : Utils.Dom.loadScriptAsync(imaSdkUrl);\n  }\n\n  /**\n   * Checks for ima sdk lib availability.\n   * @returns {boolean} - Whether ima sdk lib is loaded.\n   * @private\n   * @instance\n   * @memberof Ima\n   */\n  _isImaSDKLibLoaded(): boolean {\n    return window.google && window.google.ima && window.google.ima.VERSION;\n  }\n\n  /**\n   * Init ima settings.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _initImaSettings(): void {\n    this._sdk.settings.setPlayerType(this.config.playerName);\n    this._sdk.settings.setPlayerVersion(this.config.playerVersion);\n    this._sdk.settings.setVpaidAllowed(true);\n    this._sdk.settings.setVpaidMode(this._getVpaidMode());\n    if (Object.prototype.hasOwnProperty.call(this.config, 'locale')) {\n      this._sdk.settings.setLocale(this.config.locale);\n    }\n    if (typeof this.config.setDisableCustomPlaybackForIOS10Plus === 'boolean') {\n      this._sdk.settings.setDisableCustomPlaybackForIOS10Plus(this.config.setDisableCustomPlaybackForIOS10Plus);\n    } else {\n      this._sdk.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playback.playsinline);\n    }\n    if (typeof this.config.numRedirects === 'number') {\n      this._sdk.settings.setNumRedirects(this.config.numRedirects);\n    }\n    if (typeof this.config.sessionId === 'string') {\n      this._sdk.settings.setSessionId(this.config.sessionId);\n    }\n  }\n\n  /**\n   * Gets the vpaid mode.\n   * @private\n   * @returns {number} - The vpaid mode.\n   * @instance\n   * @memberof Ima\n   */\n  _getVpaidMode(): number {\n    const vpaidmode = this._sdk.ImaSdkSettings.VpaidMode[this.config.vpaidMode];\n    if (this.config.vpaidMode && typeof vpaidmode === 'number') {\n      this.logger.debug('VpaidMode: set to ' + this.config.vpaidMode);\n      return vpaidmode;\n    } else {\n      this.logger.warn('VpaidMode is not set, setting to ENABLED');\n      return this._sdk.ImaSdkSettings.VpaidMode.ENABLED;\n    }\n  }\n\n  /**\n   * Initializing the ad container.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _initAdsContainer(): void {\n    this.logger.debug('Init ads container');\n    const playerView = this.player.getView();\n    // Create ads container\n    this._adsContainerDiv = Utils.Dom.createElement('div');\n    this._adsContainerDiv.id = ADS_CONTAINER_CLASS + playerView.id;\n    this._adsContainerDiv.className = ADS_CONTAINER_CLASS;\n\n    // Create ads cover\n    this._adsCoverDiv = Utils.Dom.createElement('div');\n    this._adsCoverDiv.id = ADS_COVER_CLASS + playerView.id;\n    this._adsCoverDiv.className = ADS_COVER_CLASS;\n    this._adsCoverDiv.onclick = () => this._onAdsCoverClicked();\n    // Append the ads container to the dom\n    Utils.Dom.appendChild(playerView, this._adsContainerDiv);\n    this._adDisplayContainer = new this._sdk.AdDisplayContainer(this._adsContainerDiv, this.player.getVideoElement());\n  }\n\n  /**\n   * Initializing the ads loader.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _initAdsLoader(): void {\n    this.logger.debug('Init ads loader');\n    this._adsLoader = new this._sdk.AdsLoader(this._adDisplayContainer);\n    this._adsLoader.addEventListener(this._sdk.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, adsManagerLoadedEvent =>\n      this._onAdsManagerLoaded(adsManagerLoadedEvent)\n    );\n    this._adsLoader.addEventListener(this._sdk.AdErrorEvent.Type.AD_ERROR, adEvent => this._stateMachine.aderror(adEvent));\n  }\n\n  /**\n   * Requests the ads from the ads loader.\n   * @param {?string} vastUrl - vast url.\n   * @param {?string} vastResponse - vast XML response.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _requestAds(vastUrl: ?string, vastResponse: ?string): void {\n    if (vastUrl || vastResponse || this._playAdByConfig()) {\n      this.logger.debug('Request ads');\n      // Request video ads\n      let adsRequest = new this._sdk.AdsRequest();\n      const adTagUrl = vastUrl || this.config.adTagUrl;\n      if (adTagUrl) {\n        adsRequest.adTagUrl = adTagUrl;\n      } else {\n        adsRequest.adsResponse = vastResponse || this.config.adsResponse;\n      }\n      if (typeof this.config.vastLoadTimeout === 'number') {\n        adsRequest.vastLoadTimeout = this.config.vastLoadTimeout;\n      }\n      if (typeof this.config.omidAccessModes === 'object') {\n        for (const [vendor: OmidVendor, accessMode: AccessMode] of Object.entries(this.config.omidAccessModes)) {\n          adsRequest.omidAccessModeRules[this._sdk.OmidVerificationVendor[vendor]] = this._sdk.OmidAccessMode[accessMode];\n        }\n      }\n      adsRequest.linearAdSlotWidth = this.player.dimensions.width;\n      adsRequest.linearAdSlotHeight = this.player.dimensions.height;\n      adsRequest.nonLinearAdSlotWidth = this.player.dimensions.width;\n      adsRequest.nonLinearAdSlotHeight = this.player.dimensions.height / 3;\n      adsRequest.contentDuration = POSTROLL_PRELOAD_NONE;\n\n      const muted = this.player.muted || this.player.volume === 0;\n      adsRequest.setAdWillPlayMuted(muted);\n\n      const adWillAutoPlay = this.config.adWillAutoPlay;\n      const playerWillAutoPlay = this.player.config.playback.autoplay;\n      const allowMutedAutoPlay = this.player.config.playback.allowMutedAutoPlay;\n\n      // Pass signal to IMA SDK if ad will autoplay with sound\n      // First let application config this, otherwise if player is configured\n      // to autoplay then try to autodetect if unmuted autoplay is supported\n      if (typeof adWillAutoPlay === 'boolean') {\n        adsRequest.setAdWillAutoPlay(adWillAutoPlay);\n        this._adsLoader.requestAds(adsRequest);\n      } else if (playerWillAutoPlay) {\n        getCapabilities(EngineType.HTML5).then(capabilities => {\n          // If the plugin has been destroyed while calling this promise\n          // the adsLoader will no longer exists\n          if (!this._adsLoader) return;\n\n          if (capabilities.autoplay) {\n            adsRequest.setAdWillAutoPlay(true);\n          } else if (allowMutedAutoPlay && capabilities.mutedAutoPlay) {\n            adsRequest.setAdWillAutoPlay(true);\n            adsRequest.setAdWillPlayMuted(true);\n          } else {\n            adsRequest.setAdWillAutoPlay(false);\n          }\n          this._adsLoader.requestAds(adsRequest);\n        });\n      } else {\n        adsRequest.setAdWillAutoPlay(false);\n        this._adsLoader.requestAds(adsRequest);\n      }\n      this._stateMachine.loaded();\n    } else {\n      this._stateMachine.goto(State.DONE);\n      this.logger.debug('Missing ad tag url: create plugin without requesting ads');\n    }\n  }\n\n  /**\n   * Resize event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _resizeAd() {\n    if (this._sdk && this._adsManager && this._currentAd) {\n      let viewMode = this.player.isFullscreen() ? this._sdk.ViewMode.FULLSCREEN : this._sdk.ViewMode.NORMAL;\n      if (this._currentAd.isLinear() || this._isVpaid) {\n        this._adsManager.resize(this.player.dimensions.width, this.player.dimensions.height, viewMode);\n      } else {\n        const adTotalWidth = this._currentAd.getWidth() + OVERLAY_AD_MARGIN;\n        const adTotalHeight = this._currentAd.getHeight() + OVERLAY_AD_MARGIN;\n        if (adTotalWidth <= this.player.dimensions.width && adTotalHeight <= this.player.dimensions.height) {\n          this._alignAdsContainerSizeForOverlayAd();\n          this._adsManager.resize(adTotalWidth, adTotalHeight, viewMode);\n          this._showAdsContainer();\n        } else {\n          this._hideAdsContainer();\n        }\n      }\n    }\n  }\n\n  /**\n   * Align the size for the ads container when overlay ad is displaying.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _alignAdsContainerSizeForOverlayAd(): void {\n    this._adsContainerDiv.style.bottom = this._currentAd.getHeight() + OVERLAY_AD_MARGIN + 'px';\n    this._adsContainerDiv.style.left = (this.player.dimensions.width - this._currentAd.getWidth()) / 2 + 'px';\n  }\n\n  /**\n   * Loadedmetada event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   * @instance\n   * @memberof Ima\n   */\n  _onLoadedMetadata(): void {\n    this._contentPlayheadTracker.duration = this.player.duration;\n  }\n\n  /**\n   * Timeupdate event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onMediaTimeUpdate(): void {\n    if (!this._contentPlayheadTracker.seeking && this.player.currentTime > 0) {\n      this._contentPlayheadTracker.previousTime = this._contentPlayheadTracker.currentTime;\n      this._contentPlayheadTracker.currentTime = this.player.currentTime;\n    }\n  }\n\n  /**\n   * Seeking event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onMediaSeeking(): void {\n    this._contentPlayheadTracker.seeking = true;\n  }\n\n  /**\n   * Seeked event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onMediaSeeked(): void {\n    this._contentPlayheadTracker.seeking = false;\n  }\n\n  /**\n   * Maybe save the video current time before ads starts (on ios this is necessary).\n   * @private\n   * @return {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeSaveVideoCurrentTime(): void {\n    if ((this.playOnMainVideoTag() || this.config.forceReloadMediaAfterAds) && this._engine.currentTime > 0) {\n      this.logger.debug('Custom playback used: save current time before ads', this._engine.currentTime);\n      this._videoLastCurrentTime = this._engine.currentTime;\n    }\n  }\n\n  /**\n   * Maybe sets the video current time after ads finished (on ios this is necessary).\n   * @private\n   * @return {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeSetVideoCurrentTime(): void {\n    if (this._videoLastCurrentTime) {\n      this.logger.debug('Custom playback used: set current time after ads', this._videoLastCurrentTime);\n      this.player.currentTime = this._videoLastCurrentTime;\n      this._videoLastCurrentTime = null;\n    }\n  }\n\n  _hasPostRoll(): boolean {\n    return this._adsManager && this._adsManager.getCuePoints().includes(-1);\n  }\n\n  /**\n   * Ended event handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onMediaEnded(): void {\n    this.logger.debug('Media ended');\n    this._contentComplete = true;\n    if (this._currentAd && !this._currentAd.isLinear()) {\n      this.reset();\n    } else if (!this._hasPostRoll()) {\n      this._stateMachine.goto(State.DONE);\n    }\n  }\n\n  /**\n   * Ended event handler.\n   * @public\n   * @returns {Promise<void>} - complete promise\n   * @instance\n   * @memberof Ima\n   */\n  onPlaybackEnded(): Promise<void> {\n    this.logger.debug('Playback ended');\n    if (this._adsLoader) {\n      this._adsLoader.contentComplete();\n    }\n    if (this._hasPostRoll()) {\n      return new Promise(resolve => {\n        this.eventManager.listenOnce(this._adsManager, this._sdk.AdEvent.Type.ALL_ADS_COMPLETED, () => {\n          resolve();\n        });\n      });\n    }\n    return Promise.resolve();\n  }\n\n  /**\n   * Shows the ads container.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _showAdsContainer(): void {\n    if (this._adsContainerDiv) {\n      this._adsContainerDiv.style.opacity = 1;\n      this._adsContainerDiv.style.pointerEvents = 'auto';\n    }\n  }\n\n  /**\n   * Hides the ads container.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _hideAdsContainer(): void {\n    if (this._adsContainerDiv) {\n      this._adsContainerDiv.style.opacity = 0;\n      this._adsContainerDiv.style.pointerEvents = 'none';\n    }\n  }\n\n  /**\n   * The ads manager loaded handler.\n   * @param {any} adsManagerLoadedEvent - The event data.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onAdsManagerLoaded(adsManagerLoadedEvent: any): void {\n    this.logger.debug('Ads manager loaded');\n    const adsRenderingSettings = this._getAdsRenderingSetting();\n    this._adsManager = adsManagerLoadedEvent.getAdsManager(this._contentPlayheadTracker, adsRenderingSettings);\n    this.config.forceReloadMediaAfterAds = this.playOnMainVideoTag() ? false : this.config.forceReloadMediaAfterAds;\n    const cuePoints = [...this._adsManager.getCuePoints()];\n    if (!cuePoints.length) {\n      cuePoints.push(0);\n    }\n    if (this._playAdByConfig()) {\n      this.dispatchEvent(this.player.Event.AD_MANIFEST_LOADED, {adBreaksPosition: cuePoints});\n      if (this.player.hasService('timeline') && this.config.showAdBreakCuePoint) {\n        cuePoints.forEach(cuePoint => {\n          this.player.getService('timeline').addCuePoint({\n            time: cuePoint !== -1 ? cuePoint : Infinity,\n            ...this.config.adBreakCuePointStyle\n          });\n        });\n      }\n    }\n    this._isAdsManagerLoaded = true;\n    this._attachAdsManagerListeners();\n    this._syncPlayerVolume();\n    if (this._hasUserAction) {\n      this.logger.debug('User action occurred before ads manager loaded');\n      this._startAdsManager();\n    }\n  }\n\n  /**\n   * returns the ads rendering settings configuration for IMA with plugin config applied\n   * @returns {Object} - IMA AdsRenderingSettings object\n   * @private\n   * @instance\n   * @memberof Ima\n   */\n  _getAdsRenderingSetting(): Object {\n    let adsRenderingSettings = new this._sdk.AdsRenderingSettings();\n    Object.keys(this.config.adsRenderingSettings).forEach(setting => {\n      if (adsRenderingSettings[setting] !== undefined) {\n        adsRenderingSettings[setting] = this.config.adsRenderingSettings[setting];\n      } else {\n        this.logger.warn('unsupported adsRenderingSettings was set:', setting);\n      }\n    });\n    adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete = false;\n    if (typeof this.config.adsRenderingSettings.playAdsAfterTime !== 'number') {\n      adsRenderingSettings.playAdsAfterTime = this.player.config.sources.startTime;\n    }\n    return adsRenderingSettings;\n  }\n\n  /**\n   * Attach the ads manager listeners.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _attachAdsManagerListeners(): void {\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.CONTENT_PAUSE_REQUESTED, adEvent => {\n      if (this._playAdByConfig() || this._firstOfAdPod) {\n        this._firstOfAdPod = false;\n        this._stateMachine.adbreakstart(adEvent);\n\n        if (this._adStartedEvent) {\n          this._stateMachine.adstarted(this._adStartedEvent);\n          this._adStartedEvent = null;\n        }\n      }\n    });\n\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.CONTENT_RESUME_REQUESTED, adEvent => {\n      if (this._playAdByConfig() || this._podLength === 0) {\n        this._stateMachine.adbreakend(adEvent);\n      }\n    });\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.ALL_ADS_COMPLETED, adEvent => {\n      if (this._playAdByConfig() || this._podLength === 0) {\n        this._stateMachine.adscompleted(adEvent);\n      }\n    });\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.LOADED, adEvent => this._stateMachine.adloaded(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.STARTED, adEvent => {\n      if (adEvent.getAd().isLinear() && !this.player.ads.isAdBreak()) {\n        this._adStartedEvent = adEvent;\n      } else {\n        this._stateMachine.adstarted(adEvent);\n      }\n    });\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.PAUSED, adEvent => this._stateMachine.adpaused(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.RESUMED, adEvent => this._stateMachine.adresumed(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.FIRST_QUARTILE, adEvent => this._stateMachine.adfirstquartile(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.MIDPOINT, adEvent => this._stateMachine.admidpoint(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.THIRD_QUARTILE, adEvent => this._stateMachine.adthirdquartile(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.CLICK, adEvent => this._stateMachine.adclicked(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.SKIPPED, adEvent => this._stateMachine.adskipped(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.COMPLETE, adEvent => this._stateMachine.adcompleted(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.USER_CLOSE, adEvent => this._stateMachine.userclosedad(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.VOLUME_CHANGED, adEvent => this._stateMachine.advolumechanged(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.VOLUME_MUTED, adEvent => this._stateMachine.admuted(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.AD_PROGRESS, adEvent => this._stateMachine.adprogress(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.AD_BUFFERING, adEvent => this._stateMachine.adbuffering(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.LOG, adEvent => this._stateMachine.adlog(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdEvent.Type.SKIPPABLE_STATE_CHANGED, adEvent => this._stateMachine.adcanskip(adEvent));\n    this._adsManager.addEventListener(this._sdk.AdErrorEvent.Type.AD_ERROR, adEvent => this._stateMachine.aderror(adEvent));\n  }\n\n  /**\n   * Syncs the player volume.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _syncPlayerVolume(): void {\n    if (this._adsManager) {\n      if (this.player.muted) {\n        this._adsManager.setVolume(0);\n      } else {\n        if (this._adsManager && !isNaN(this.player.volume) && typeof this.player.volume === 'number') {\n          this._adsManager.setVolume(this.player.volume);\n        }\n      }\n    }\n  }\n\n  /**\n   * Resolves the next promise to let the next handler in the middleware chain start.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _resolveNextPromise(): void {\n    if (this._nextPromise) {\n      this._nextPromise.resolve();\n      this._nextPromise = null;\n    }\n  }\n\n  /**\n   * Toggle the ads cover div.\n   * @param {boolean} enable - Whether to add or remove the ads cover.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _setToggleAdsCover(enable: boolean): void {\n    if (enable) {\n      if (!this.playOnMainVideoTag()) {\n        if (this._adsContainerDiv.parentNode) {\n          this._adsContainerDiv.parentNode.insertBefore(this._adsCoverDiv, this._adsContainerDiv.nextSibling);\n          this._isAdsCoverActive = true;\n        }\n      }\n    } else {\n      if (this._isAdsCoverActive) {\n        if (this._adsContainerDiv.parentNode) {\n          this._adsContainerDiv.parentNode.removeChild(this._adsCoverDiv);\n          this._isAdsCoverActive = false;\n        }\n      }\n    }\n  }\n\n  /**\n   * On ads cover click handler.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _onAdsCoverClicked(): void {\n    if (this._adsManager) {\n      switch (this._stateMachine.state) {\n        case State.PAUSED:\n          this._adsManager.resume();\n          break;\n        case State.PLAYING:\n          this._adsManager.pause();\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  /**\n   * Displays companion ads using the Ad API.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeDisplayCompanionAds(): void {\n    if (this.config.companions?.ads) {\n      if (Utils.Object.isObject(window?.googletag?.cmd)) {\n        this.logger.warn('googletag exists. Do not display the companions manually');\n      }\n      const selectionCriteria = new this._sdk.CompanionAdSelectionSettings();\n      selectionCriteria.resourceType = this._sdk.CompanionAdSelectionSettings.ResourceType.ALL;\n      selectionCriteria.creativeType = this._sdk.CompanionAdSelectionSettings.CreativeType.ALL;\n      const sizeCriteria = this.config.companions.sizeCriteria;\n      selectionCriteria.sizeCriteria =\n        this._sdk.CompanionAdSelectionSettings.SizeCriteria[sizeCriteria] || this._sdk.CompanionAdSelectionSettings.SizeCriteria.SELECT_EXACT_MATCH;\n      const companionsIds = Object.keys(this.config.companions.ads);\n      for (let i = 0; i < companionsIds.length; i++) {\n        const id = companionsIds[i];\n        const ad = this.config.companions.ads[id];\n        const width = ad.width;\n        const height = ad.height;\n        try {\n          const companionAds = this._currentAd.getCompanionAds(width, height, selectionCriteria);\n          if (companionAds.length > 0) {\n            const companionAd = companionAds[0];\n            const content = companionAd.getContent();\n            const el = Utils.Dom.getElementById(id);\n            if (el) {\n              el.innerHTML = content;\n            }\n          }\n        } catch (e) {\n          this.logger.error('Error occurred while extracting companion ad', e);\n        }\n      }\n    }\n  }\n\n  /**\n   * On Chrome-Android we're ignoring LearnMore click to enable\n   * video element manipulation only on user gesture.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeIgnoreClickOnAd(): void {\n    const isAndroid = () => this.player.env.os.name === 'Android';\n    const isChrome = () => this.player.env.browser.name === 'Chrome';\n    if (isAndroid() && isChrome()) {\n      this.eventManager.listenOnce(this.player.getView(), 'click', e => e.stopPropagation());\n    }\n  }\n\n  /**\n   * On iOS AVPlayer caption stack on video tag, should re-position to hide\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _hideActiveTextTracksOnAVPlayer(): void {\n    const isIOS = this.player.env.os.name === 'iOS';\n    if (isIOS && this.playOnMainVideoTag()) {\n      let tracks = this.player.getVideoElement().textTracks;\n      Array.from(tracks).forEach(track => {\n        if (track.mode === 'showing') {\n          Array.from(track.activeCues).forEach(cue => {\n            this._textTracksHidden.push(cue.text);\n            cue.text = '';\n          });\n        }\n      });\n    }\n  }\n\n  _setActiveTextTracksOnAVPlayer(): void {\n    const isIOS = this.player.env.os.name === 'iOS';\n    if (this._textTracksHidden && isIOS && this.playOnMainVideoTag()) {\n      let tracks = this.player.getVideoElement().textTracks;\n      Array.from(tracks).forEach(track => {\n        if (track.mode === 'showing') {\n          Array.from(track.activeCues).forEach(cue => {\n            if (this._textTracksHidden.length > 0) {\n              cue.text = this._textTracksHidden.shift();\n            }\n          });\n        }\n      });\n    }\n    this._textTracksHidden = [];\n  }\n\n  /**\n   * When playing on same video tag need to save state snapshot\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeSavePlayerSnapshot(): void {\n    if (this.playOnMainVideoTag()) {\n      this._selectedAudioTrack = this.player.getActiveTracks().audio;\n      this._selectedTextTrack = this.player.getActiveTracks().text;\n      this._selectedPlaybackRate = this.player.playbackRate;\n      // When we are using the same video element on iOS, native captions still\n      // appearing on the video element, so need to hide them before ad start.\n      this._hideActiveTextTracksOnAVPlayer();\n      this.player.hideTextTrack();\n    }\n  }\n\n  /**\n   * When playing on same video tag need to restore to previous state\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeRestorePlayerSnapshot(): void {\n    if (this.playOnMainVideoTag()) {\n      this.eventManager.listenOnce(this.player, this.player.Event.CAN_PLAY, () => {\n        this.player.selectTrack(this._selectedAudioTrack);\n        this.player.selectTrack(this._selectedTextTrack);\n        this.player.playbackRate = this._selectedPlaybackRate;\n        this._setActiveTextTracksOnAVPlayer();\n      });\n    }\n  }\n\n  /**\n   * When playing with different video tags on iOS ads are not\n   * supported in native full screen, so need to exist full screen before ads started.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _maybeForceExitFullScreen(): void {\n    const isIOS = this.player.env.os.name === 'iOS';\n    //check if inBrowserFullscreen not set, just in case of inline true and not inBrowserFullscreen we will exit otherwise\n    if (\n      isIOS &&\n      !this.playOnMainVideoTag() &&\n      this.player.isFullscreen() &&\n      !this.player.config.playback.inBrowserFullscreen &&\n      this.player.config.playback.playsinline\n    ) {\n      this.player.exitFullscreen();\n    }\n  }\n\n  _playAdByConfig(): boolean {\n    return !!(this.config.adTagUrl || this.config.adsResponse);\n  }\n\n  _isVideoAd(): boolean {\n    return this._currentAd && this._currentAd.getContentType().startsWith('video');\n  }\n}\n\nexport {Ima};\n","// @flow\nimport {core} from '@playkit-js/kaltura-player-js';\nimport {Ima as BaseImaPlugin} from './ima';\n\nconst {Env} = core;\n\nclass CustomIma extends BaseImaPlugin {\n  /**\n   * The default configuration of the plugin.\n   * @type {Object}\n   * @static\n   * @memberof Ima\n   */\n  static defaultConfig: Object = {\n    debug: false,\n    delayInitUntilSourceSelected: Env.os.name === 'iOS',\n    disableMediaPreload: false,\n    forceReloadMediaAfterAds: false,\n    adsRenderingSettings: {\n      restoreCustomPlaybackStateOnAdBreakComplete: false,\n      enablePreloading: false,\n      useStyledLinearAds: false,\n      useStyledNonLinearAds: true,\n      bitrate: -1,\n      autoAlign: true,\n      loadVideoTimeout: -1\n    },\n    companions: {\n      ads: null,\n      sizeCriteria: 'SELECT_EXACT_MATCH'\n    },\n    aps: {\n      enabled: false,\n      fetchBids: adTagUrl => new Promise(resolve => resolve(adTagUrl))\n    },\n    adBreakPlayable: () => true\n  };\n\n  /**\n   * Plays ad on demand\n   * @param {KPAdPod} adPod - The ad pod to play.\n   * @returns {void}\n   * @public\n   * @instance\n   * @memberof Ima\n   */\n  playAdNow(adPod: KPAdPod): void {\n    if (!this._adBreakPlayableByConfig(adPod)) {\n      this.logger.debug('Not playing ad now because config callback denied');\n      return;\n    }\n\n    super.playAdNow(adPod);\n  }\n\n  _adBreakPlayableByConfig(adPod: ?PKAdPod): boolean {\n    return this.config.adBreakPlayable(adPod);\n  }\n\n  /**\n   * Requests the ads from the ads loader.\n   * @param {?string} vastUrl - vast url.\n   * @param {?string} vastResponse - vast XML response.\n   * @private\n   * @returns {void}\n   * @instance\n   * @memberof Ima\n   */\n  _requestAds(vastUrl: ?string, vastResponse: ?string): void {\n    this.logger.debug('Request ads', vastUrl);\n\n    let adTagUrl = vastUrl || this.config.adTagUrl;\n\n    this.logger.debug('APS integration', this.config.aps.enabled);\n\n    let fetchBidsPromise = new Promise(resolve => resolve(adTagUrl));\n\n    if (this.config.aps.enabled && adTagUrl && 'apstag' in window) {\n      fetchBidsPromise = this.config.aps.fetchBids(adTagUrl);\n    }\n\n    fetchBidsPromise.then(adTagUrl => {\n      this.logger.debug('APS fetch bids resolved', adTagUrl);\n      super._requestAds(adTagUrl, vastResponse);\n    });\n  }\n}\n\nexport {CustomIma as Ima};\n","// @flow\nimport {registerPlugin} from '@playkit-js/kaltura-player-js';\nimport {Ima} from './ima-custom';\n\ndeclare var __VERSION__: string;\ndeclare var __NAME__: string;\n\nconst VERSION = __VERSION__;\nconst NAME = __NAME__;\n\nexport {Ima as Plugin};\nexport {VERSION, NAME};\n\nconst pluginName: string = 'ima';\n\nregisterPlugin(pluginName, Ima);\n"],"sourceRoot":""}